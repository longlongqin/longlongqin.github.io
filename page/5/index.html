<!DOCTYPE html><html><head hexo-theme="https://volantis.js.org/#2.1.4"><meta charset="utf-8"><meta name="robots" content="noindex,follow"><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="HandheldFriendly" content="True"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><title>é¾™é¾™â€˜S BLOG</title><link rel="alternate" href="/atom.xml" title="é¾™é¾™â€˜S BLOG"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css"><link rel="shortcut icon" type="image/x-icon" href="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/photo.jpg"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.1.4.3/css/style.css"><script>function setLoadingBarProgress(e){document.getElementById("loading-bar").style.width=e+"%"}</script></head><body><script type="text/javascript" src="/js/love.js"></script><script type="text/javascript" src="/js/ergao.js"></script><div id="loading-bar-wrapper"><div id="loading-bar"></div></div><header class="l_header shadow blur"><div class="wrapper"><div class="nav-sub container--flex"><a class="logo flat-box"></a><ul class="switcher h-list"><li><a class="s-comment flat-btn fas fa-comments fa-fw" target="_self" href="javascript:void(0)"></a></li><li><a class="s-toc flat-btn fas fa-list fa-fw" target="_self" href="javascript:void(0)"></a></li></ul></div><div class="nav-main container container--flex"><a class="logo flat-box" target="_self" href="/"><i class="fas fa-home"></i> é¾™é¾™</a><div class="menu navigation"><ul class="h-list"><li><a class="flat-box" href="/archives/" id="archives"><i class="fas fa-list-alt fa-fw fa-fw"></i> ç´¢å¼•</a><ul class="submenu"><li><a class="flat-box" href="/categories/" id="categories"><i class="fas fa-folder-open fa-fw fa-fw"></i> åˆ†ç±»</a><ul class="submenu"><li><a class="flat-box" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" id="categoriesE5ADA6E4B9A0E7AC94E8AEB0"><i class="fas fa-fire fa-fw"></i> å­¦ä¹ ç¬”è®°</a></li><li><a class="flat-box" href="/categories/%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7/" id="categoriesE5AE9EE794A8E68A80E5B7A7"><i class="fas fa-fire fa-fw"></i> å®ç”¨æŠ€å·§</a></li></ul></li><li><a class="flat-box" href="/tags/" id="tags"><i class="fas fa-tags fa-fw fa-fw"></i> æ ‡ç­¾</a></li><li><a class="flat-box" href="/archives/" id="archives"><i class="fas fa-list fa-fw fa-fw"></i> æ—¶é—´è½´</a></li></ul></li><li><a class="flat-box" href="/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" id="E5ADA6E4B9A0E7AC94E8AEB0"><i class="fas fa-book fa-fw"></i> å­¦ä¹ ç¬”è®°</a></li><li><a class="flat-box"><i class="fas fa-wrench fa-fw"></i> å·¥å…·</a><ul class="submenu"><li><a class="flat-box" href="https://www.thinkcmf.com/font/search/index.html" target="_blank" rel="noopener" id="https:www.thinkcmf.comfontsearchindex.html"><i class="fas fa-font fa-fw"></i> Font Awesomeå›¾æ ‡</a></li><li><a class="flat-box" href="https://www.sojson.com/image/change.html" target="_blank" rel="noopener" id="https:www.sojson.comimagechange.html"><i class="fa fa-crop fa-fw"></i> åœ¨çº¿å›¾ç‰‡å°ºå¯¸ä¿®æ”¹</a></li><li><a class="flat-box" href="http://dir.scmor.com/" target="_blank" rel="noopener" id="http:dir.scmor.com"><i class="fa fa-search fa-fw"></i> Googleå­¦æœ¯&æœç´¢é•œåƒ</a></li><li><a class="flat-box" href="https://emojixd.com/" target="_blank" rel="noopener" id="https:emojixd.com"><i class="fa fa-smile-o fa-fw"></i> Emojiè¡¨æƒ…ç¬¦å·è¾å…¸ğŸ““</a></li></ul></li><li><a class="flat-box" href="/about/" id="about"><i class="fas fa-info-circle fa-fw fa-fw"></i> å…³äº</a><ul class="submenu"><li><a class="flat-box" href="/about/" id="about"><i class="fas fa-user-circle fa-fw fa-fw"></i> å…³äºæˆ‘</a></li><hr><li><a class="flat-box" href="/friends/" id="friends"><i class="fas fa-link fa-fw"></i> å‹äººå¸</a></li><li><a class="flat-box" href="/comment/" id="comment"><i class="fas fa-comment fa-fw"></i> ç•™è¨€æ¿</a></li><hr><li><a class="flat-box" href="https://github.com/longlongqin" target="_blank" rel="noopener" id="https:github.comlonglongqin"><i class="fab fa-github fa-fw fa-fw"></i> æˆ‘çš„Github</a></li><li><a class="flat-box" href="https://longlongqin.gitee.io" target="_blank" rel="noopener" id="https:longlongqin.gitee.io"><i class="fa fa-chevron-circle-right fa-fw"></i> materyä¸»é¢˜åšå®¢</a></li></ul></li><li><a class="flat-box" href="https://volantis.js.org/tag-plugins/" target="_blank" rel="noopener" id="https:volantis.js.orgtag-plugins"><i class="fa fa-bookmark fa-fw"></i> Volantisä¸»é¢˜æ–‡æ¡£</a></li><li><a class="flat-box" href="/easysearch/" id="easysearch"><i class="fa fa-search fa-fw"></i> easyæœç´¢</a></li></ul></div><div class="m_search"><form name="searchform" class="form u-search-form"><i class="icon fas fa-search fa-fw"></i> <input type="text" class="input u-search-input" placeholder="search for everything"></form></div><ul class="switcher h-list"><li><a class="s-search flat-btn fas fa-search fa-fw" target="_self" href="javascript:void(0)"></a></li><li><a class="s-menu flat-btn fas fa-bars fa-fw" target="_self" href="javascript:void(0)"></a></li></ul></div></div></header><ul class="menu-phone navigation white-box"><li><a class="flat-box" href="/archives/" id="archives"><i class="fas fa-list-alt fa-fw fa-fw"></i> ç´¢å¼•</a></li><li><a class="flat-box" href="/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" id="E5ADA6E4B9A0E7AC94E8AEB0"><i class="fas fa-book fa-fw"></i> å­¦ä¹ ç¬”è®°</a></li><li><a class="flat-box" href="/about/" id="about"><i class="fas fa-info-circle fa-fw fa-fw"></i> å…³äº</a></li></ul><script>setLoadingBarProgress(40)</script><div class="l_body nocover"><div class="body-wrapper"><div class="l_main"><section class="post-list"><div class="post-wrapper"><article class="post white-box shadow reveal"><section class="meta"><div class="meta" id="header-meta"><h2 class="title"><a href="/archives/3bfe5978.html">C&C++/æ¨¡æ¿ç±»</a></h2><div class="new-meta-box"><div class="new-meta-item author"><a href="https://longlongqin.github.io" rel="nofollow"><img src="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/image/loading.gif" data-original="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/photo.jpg"><p>longlongin</p></a></div><div class="new-meta-item date"><a class="notlink"><i class="fas fa-edit" aria-hidden="true"></i><p>å‘å¸ƒäºï¼š2020å¹´5æœˆ16æ—¥</p></a></div><div class="new-meta-item wordcount"><a class="notlink"><i class="fas fa-keyboard" aria-hidden="true"></i><p>å­—æ•°ï¼š2.5kå­—</p></a></div><div class="new-meta-item readtime"><a class="notlink"><i class="fas fa-hourglass-half" aria-hidden="true"></i><p>æ—¶é•¿ï¼š10åˆ†é’Ÿ</p></a></div></div><hr></div></section><section class="article typo"><div class="article-entry" itemprop="articleBody"><p>åŸæ–‡ï¼š</p><p><a href="https://www.learncpp.com/cpp-tutorial/133-template-classes/" target="_blank" rel="noopener">https://www.learncpp.com/cpp-tutorial/133-template-classes/</a></p><hr><p>åœ¨<a href="https://www.learncpp.com/cpp-tutorial/106-container-classes/" target="_blank" rel="noopener">10.6 â€“ Container classes</a>ä¸­ï¼Œæ‚¨å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨å¤åˆæ¥å®ç°åŒ…å«å…¶ä»–ç±»çš„å¤šä¸ªå®ä¾‹çš„ç±»ã€‚ä½œä¸ºè¿™ç§å®¹å™¨çš„ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ç ”ç©¶äº†IntArrayç±»ã€‚ä¸‹é¢æ˜¯è¯¥ç±»çš„ä¸€ä¸ªç®€åŒ–ç¤ºä¾‹:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> INTARRAY_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INTARRAY_H</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cassert&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IntArray</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> m_length&#123;&#125;;</span><br><span class="line">    <span class="keyword">int</span> *m_data&#123;&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"> </span><br><span class="line">    IntArray(<span class="keyword">int</span> length)</span><br><span class="line">    &#123;</span><br><span class="line">        assert(length &gt; <span class="number">0</span>);</span><br><span class="line">        m_data = <span class="keyword">new</span> <span class="keyword">int</span>[length]&#123;&#125;;</span><br><span class="line">        m_length = length;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// We don't want to allow copies of IntArray to be created.</span></span><br><span class="line">    IntArray(<span class="keyword">const</span> IntArray&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    IntArray&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> IntArray&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"> </span><br><span class="line">    ~IntArray()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span>[] m_data;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Erase</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">delete</span>[] m_data;</span><br><span class="line">        <span class="comment">// We need to make sure we set m_data to 0 here, otherwise it will</span></span><br><span class="line">        <span class="comment">// be left pointing at deallocated memory!</span></span><br><span class="line">        m_data = <span class="literal">nullptr</span>;</span><br><span class="line">        m_length = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">int</span>&amp; <span class="keyword">operator</span>[](<span class="keyword">int</span> index)</span><br><span class="line">    &#123;</span><br><span class="line">        assert(index &gt;= <span class="number">0</span> &amp;&amp; index &lt; m_length);</span><br><span class="line">        <span class="keyword">return</span> m_data[index];</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getLength</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> m_length; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>è™½ç„¶è¿™ä¸ªç±»æä¾›äº†ä¸€ç§åˆ›å»ºæ•´æ•°æ•°ç»„çš„ç®€å•æ–¹æ³•ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ªåŒç²¾åº¦æ•°ç»„å‘¢?ä½¿ç”¨ä¼ ç»Ÿçš„ç¼–ç¨‹æ–¹æ³•ï¼Œæˆ‘ä»¬å¿…é¡»åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ç±»!ä¸‹é¢æ˜¯DoubleArrayçš„ä¸€ä¸ªä¾‹å­ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ•°ç»„ç±»ï¼Œç”¨äºä¿å­˜doubleã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> DOUBLEARRAY_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DOUBLEARRAY_H</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cassert&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DoubleArray</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> m_length&#123;&#125;;</span><br><span class="line">    <span class="keyword">double</span> *m_data&#123;&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"> </span><br><span class="line">    DoubleArray(<span class="keyword">int</span> length)</span><br><span class="line">    &#123;</span><br><span class="line">        assert(length &gt; <span class="number">0</span>);</span><br><span class="line">        m_data = <span class="keyword">new</span> <span class="keyword">double</span>[length]&#123;&#125;;</span><br><span class="line">        m_length = length;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    DoubleArray(<span class="keyword">const</span> DoubleArray&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    DoubleArray&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> DoubleArray&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"> </span><br><span class="line">    ~DoubleArray()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span>[] m_data;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Erase</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">delete</span>[] m_data;</span><br><span class="line">        <span class="comment">// We need to make sure we set m_data to 0 here, otherwise it will</span></span><br><span class="line">        <span class="comment">// be left pointing at deallocated memory!</span></span><br><span class="line">        m_data = <span class="literal">nullptr</span>;</span><br><span class="line">        m_length = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">double</span>&amp; <span class="keyword">operator</span>[](<span class="keyword">int</span> index)</span><br><span class="line">    &#123;</span><br><span class="line">        assert(index &gt;= <span class="number">0</span> &amp;&amp; index &lt; m_length);</span><br><span class="line">        <span class="keyword">return</span> m_data[index];</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getLength</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> m_length; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>å°½ç®¡ä»£ç æ¸…å•å¾ˆé•¿ï¼Œä½†æ‚¨ä¼šæ³¨æ„åˆ°è¿™ä¸¤ä¸ªç±»å‡ ä¹å®Œå…¨ç›¸åŒ!å®é™…ä¸Šï¼ŒæƒŸä¸€çš„å®è´¨æ€§åŒºåˆ«æ˜¯æ‰€åŒ…å«çš„æ•°æ®ç±»å‹(intå’Œdouble)ã€‚æ‚¨å¯èƒ½å·²ç»çŒœåˆ°äº†ï¼Œè¿™æ˜¯å¦ä¸€ä¸ªå¯ä»¥å……åˆ†åˆ©ç”¨æ¨¡æ¿çš„é¢†åŸŸï¼Œä»è€Œä½¿æˆ‘ä»¬ä¸å¿…åˆ›å»ºç»‘å®šåˆ°ç‰¹å®šæ•°æ®ç±»å‹çš„ç±»ã€‚</p><h1 id="ä½¿ç”¨æ¨¡æ¿ç±»"><a href="#ä½¿ç”¨æ¨¡æ¿ç±»" class="headerlink" title="ä½¿ç”¨æ¨¡æ¿ç±»"></a>ä½¿ç”¨æ¨¡æ¿ç±»</h1><p>åˆ›å»ºæ¨¡æ¿ç±»çš„å·¥ä½œæ–¹å¼ä¸åˆ›å»ºæ¨¡æ¿å‡½æ•°çš„å·¥ä½œæ–¹å¼å‡ ä¹ç›¸åŒï¼Œå› æ­¤æˆ‘ä»¬å°†é€šè¿‡ç¤ºä¾‹ç»§ç»­ã€‚è¿™æ˜¯æˆ‘ä»¬çš„æ•°ç»„ç±»ï¼Œæ¨¡æ¿ç‰ˆæœ¬:</p><p><code>Array.h</code>:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> ARRAY_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ARRAY_H</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cassert&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">Array</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> m_length&#123;&#125;;</span><br><span class="line">    T *m_data&#123;&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"> </span><br><span class="line">    Array(<span class="keyword">int</span> length)</span><br><span class="line">    &#123;</span><br><span class="line">        assert(length &gt; <span class="number">0</span>);</span><br><span class="line">        m_data = <span class="keyword">new</span> T[length]&#123;&#125;;</span><br><span class="line">        m_length = length;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    Array(<span class="keyword">const</span> Array&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Array&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Array&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"> </span><br><span class="line">    ~Array()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span>[] m_data;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Erase</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">delete</span>[] m_data;</span><br><span class="line">        <span class="comment">// æˆ‘ä»¬éœ€è¦ç¡®ä¿æˆ‘ä»¬åœ¨è¿™é‡Œè®¾ç½®m_dataä¸º0ï¼Œå¦åˆ™å®ƒä¼š æŒ‡å‘é‡Šæ”¾äº†çš„å†…å­˜!!</span></span><br><span class="line">        m_data = <span class="literal">nullptr</span>;</span><br><span class="line">        m_length = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    T&amp; <span class="keyword">operator</span>[](<span class="keyword">int</span> index)</span><br><span class="line">    &#123;</span><br><span class="line">        assert(index &gt;= <span class="number">0</span> &amp;&amp; index &lt; m_length);</span><br><span class="line">        <span class="keyword">return</span> m_data[index];</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// æ¨¡æ¿å‡½æ•°getLength() çš„å®šä¹‰åœ¨ä¸‹é¢</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getLength</span><span class="params">()</span> <span class="keyword">const</span></span>; </span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// å®šä¹‰åœ¨ç±»å¤–éƒ¨çš„æˆå‘˜å‡½æ•°éœ€è¦å®ƒä»¬è‡ªå·±çš„æ¨¡æ¿å£°æ˜â­</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">int</span> <span class="title">Array</span>&lt;T&gt;:</span>:getLength() <span class="keyword">const</span> <span class="comment">// æ³¨æ„ç±»åæ˜¯Array&lt;T&gt;ï¼Œä¸æ˜¯Arrayâ­</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> m_length;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œè¿™ä¸ªç‰ˆæœ¬ä¸IntArrayç‰ˆæœ¬å‡ ä¹å®Œå…¨ç›¸åŒï¼Œ<strong>åªæ˜¯æˆ‘ä»¬æ·»åŠ äº†æ¨¡æ¿å£°æ˜ï¼Œå¹¶å°†æ‰€åŒ…å«çš„æ•°æ®ç±»å‹ä»intæ›´æ”¹ä¸ºTã€‚</strong></p><blockquote><p>æ³¨æ„ï¼š</p><p>æ³¨æ„ï¼Œ<u>æˆ‘ä»¬è¿˜åœ¨ç±»å£°æ˜ä¹‹å¤–å®šä¹‰äº†getLength()å‡½æ•°ã€‚è¿™å¹¶ä¸æ˜¯å¿…é¡»çš„</u>ï¼Œä½†æ˜¯ç”±äºè¯­æ³•çš„åŸå› ï¼Œæ–°ç¨‹åºå‘˜åœ¨ç¬¬ä¸€æ¬¡å°è¯•è¿™æ ·åšæ—¶é€šå¸¸ä¼šå‡ºé”™ï¼Œæ‰€ä»¥ä¸‹é¢çš„ä¾‹å­å¾ˆæœ‰å¯å‘æ„ä¹‰ã€‚<strong>åœ¨ç±»å£°æ˜ä¹‹å¤–å£°æ˜çš„æ¯ä¸ªæ¨¡æ¿åŒ–æˆå‘˜å‡½æ•°éƒ½éœ€è¦è‡ªå·±çš„æ¨¡æ¿å£°æ˜ã€‚å¦å¤–ï¼Œè¯·æ³¨æ„æ¨¡æ¿åŒ–æ•°ç»„ç±»çš„åç§°æ˜¯Array<t>ï¼Œè€Œä¸æ˜¯array</t></strong>â€”â€”arrayå°†å¼•ç”¨ä¸€ä¸ªåä¸ºarrayçš„ç±»çš„éæ¨¡æ¿åŒ–ç‰ˆæœ¬ã€‚</p></blockquote><p>è¿™é‡Œæ˜¯ä¸€ä¸ªç®€çŸ­çš„ä¾‹å­ä½¿ç”¨ä¸Šè¿°æ¨¡æ¿ arrayç±»:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"Array.h"</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">Array&lt;<span class="keyword">int</span>&gt; <span class="title">intArray</span><span class="params">(<span class="number">12</span>)</span></span>;</span><br><span class="line">	<span class="function">Array&lt;<span class="keyword">double</span>&gt; <span class="title">doubleArray</span><span class="params">(<span class="number">12</span>)</span></span>;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> count&#123; <span class="number">0</span> &#125;; count &lt; intArray.getLength(); ++count)</span><br><span class="line">	&#123;</span><br><span class="line">		intArray[count] = count;</span><br><span class="line">		doubleArray[count] = count + <span class="number">0.5</span>;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> count&#123; intArray.getLength() - <span class="number">1</span> &#125;; count &gt;= <span class="number">0</span>; --count)</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; intArray[count] &lt;&lt; <span class="string">'\t'</span> &lt;&lt; doubleArray[count] &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*ç»“æœ*/</span></span><br><span class="line"><span class="number">11</span>     <span class="number">11.5</span></span><br><span class="line"><span class="number">10</span>     <span class="number">10.5</span></span><br><span class="line"><span class="number">9</span>       <span class="number">9.5</span></span><br><span class="line"><span class="number">8</span>       <span class="number">8.5</span></span><br><span class="line"><span class="number">7</span>       <span class="number">7.5</span></span><br><span class="line"><span class="number">6</span>       <span class="number">6.5</span></span><br><span class="line"><span class="number">5</span>       <span class="number">5.5</span></span><br><span class="line"><span class="number">4</span>       <span class="number">4.5</span></span><br><span class="line"><span class="number">3</span>       <span class="number">3.5</span></span><br><span class="line"><span class="number">2</span>       <span class="number">2.5</span></span><br><span class="line"><span class="number">1</span>       <span class="number">1.5</span></span><br><span class="line"><span class="number">0</span>       <span class="number">0.5</span></span><br></pre></td></tr></table></figure><h2 id="æ¨¡æ¿ç±»çš„å®ä¾‹åŒ–æ–¹æ³•ä¸æ¨¡æ¿å‡½æ•°ç›¸åŒ"><a href="#æ¨¡æ¿ç±»çš„å®ä¾‹åŒ–æ–¹æ³•ä¸æ¨¡æ¿å‡½æ•°ç›¸åŒ" class="headerlink" title="æ¨¡æ¿ç±»çš„å®ä¾‹åŒ–æ–¹æ³•ä¸æ¨¡æ¿å‡½æ•°ç›¸åŒ"></a>æ¨¡æ¿ç±»çš„å®ä¾‹åŒ–æ–¹æ³•ä¸æ¨¡æ¿å‡½æ•°ç›¸åŒ</h2><p><strong>æ¨¡æ¿ç±»çš„å®ä¾‹åŒ–æ–¹å¼ä¸æ¨¡æ¿å‡½æ•°ç›¸åŒ</strong>â€”â€”<strong>ç¼–è¯‘å™¨æ ¹æ®éœ€è¦ æ¨¡æ¿åŒ–ä¸€ä¸ªå‰¯æœ¬ï¼Œç”¨ ç”¨æˆ·è¾“å…¥çš„å®é™…æ•°æ®ç±»å‹æ›¿æ¢ æ¨¡æ¿å‚æ•°ï¼Œç„¶åç¼–è¯‘è¯¥å‰¯æœ¬ã€‚å¦‚æœæ‚¨ä»æœªä½¿ç”¨è¿‡æ¨¡æ¿ç±»ï¼Œç¼–è¯‘å™¨ç”šè‡³ä¸ä¼šç¼–è¯‘å®ƒã€‚</strong></p><h2 id="æ¿ç±»ç¡®å®æ˜¯c-æœ€å¥½å’Œæœ€æœ‰ç”¨çš„ç‰¹æ€§ä¹‹ä¸€"><a href="#æ¿ç±»ç¡®å®æ˜¯c-æœ€å¥½å’Œæœ€æœ‰ç”¨çš„ç‰¹æ€§ä¹‹ä¸€" class="headerlink" title="æ¿ç±»ç¡®å®æ˜¯c++æœ€å¥½å’Œæœ€æœ‰ç”¨çš„ç‰¹æ€§ä¹‹ä¸€"></a>æ¿ç±»ç¡®å®æ˜¯c++æœ€å¥½å’Œæœ€æœ‰ç”¨çš„ç‰¹æ€§ä¹‹ä¸€</h2><p>æ¨¡æ¿ç±»æ˜¯å®ç°å®¹å™¨ç±»çš„ç†æƒ³å¯¹è±¡ï¼Œå› ä¸ºè®©å®¹å™¨è·¨å„ç§æ•°æ®ç±»å‹å·¥ä½œæ˜¯éå¸¸ç†æƒ³çš„ï¼Œè€Œæ¨¡æ¿å…è®¸æ‚¨åœ¨ä¸å¤åˆ¶ä»£ç çš„æƒ…å†µä¸‹è¿™æ ·åšã€‚è™½ç„¶è¯­æ³•å¾ˆéš¾çœ‹ï¼Œé”™è¯¯æ¶ˆæ¯ä¹Ÿå¾ˆéšæ™¦ï¼Œä½†æ˜¯æ¨¡æ¿ç±»ç¡®å®æ˜¯c++æœ€å¥½å’Œæœ€æœ‰ç”¨çš„ç‰¹æ€§ä¹‹ä¸€ã€‚</p><h1 id="æ ‡å‡†åº“ä¸­çš„æ¨¡æ¿ç±»"><a href="#æ ‡å‡†åº“ä¸­çš„æ¨¡æ¿ç±»" class="headerlink" title="æ ‡å‡†åº“ä¸­çš„æ¨¡æ¿ç±»"></a>æ ‡å‡†åº“ä¸­çš„æ¨¡æ¿ç±»</h1><p>ç°åœ¨æˆ‘ä»¬å·²ç»ä»‹ç»äº†æ¨¡æ¿ç±»ï¼Œæ‚¨åº”è¯¥ç†è§£<code>std::vector&lt;int&gt;</code>æ˜¯ä»€ä¹ˆæ„æ€äº†â€”â€”std::vectorå®é™…ä¸Šæ˜¯ä¸€ä¸ªæ¨¡æ¿ç±»ï¼Œintæ˜¯æ¨¡æ¿çš„ç±»å‹å‚æ•°ã€‚æ ‡å‡†åº“ä¸­æœ‰å¾ˆå¤šé¢„å®šä¹‰çš„æ¨¡æ¿ç±»å¯ä¾›æ‚¨ä½¿ç”¨ã€‚æˆ‘ä»¬å°†åœ¨åé¢çš„ç« èŠ‚ä¸­è®¨è®ºè¿™äº›ã€‚</p><h1 id="åˆ†è§£æ¨¡æ¿ç±»"><a href="#åˆ†è§£æ¨¡æ¿ç±»" class="headerlink" title="åˆ†è§£æ¨¡æ¿ç±»"></a>åˆ†è§£æ¨¡æ¿ç±»</h1><p><strong>æ¨¡æ¿ä¸æ˜¯ç±»ï¼Œä¹Ÿä¸æ˜¯å‡½æ•°â€”â€”å®ƒæ˜¯ç”¨äºåˆ›å»ºç±»æˆ–å‡½æ•°çš„æ¨¡æ¿ã€‚</strong></p><p>å› æ­¤ï¼Œå®ƒçš„å·¥ä½œæ–¹å¼ä¸æ™®é€šå‡½æ•°æˆ–ç±»ä¸å¤ªä¸€æ ·ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™ä¸æ˜¯ä»€ä¹ˆå¤§é—®é¢˜ã€‚ç„¶è€Œï¼Œæœ‰ä¸€ä¸ªæ–¹é¢é€šå¸¸ä¼šç»™å¼€å‘äººå‘˜å¸¦æ¥é—®é¢˜ã€‚</p><h2 id="ä¸ºä»€ä¹ˆè¦åˆ†è§£"><a href="#ä¸ºä»€ä¹ˆè¦åˆ†è§£" class="headerlink" title="ä¸ºä»€ä¹ˆè¦åˆ†è§£"></a>ä¸ºä»€ä¹ˆè¦åˆ†è§£</h2><p>å¯¹äº<u>éæ¨¡æ¿ç±»</u>ï¼Œé€šå¸¸çš„è¿‡ç¨‹æ˜¯<strong>å°†ç±»å®šä¹‰æ”¾åœ¨å¤´æ–‡ä»¶ä¸­(.h)</strong>ï¼Œ<strong>å°†æˆå‘˜å‡½æ•°å®šä¹‰æ”¾åœ¨ç›¸åŒåå­—çš„ä»£ç æ–‡ä»¶ä¸­(.cpp)ã€‚</strong>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œç±»çš„æºä»£ç (.cpp)è¢«ç¼–è¯‘ä¸ºä¸€ä¸ªå•ç‹¬çš„é¡¹ç›®æ–‡ä»¶ã€‚</p><p><u>ä½†æ˜¯ï¼Œå¯¹äºæ¨¡æ¿ï¼Œè¿™æ˜¯è¡Œä¸é€šçš„</u>ã€‚è€ƒè™‘ä»¥ä¸‹:</p><p><code>Array.h</code>:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> ARRAY_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ARRAY_H</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cassert&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">Array</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> m_length&#123;&#125;;</span><br><span class="line">    T* m_data&#123;&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"> </span><br><span class="line">    Array(<span class="keyword">int</span> length)</span><br><span class="line">    &#123;</span><br><span class="line">        assert(length &gt; <span class="number">0</span>);</span><br><span class="line">        m_data = <span class="keyword">new</span> T[length]&#123;&#125;;</span><br><span class="line">        m_length = length;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    Array(<span class="keyword">const</span> Array&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Array&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Array&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"> </span><br><span class="line">    ~Array()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span>[] m_data;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Erase</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">delete</span>[] m_data;</span><br><span class="line"> </span><br><span class="line">        m_data = <span class="literal">nullptr</span>;</span><br><span class="line">        m_length = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    T&amp; <span class="keyword">operator</span>[](<span class="keyword">int</span> index)</span><br><span class="line">    &#123;</span><br><span class="line">        assert(index &gt;= <span class="number">0</span> &amp;&amp; index &lt; m_length);</span><br><span class="line">        <span class="keyword">return</span> m_data[index];</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getLength</span><span class="params">()</span> <span class="keyword">const</span></span>; </span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure><p><code>Array.cpp</code>:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"Array.h"</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">int</span> <span class="title">Array</span>&lt;T&gt;:</span>:getLength() <span class="keyword">const</span> <span class="comment">// note class name is Array&lt;T&gt;, not Array</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> m_length;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>main.cpp</code>:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"Array.h"</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">Array&lt;<span class="keyword">int</span>&gt; <span class="title">intArray</span><span class="params">(<span class="number">12</span>)</span></span>;</span><br><span class="line">	<span class="function">Array&lt;<span class="keyword">double</span>&gt; <span class="title">doubleArray</span><span class="params">(<span class="number">12</span>)</span></span>;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> count&#123; <span class="number">0</span> &#125;; count &lt; intArray.getLength(); ++count)</span><br><span class="line">	&#123;</span><br><span class="line">		intArray[count] = count;</span><br><span class="line">		doubleArray[count] = count + <span class="number">0.5</span>;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> count&#123; intArray.getLength() - <span class="number">1</span> &#125;; count &gt;= <span class="number">0</span>; --count)</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; intArray[count] &lt;&lt; <span class="string">'\t'</span> &lt;&lt; doubleArray[count] &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šç¨‹åºå°†ç¼–è¯‘ï¼Œä½†å¯¼è‡´é“¾æ¥å™¨é”™è¯¯:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unresolved external symbol &quot;public: int __thiscall Array::getLength(void)&quot; (?GetLength@?$Array@H@@QAEHXZ)</span><br></pre></td></tr></table></figure><p>ä¸ºäº†è®©ç¼–è¯‘å™¨ä½¿ç”¨æ¨¡æ¿ï¼Œ<strong>å®ƒå¿…é¡»åŒæ—¶çœ‹åˆ° æ¨¡æ¿å®šä¹‰(ä¸ä»…ä»…æ˜¯ä¸€ä¸ªå£°æ˜) å’Œ ç”¨äºå®ä¾‹åŒ–æ¨¡æ¿çš„æ¨¡æ¿ç±»å‹</strong>ã€‚</p><blockquote><p>è¿˜è¦è®°ä½ï¼ŒC++å•ç‹¬ç¼–è¯‘æ–‡ä»¶ã€‚<strong>å½“ Array.h è¢«åŒ…å«åœ¨mainä¸­æ—¶ï¼Œæ¨¡æ¿ç±»å®šä¹‰ è¢«å¤åˆ¶åˆ°main.cppä¸­ã€‚</strong></p></blockquote><p>å½“ç¼–è¯‘å™¨çœ‹åˆ°æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªæ¨¡æ¿å®ä¾‹ï¼Œ<code>Array&lt;int&gt;</code> å’Œ <code>Array&lt;double&gt;</code>ï¼Œå®ƒå°†å®ä¾‹åŒ–å®ƒä»¬ï¼Œ<strong>å¹¶å°†å®ƒä»¬ç¼–è¯‘ä¸ºmain.cppçš„ä¸€éƒ¨åˆ†ã€‚</strong></p><p><u>ä½†æ˜¯ï¼Œå½“å•ç‹¬ç¼–è¯‘<code>Array.cpp</code>æ—¶ï¼Œå®ƒä¼šå¿˜è®°æˆ‘ä»¬éœ€è¦ä¸€ä¸ª<code>Array&lt;int&gt;</code> å’Œ <code>Array&lt;double&gt;</code>ï¼Œè¿™æ ·æ¨¡æ¿å‡½æ•°å°±ä¸ä¼šè¢«å®ä¾‹åŒ–ã€‚</u></p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªé“¾æ¥å™¨é”™è¯¯ï¼Œå› ä¸ºç¼–è¯‘å™¨æ‰¾ä¸åˆ°<code>Array&lt;int&gt;::getLength()</code>æˆ–<code>Array&lt;double&gt;::getLength()</code>çš„å®šä¹‰ã€‚</p><h2 id="åˆ†è§£æ–¹æ³•"><a href="#åˆ†è§£æ–¹æ³•" class="headerlink" title="åˆ†è§£æ–¹æ³•"></a>åˆ†è§£æ–¹æ³•</h2><p>æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><ul><li><p><strong>å°†æ¨¡æ¿ç±»çš„.h ä¸ .cpp æ–‡ä»¶ä¸­çš„ä»£ç  å…¨éƒ¨æ”¾åœ¨ .hæ–‡ä»¶ä¸­ã€‚</strong></p><blockquote><p>è¿™æ˜¯æˆ‘ä»¬çš„é¦–é€‰è§£å†³æ–¹æ¡ˆï¼Œé™¤éç¼–è¯‘æˆ–é“¾æ¥æ—¶é—´ å¼€å§‹æˆä¸ºé—®é¢˜ã€‚</p></blockquote></li></ul><p>è¿™æ ·ï¼Œå½“æ‚¨#includeå¤´éƒ¨æ—¶ï¼Œæ‰€æœ‰çš„æ¨¡æ¿ä»£ç éƒ½å°†åœ¨ä¸€ä¸ªä½ç½®ã€‚è¿™ä¸ªè§£å†³æ–¹æ¡ˆçš„ä¼˜ç‚¹æ˜¯å®ƒå¾ˆç®€å•ã€‚</p><p>è¿™é‡Œçš„<strong>ç¼ºç‚¹</strong>æ˜¯ï¼Œå¦‚æœæ¨¡æ¿ç±»åœ¨å¾ˆå¤šåœ°æ–¹ä½¿ç”¨ï¼Œæ‚¨å°†ä¼šå¾—åˆ°æ¨¡æ¿ç±»çš„è®¸å¤šæœ¬åœ°å‰¯æœ¬ï¼Œè¿™ä¼šå¢åŠ ç¼–è¯‘å’Œé“¾æ¥çš„æ—¶é—´(é“¾æ¥å™¨åº”è¯¥åˆ é™¤é‡å¤çš„å®šä¹‰ï¼Œå› æ­¤å®ƒä¸åº”è¯¥ä½¿æ‚¨çš„å¯æ‰§è¡Œæ–‡ä»¶è†¨èƒ€)ã€‚</p><ul><li><p><strong>å°†<code>xxx.cpp</code>æ–‡ä»¶é‡å‘½åä¸º<code>xxx.inl</code></strong></p><p>å¦‚æœæ‚¨è®¤ä¸ºå°†Array.cppä»£ç æ”¾åˆ°Array.hå¤´æ–‡ä»¶ä¸­ä¼šä½¿å¤´æ–‡ä»¶å¤ªé•¿/æ··ä¹±<strong>ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨å¦ä¸€ç§æ–¹æ³•</strong>ï¼š</p><ol><li><strong>å°†<code>Array.cpp</code>é‡å‘½åä¸º<code>Array.inl</code>(<code>.inl</code>ä»£è¡¨å†…è”)ï¼Œ</strong></li><li><strong>ç„¶ååœ¨<code>Array.h</code>ä¸­çš„åº•éƒ¨ <code>#include &quot;Array.inl&quot;</code></strong>ã€‚</li></ol></li></ul><p>è¿™å°†äº§ç”Ÿä¸å°†æ‰€æœ‰ä»£ç æ”¾å…¥å¤´ä¸­ç›¸åŒçš„ç»“æœï¼Œä½†æœ‰åŠ©äºä¿æŒæ›´ç®€æ´ã€‚</p><ul><li><strong>åœ¨main.cppæ–‡ä»¶ä¸­ï¼ŒåŒ…å«æ¨¡æ¿ç±»çš„.cppæ–‡ä»¶ï¼Œå³<code>#include &quot;xxx.cpp&quot;</code></strong></li></ul><p>ä½†æ˜¯æˆ‘ä»¬<strong>ä¸æ¨è</strong>è¿™ä¸ªæ–¹æ³•ï¼Œå› ä¸ºè¿™æ˜¯#includeçš„éæ ‡å‡†ç”¨æ³•ã€‚</p><ul><li><p><strong>ä¸‰æ–‡ä»¶æ³•</strong></p><blockquote><p>è¿™ä¸ªæ–¹æ³•æ›´æœ‰æ•ˆï¼Œä½†æ˜¯éœ€è¦ç»´æŠ¤æ¯ä¸ªç¨‹åºçš„templates.cppæ–‡ä»¶ã€‚</p></blockquote><ul><li><strong>å°†æ¨¡æ¿ç±»çš„å®šä¹‰æ”¾åœ¨<code>.h</code>æ–‡ä»¶ä¸­ï¼›</strong></li><li><strong>å°†æ¨¡æ¿ç±»çš„æˆå‘˜å‡½æ•°çš„å®šä¹‰æ”¾åœ¨<code>.cpp</code>æ–‡ä»¶ä¸­ï¼›</strong></li><li><strong>æœ€åä½ æ·»åŠ ç¬¬ä¸‰ä¸ªæ–‡ä»¶(å‡è®¾å«<code>templates.cpp</code>)ï¼Œå®ƒåŒ…å«äº†ä½ éœ€è¦çš„æ‰€æœ‰å®ä¾‹åŒ–ç±»</strong>ã€‚</li></ul><p><strong>ç„¶ååœ¨<code>main.cpp</code>ä¸­åŒ…å«<code>#include &quot;templates.cpp&quot;</code></strong>ã€‚</p></li></ul><p>å¦‚ï¼Œä¸‹é¢å±•ç¤ºäº†ä¸€ä¸ªæ·»åŠ çš„ç¬¬ä¸‰ä¸ªæ–‡ä»¶ï¼š</p><p><code>templates.cpp</code></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¡®ä¿å¯ä»¥çœ‹åˆ°å®Œæ•´çš„æ•°ç»„æ¨¡æ¿å®šä¹‰</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"Array.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"Array.cpp"</span> <span class="comment">//æˆ‘ä»¬åœ¨è¿™é‡Œæ‰“ç ´äº†æœ€ä½³å®è·µï¼Œä½†åªæ˜¯åœ¨è¿™ä¸ªåœ°æ–¹</span></span></span><br><span class="line"><span class="comment">// åœ¨è¿™é‡ŒåŒ…å«æ‚¨éœ€è¦çš„å…¶ä»–.hå’Œ.cppæ¨¡æ¿å®šä¹‰</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> <span class="class"><span class="keyword">class</span> <span class="title">Array</span>&lt;int&gt;;</span>  <span class="comment">//â­æ˜¾å¼å®ä¾‹åŒ–æ¨¡æ¿Array&lt;int&gt;</span></span><br><span class="line"><span class="keyword">template</span> <span class="class"><span class="keyword">class</span> <span class="title">Array</span>&lt;double&gt;;</span> <span class="comment">//â­æ˜¾å¼å®ä¾‹åŒ–æ¨¡æ¿Array&lt;double&gt;</span></span><br><span class="line"><span class="comment">//åœ¨è¿™é‡Œå®ä¾‹åŒ–å…¶ä»–æ¨¡æ¿</span></span><br></pre></td></tr></table></figure><p>â€œæ¨¡æ¿ç±»â€å‘½ä»¤ä½¿ç¼–è¯‘å™¨æ˜¾å¼å®ä¾‹åŒ–æ¨¡æ¿ç±»ã€‚</p><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç¼–è¯‘å™¨ä¼šåœ¨<code>template .cpp</code>ä¸­ æ¨¡æ¿å°åˆ·å‡º<code>Array&lt;int&gt;</code> å’Œ <code>Array&lt;double&gt;</code>ã€‚å› ä¸ºtemplates.cppåœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œè¿™ä¸ªå°†ä¼šè¢«ç¼–è¯‘ã€‚ç„¶åå¯ä»¥ä»å…¶ä»–åœ°æ–¹é“¾æ¥è¿™äº›å‡½æ•°ã€‚</p></div></section></article></div><div class="post-wrapper"><article class="post white-box shadow reveal"><section class="meta"><div class="meta" id="header-meta"><h2 class="title"><a href="/archives/28492eb.html">C&C++/å‡½æ•°æ¨¡æ¿å®ä¾‹åŒ–</a></h2><div class="new-meta-box"><div class="new-meta-item author"><a href="https://longlongqin.github.io" rel="nofollow"><img src="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/image/loading.gif" data-original="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/photo.jpg"><p>longlongin</p></a></div><div class="new-meta-item date"><a class="notlink"><i class="fas fa-edit" aria-hidden="true"></i><p>å‘å¸ƒäºï¼š2020å¹´5æœˆ15æ—¥</p></a></div><div class="new-meta-item wordcount"><a class="notlink"><i class="fas fa-keyboard" aria-hidden="true"></i><p>å­—æ•°ï¼š1.1kå­—</p></a></div><div class="new-meta-item readtime"><a class="notlink"><i class="fas fa-hourglass-half" aria-hidden="true"></i><p>æ—¶é•¿ï¼š4åˆ†é’Ÿ</p></a></div></div><hr></div></section><section class="article typo"><div class="article-entry" itemprop="articleBody"><p>åŸæ–‡ï¼š</p><p><a href="https://www.learncpp.com/cpp-tutorial/132-function-template-instances/" target="_blank" rel="noopener">https://www.learncpp.com/cpp-tutorial/132-function-template-instances/</a></p><hr><p>æˆ‘ä»¬æœ‰å¿…è¦ç®€è¦äº†è§£ä¸€ä¸‹æ¨¡æ¿å‡½æ•°æ˜¯å¦‚ä½•åœ¨c++ä¸­å®ç°çš„ï¼Œå› ä¸ºå°†æ¥çš„è¯¾ç¨‹å°†ä»¥è¿™äº›æ¦‚å¿µä¸ºåŸºç¡€ã€‚</p><h1 id="å‡½æ•°æ¨¡æ¿å®ä¾‹"><a href="#å‡½æ•°æ¨¡æ¿å®ä¾‹" class="headerlink" title="å‡½æ•°æ¨¡æ¿å®ä¾‹"></a>å‡½æ•°æ¨¡æ¿å®ä¾‹</h1><p><strong>äº‹å®è¯æ˜ï¼Œc++å¹¶æ²¡æœ‰ç›´æ¥ç¼–è¯‘æ¨¡æ¿å‡½æ•°ã€‚</strong></p><p>ç›¸åï¼Œåœ¨ç¼–è¯‘æ—¶<strong>ï¼Œå½“ç¼–è¯‘å™¨é‡åˆ°å¯¹æ¨¡æ¿å‡½æ•°çš„è°ƒç”¨æ—¶ï¼Œå®ƒå¤åˆ¶æ¨¡æ¿å‡½æ•°å¹¶ç”¨å®é™…ç±»å‹æ›¿æ¢æ¨¡æ¿ç±»å‹å‚æ•°ã€‚</strong> å…·æœ‰å®é™…ç±»å‹çš„å‡½æ•°ç§°ä¸º<strong>å‡½æ•°æ¨¡æ¿å®ä¾‹</strong>ã€‚</p><p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹çš„ä¸€ä¸ªä¾‹å­ã€‚</p><ul><li><p>é¦–å…ˆï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ¨¡æ¿å‡½æ•°:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="comment">// è¿™æ˜¯æ¨¡æ¿å‚æ•°å£°æ˜</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> T&amp; <span class="title">max</span><span class="params">(<span class="keyword">const</span> T&amp; x, <span class="keyword">const</span> T&amp; y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x &gt; y) ? x : y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘ç¨‹åºæ—¶ï¼Œç¼–è¯‘å™¨é‡åˆ°ä¸€ä¸ªè°ƒç”¨æ¨¡æ¿å‡½æ•°:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i&#123; <span class="built_in">max</span>(<span class="number">3</span>, <span class="number">7</span>) &#125;; <span class="comment">// calls max(int, int)</span></span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å™¨ä¼šè¯´ï¼Œâ€œå“¦ï¼Œæˆ‘ä»¬è¦è°ƒç”¨max(int, int)â€ <strong>ç¼–è¯‘å™¨å¤åˆ¶å‡½æ•°æ¨¡æ¿å¹¶åˆ›å»ºæ¨¡æ¿å®ä¾‹max(int, int)</strong>:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">const</span> <span class="keyword">int</span>&amp; <span class="title">max</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span>&amp; x, <span class="keyword">const</span> <span class="keyword">int</span>&amp; y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x&gt;y) ? x : y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¿™ç°åœ¨æ˜¯ä¸€ä¸ªå¯ä»¥è¢«ç¼–è¯‘æˆæœºå™¨è¯­è¨€çš„â€œæ™®é€šå‡½æ•°â€ã€‚</strong></p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬åœ¨ç¨åçš„ä»£ç ä¸­ä½¿ç”¨ä¸åŒçš„ç±»å‹å†æ¬¡è°ƒç”¨max():</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> d&#123;<span class="built_in">max</span>(<span class="number">6.34</span>, <span class="number">18.523</span>) &#125;; <span class="comment">// calls max(double, double)</span></span><br></pre></td></tr></table></figure><p>c++è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ¨¡æ¿å®ä¾‹ï¼šmax(doubleï¼Œdouble):</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">const</span> <span class="keyword">double</span>&amp; <span class="title">max</span><span class="params">(<span class="keyword">const</span> <span class="keyword">double</span>&amp; x, <span class="keyword">const</span> <span class="keyword">double</span>&amp; y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x&gt;y) ? x : y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åç¼–è¯‘å®ƒã€‚</p></li></ul><p>ç¼–è¯‘å™¨è¶³å¤Ÿèªæ˜ï¼Œ<u>çŸ¥é“å®ƒåªéœ€è¦ä¸ºæ¯ç»„æƒŸä¸€ç±»å‹å‚æ•°(æ¯ä¸ªæ–‡ä»¶) åˆ›å»ºä¸€ä¸ªæ¨¡æ¿å®ä¾‹ã€‚</u></p><p>è¿˜æœ‰ï¼Œ<u>å¦‚æœæ‚¨åˆ›å»ºäº†ä¸€ä¸ªæ¨¡æ¿å‡½æ•°ï¼Œä½†æ˜¯æ²¡æœ‰è°ƒç”¨å®ƒï¼Œé‚£ä¹ˆå°†ä¸ä¼šåˆ›å»ºä»»ä½•æ¨¡æ¿å®ä¾‹ã€‚</u></p><h1 id="æ“ä½œç¬¦ã€å‡½æ•°è°ƒç”¨å’Œå‡½æ•°æ¨¡æ¿"><a href="#æ“ä½œç¬¦ã€å‡½æ•°è°ƒç”¨å’Œå‡½æ•°æ¨¡æ¿" class="headerlink" title="æ“ä½œç¬¦ã€å‡½æ•°è°ƒç”¨å’Œå‡½æ•°æ¨¡æ¿"></a>æ“ä½œç¬¦ã€å‡½æ•°è°ƒç”¨å’Œå‡½æ•°æ¨¡æ¿</h1><p>æ¨¡æ¿å‡½æ•°å¯ä»¥ä½¿ç”¨<strong>å†…ç½®ç±»å‹</strong>(ä¾‹å¦‚charã€intã€doubleç­‰)å’Œ<strong>ç±»</strong>ã€‚</p><blockquote><p>ä½†æ˜¯æˆ‘ä»¬éœ€è¦æ³¨æ„ï¼š</p><p>å½“ç¼–è¯‘å™¨ç¼–è¯‘æ¨¡æ¿å®ä¾‹æ—¶ï¼Œå®ƒåƒæ™®é€šå‡½æ•°ä¸€æ ·ç¼–è¯‘å®ƒã€‚<strong>åœ¨æ™®é€šå‡½æ•°ä¸­ï¼Œå¿…é¡»å®šä¹‰ä¸ç±»å‹ä¸€èµ·ä½¿ç”¨çš„ä»»ä½•æ“ä½œç¬¦æˆ–å‡½æ•°è°ƒç”¨ï¼Œå¦åˆ™å°†å¾—åˆ°ç¼–è¯‘å™¨é”™è¯¯ã€‚</strong></p></blockquote><p>ç±»ä¼¼åœ°ï¼Œ<strong><u>æ¨¡æ¿å‡½æ•°ä¸­çš„ä»»ä½• æ“ä½œç¬¦æˆ–å‡½æ•°è°ƒç”¨ éƒ½å¿…é¡»</u>ä¸ºå®ä¾‹åŒ–å‡½æ•°æ¨¡æ¿çš„ä»»ä½•ç±»å‹ <u>å®šä¹‰</u></strong>ã€‚</p><p>è®©æˆ‘ä»¬æ›´è¯¦ç»†åœ°çœ‹çœ‹è¿™ä¸ªï¼š</p><ul><li><p>é¦–å…ˆï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªç®€å•çš„ç±»:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cents</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> m_cents;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Cents(<span class="keyword">int</span> cents)</span><br><span class="line">        : m_cents&#123; cents &#125;</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å½“æˆ‘ä»¬å°è¯•è°ƒç”¨å¸¦æœ‰Centsç±»çš„æ¨¡æ¿åŒ–max()å‡½æ•°æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="comment">//  è¿™æ˜¯æ¨¡æ¿å‚æ•°å£°æ˜</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> T&amp; <span class="title">max</span><span class="params">(<span class="keyword">const</span> T&amp; x, <span class="keyword">const</span> T&amp; y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x &gt; y) ? x : y;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cents</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> m_cents;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Cents(<span class="keyword">int</span> cents)</span><br><span class="line">        : m_cents&#123; cents &#125;</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Cents nickle&#123; <span class="number">5</span> &#125;;</span><br><span class="line">    Cents dime&#123; <span class="number">10</span> &#125;;</span><br><span class="line"> </span><br><span class="line">    Cents bigger&#123; <span class="built_in">max</span>(nickle, dime) &#125;;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>c++å°†ä¸ºmax()åˆ›å»ºä¸€ä¸ªæ¨¡æ¿å®ä¾‹ï¼Œçœ‹èµ·æ¥åƒè¿™æ ·:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">const</span> Cents&amp; <span class="title">max</span><span class="params">(<span class="keyword">const</span> Cents &amp;x, <span class="keyword">const</span> Cents &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x &gt; y) ? x : y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå®ƒä¼šå°è¯•ç¼–è¯‘è¿™ä¸ªå‡½æ•°ã€‚çœ‹åˆ°é—®é¢˜äº†å—?</p><p>c++ä¸èƒ½è®¡ç®—x &gt; yï¼Œå› ä¸ºxå’Œyæ˜¯ Cents ç±»å¯¹è±¡ï¼Œç¼–è¯‘å™¨ä¸çŸ¥é“å¦‚ä½•æ¯”è¾ƒå®ƒä»¬ã€‚å› æ­¤ï¼Œ<u>è¿™å°†äº§ç”Ÿä¸€ä¸ªç¼–è¯‘é”™è¯¯</u>ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1&gt;c:\consoleapplication1\main.cpp(4): error C2676: binary &#39;&gt;&#39;: &#39;const Cents&#39; does not define this operator or a conversion to a type acceptable to the predefined operator</span><br><span class="line">1&gt;  c:\consoleapplication1\main.cpp(23): note: see reference to function template instantiation &#39;const T &amp;max(const T &amp;,const T &amp;)&#39; being compiled</span><br><span class="line">1&gt;          with</span><br><span class="line">1&gt;          [</span><br><span class="line">1&gt;              T&#x3D;Cents</span><br><span class="line">1&gt;          ]</span><br></pre></td></tr></table></figure><p><strong>é¡¶éƒ¨çš„é”™è¯¯æ¶ˆæ¯æŒ‡å‡ºäº†è¿™æ ·ä¸€ä¸ªäº‹å®: å¯¹äºCentsç±»ï¼Œæ²¡æœ‰é‡è½½æ“ä½œç¬¦<code>&gt;</code>ã€‚</strong></p><p><strong>åº•éƒ¨çš„é”™è¯¯æŒ‡å‡ºäº†å¼•å‘é”™è¯¯çš„æ¨¡æ¿åŒ–å‡½æ•°è°ƒç”¨ï¼Œä»¥åŠæ¨¡æ¿åŒ–å‚æ•°çš„ç±»å‹ã€‚</strong></p></li></ul><p><strong>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€é‡è½½ä»»ä½•æˆ‘ä»¬å¸Œæœ›ä½¿ç”¨max()çš„ç±»çš„<code>&gt;</code>æ“ä½œç¬¦:</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cents</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> m_cents;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Cents(<span class="keyword">int</span> cents)</span><br><span class="line">        : m_cents&#123; cents &#125;</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">bool</span> <span class="keyword">operator</span>&gt;(<span class="keyword">const</span> Cents &amp;c1, <span class="keyword">const</span> Cents &amp;c2) <span class="comment">//é‡è½½æ“ä½œç¬¦ &gt; ï¼Œä»è€Œæ¨¡æ¿å®ä¾‹ä¸­å¯ä»¥ä½¿ç”¨è¯¥é‡è½½æ“ä½œç¬¦&gt;</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> (c1.m_cents &gt; c2.m_cents);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨c++å°†çŸ¥é“å½“xå’Œyæ˜¯Centsç±»çš„å¯¹è±¡æ—¶ï¼Œå¦‚ä½•æ¯”è¾ƒx &gt; y ! å› æ­¤ï¼Œæˆ‘ä»¬çš„max()å‡½æ•°ç°åœ¨å°†å¤„ç†ä¸¤ä¸ªç±»å‹ä¸ºCentsçš„å¯¹è±¡ã€‚</p></div></section></article></div><div class="post-wrapper"><article class="post white-box shadow reveal"><section class="meta"><div class="meta" id="header-meta"><h2 class="title"><a href="/archives/454c1de9.html">C&C++/å‡½æ•°æ¨¡æ¿</a></h2><div class="new-meta-box"><div class="new-meta-item author"><a href="https://longlongqin.github.io" rel="nofollow"><img src="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/image/loading.gif" data-original="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/photo.jpg"><p>longlongin</p></a></div><div class="new-meta-item date"><a class="notlink"><i class="fas fa-edit" aria-hidden="true"></i><p>å‘å¸ƒäºï¼š2020å¹´5æœˆ15æ—¥</p></a></div><div class="new-meta-item wordcount"><a class="notlink"><i class="fas fa-keyboard" aria-hidden="true"></i><p>å­—æ•°ï¼š2.1kå­—</p></a></div><div class="new-meta-item readtime"><a class="notlink"><i class="fas fa-hourglass-half" aria-hidden="true"></i><p>æ—¶é•¿ï¼š7åˆ†é’Ÿ</p></a></div></div><hr></div></section><section class="article typo"><div class="article-entry" itemprop="articleBody"><p>åŸæ–‡ï¼š</p><p><a href="https://www.learncpp.com/cpp-tutorial/131-function-templates/" target="_blank" rel="noopener">https://www.learncpp.com/cpp-tutorial/131-function-templates/</a></p><hr><p>åœ¨å‰å‡ ç« ä¸­ï¼Œæ‚¨å·²ç»å­¦ä¹ äº†å¦‚ä½•ç¼–å†™å‡½æ•°å’Œç±»ï¼Œè¿™äº›å‡½æ•°å’Œç±»æœ‰åŠ©äºä½¿ç¨‹åºæ›´å®¹æ˜“ç¼–å†™ã€æ›´å®‰å…¨ã€æ›´æ˜“äºç»´æŠ¤ã€‚è™½ç„¶å‡½æ•°å’Œç±»æ˜¯æœ‰æ•ˆç¼–ç¨‹çš„å¼ºå¤§è€Œçµæ´»çš„å·¥å…·ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®ƒä»¬ä¹Ÿå¯èƒ½æœ‰ä¸€äº›é™åˆ¶ï¼Œå› ä¸ºc++è¦æ±‚æŒ‡å®šæ‰€æœ‰å‚æ•°çš„ç±»å‹ã€‚</p><p>ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨æƒ³ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥è®¡ç®—ä¸¤ä¸ªæ•°å­—çš„æœ€å¤§å€¼ã€‚ä½ å¯ä»¥è¿™æ ·åš:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x &gt; y) ? x : y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°å¯¹äºæ•´æ•°éå¸¸æœ‰ç”¨ã€‚å½“æ‚¨æ„è¯†åˆ°max()å‡½æ•°éœ€è¦ä½¿ç”¨doubleæ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆ? <u>ä¼ ç»Ÿä¸Šï¼Œè§£å†³æ–¹æ³•æ˜¯é‡è½½max()å‡½æ•°ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªä½¿ç”¨åŒç²¾åº¦æµ®ç‚¹æ•°çš„æ–°ç‰ˆæœ¬:</u></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">max</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">double</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x &gt; y) ? x : y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œmax()çš„åŒç‰ˆæœ¬å®ç°çš„ä»£ç ä¸max()çš„intç‰ˆæœ¬å®Œå…¨ç›¸åŒ! äº‹å®ä¸Šï¼Œè¿™ä¸ªå®ç°é€‚ç”¨äºæ‰€æœ‰ä¸åŒçš„ç±»å‹:charã€intã€double ! ä½†æ˜¯ï¼Œ<u>å› ä¸ºc++è¦æ±‚æ‚¨ä½¿å˜é‡å…·æœ‰ç‰¹å®šçš„ç±»å‹ï¼Œæ‰€ä»¥æ‚¨å¿…é¡»ä¸ºå¸Œæœ›ä½¿ç”¨çš„æ¯ç§ç±»å‹ç¼–å†™ä¸€ä¸ªå‡½æ•°ã€‚</u></p><p>å¿…é¡»ä¸ºåŒä¸€ä¸ªå‡½æ•°æŒ‡å®šä¸åŒçš„â€œé£æ ¼â€ï¼Œå…¶ä¸­æƒŸä¸€æ”¹å˜çš„æ˜¯å‚æ•°çš„ç±»å‹ï¼Œè¿™å¯èƒ½ä¼šæˆä¸ºç»´æŠ¤ä¸Šçš„éº»çƒ¦å’Œæ—¶é—´ä¸Šçš„æµªè´¹ï¼Œè€Œä¸”ä¹Ÿè¿åäº†ä¸€èˆ¬çš„ç¼–ç¨‹å‡†åˆ™ï¼Œå³å°½å¯èƒ½å‡å°‘é‡å¤çš„ä»£ç ã€‚<strong>å¦‚æœæˆ‘ä»¬å¯ä»¥ç¼–å†™max()çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå¯ä»¥å¤„ç†ä»»ä½•ç±»å‹çš„å‚æ•°ï¼Œè¿™ä¸æ˜¯å¾ˆå¥½å—?</strong></p><p>æ¬¢è¿æ¥åˆ°<strong>æ¨¡æ¿</strong>çš„ä¸–ç•Œã€‚</p><h1 id="ä»€ä¹ˆæ˜¯å‡½æ•°æ¨¡æ¿"><a href="#ä»€ä¹ˆæ˜¯å‡½æ•°æ¨¡æ¿" class="headerlink" title="ä»€ä¹ˆæ˜¯å‡½æ•°æ¨¡æ¿?"></a>ä»€ä¹ˆæ˜¯å‡½æ•°æ¨¡æ¿?</h1><blockquote><p>å¦‚æœä½ åœ¨å­—å…¸ä¸­æŸ¥æ‰¾â€œtemplateâ€è¿™ä¸ªè¯ï¼Œä½ ä¼šå‘ç°å®ƒçš„å®šä¹‰ä¸ä»¥ä¸‹å†…å®¹ç±»ä¼¼:â€œæ¨¡æ¿æ˜¯ä¸€ç§æ¨¡å‹ï¼Œç”¨ä½œåˆ›å»ºç±»ä¼¼å¯¹è±¡çš„æ¨¡å¼â€ã€‚</p></blockquote><p>åœ¨c++ä¸­ï¼Œ<strong>å‡½æ•°æ¨¡æ¿æ˜¯ä½œä¸ºåˆ›å»ºå…¶ä»–ç±»ä¼¼å‡½æ•°çš„æ¨¡å¼çš„å‡½æ•°</strong>ã€‚</p><p>å‡½æ•°æ¨¡æ¿èƒŒåçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼š</p><p><strong>åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œè€Œä¸å¿…æŒ‡å®šæŸäº›æˆ–æ‰€æœ‰å˜é‡çš„ç¡®åˆ‡ç±»å‹</strong>ã€‚<strong>æˆ‘ä»¬ä½¿ç”¨å ä½ç¬¦ç±»å‹å®šä¹‰å‡½æ•°ï¼Œç§°ä¸ºæ¨¡æ¿ç±»å‹å‚æ•°</strong>ã€‚ä¸€æ—¦æˆ‘ä»¬ä½¿ç”¨è¿™äº›å ä½ç¬¦ç±»å‹åˆ›å»ºäº†ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å°±æœ‰æ•ˆåœ°åˆ›å»ºäº†ä¸€ä¸ª<strong>â€œå‡½æ•°æ¨¡æ¿â€</strong>ã€‚</p><p><strong>å½“æ‚¨è°ƒç”¨ä¸€ä¸ªæ¨¡æ¿å‡½æ•°æ—¶</strong>ï¼Œ<u>ç¼–è¯‘å™¨ä¼šâ€œæ¨¡æ¿åŒ–â€å‡ºæ¨¡æ¿çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œç”¨å‡½æ•°è°ƒç”¨ä¸­çš„å‚æ•°ä¸­çš„å®é™…å˜é‡ç±»å‹æ›¿æ¢å ä½ç¬¦ç±»å‹</u> !ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œç¼–è¯‘å™¨å¯ä»¥ä»ä¸€ä¸ªæ¨¡æ¿åˆ›å»ºå¤šä¸ªå‡½æ•°çš„â€œé£æ ¼â€! åœ¨ä¸‹ä¸€è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†æ›´è¯¦ç»†åœ°äº†è§£è¿™ä¸ªè¿‡ç¨‹ã€‚</p><h1 id="åœ¨C-ä¸­åˆ›å»ºå‡½æ•°æ¨¡æ¿"><a href="#åœ¨C-ä¸­åˆ›å»ºå‡½æ•°æ¨¡æ¿" class="headerlink" title="åœ¨C++ä¸­åˆ›å»ºå‡½æ•°æ¨¡æ¿"></a>åœ¨C++ä¸­åˆ›å»ºå‡½æ•°æ¨¡æ¿</h1><p>æ­¤æ—¶ï¼Œæ‚¨å¯èƒ½æƒ³çŸ¥é“å¦‚ä½•åœ¨c++ä¸­å®é™…åˆ›å»ºå‡½æ•°æ¨¡æ¿ã€‚äº‹å®è¯æ˜ï¼Œè¿™å¹¶æ²¡æœ‰é‚£ä¹ˆéš¾ã€‚</p><blockquote><p>è®©æˆ‘ä»¬å†æ¥çœ‹çœ‹max()çš„intç‰ˆæœ¬:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x &gt; y) ? x : y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œæœ‰3ä¸ªåœ°æ–¹ä½¿ç”¨äº†ç‰¹å®šçš„ç±»å‹: å‚æ•°<u>xã€yå’Œ è¿”å›å€¼</u> éƒ½æŒ‡å®šå®ƒä»¬å¿…é¡»æ˜¯æ•´æ•°ã€‚<strong>è¦åˆ›å»ºå‡½æ•°æ¨¡æ¿ï¼Œæˆ‘ä»¬å°†ç”¨å ä½ç¬¦ç±»å‹æ›¿æ¢è¿™äº›ç‰¹å®šç±»å‹ã€‚</strong></p><p><u>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå› ä¸ºæˆ‘ä»¬åªæœ‰ä¸€ç§ç±»å‹éœ€è¦æ›¿æ¢(int)ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªæ¨¡æ¿ç±»å‹å‚æ•°ã€‚</u></p></blockquote><p><u>æ‚¨å¯ä»¥ä¸ºå ä½ç¬¦ç±»å‹å‘½åå‡ ä¹ä»»ä½•æ‚¨æƒ³è¦çš„åç§°ï¼Œåªè¦å®ƒä¸æ˜¯ä¿ç•™å­—</u>ã€‚ç„¶è€Œï¼Œ<strong>åœ¨c++ä¸­ï¼Œä¹ æƒ¯ä¸Šå°†æ¨¡æ¿ç±»å‹å‘½åä¸ºå­—æ¯T(â€œTypeâ€çš„ç¼©å†™)ã€‚</strong></p><p>â€‹ è¿™æ˜¯æˆ‘ä»¬çš„æ–°å‡½æ•°ä¸å ä½ç¬¦ç±»å‹:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">T <span class="title">max</span><span class="params">(T x, T y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x &gt; y) ? x : y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªå¥½çš„å¼€å§‹â€”â€”ä½†æ˜¯ï¼Œå®ƒä¸ä¼šç¼–è¯‘ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¸çŸ¥é“â€œTâ€æ˜¯ä»€ä¹ˆ!</p><p>ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰ç¼–è¯‘å™¨ä¸¤ä»¶äº‹:â­â­</p><ul><li>ç¬¬ä¸€ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¨¡æ¿å®šä¹‰ï¼Œ</li><li>ç¬¬äºŒï¼ŒTæ˜¯ä¸€ä¸ªå ä½ç¬¦ç±»å‹ã€‚</li></ul><p>æˆ‘ä»¬å¯ä»¥åœ¨ä¸€è¡Œä¸­å®Œæˆè¿™ä¸¤ä»¶äº‹ï¼Œä½¿ç”¨æ‰€è°“çš„<strong>æ¨¡æ¿å‚æ•°å£°æ˜( template parameter declaration)</strong>:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="comment">// è¿™æ˜¯æ¨¡æ¿å‚æ•°å£°æ˜  (åœ¨è¿™é‡Œå¯ä»¥ä½¿ç”¨â­ typename  æˆ–è€… class)</span></span><br><span class="line"><span class="function">T <span class="title">max</span><span class="params">(T x, T y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x &gt; y) ? x : y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç¨å¾®ä»”ç»†çœ‹çœ‹æ¨¡æ¿å‚æ•°å£°æ˜ï¼š</p><ul><li><p>æˆ‘ä»¬ä»å¼€å§‹äºï¼š<strong>å…³é”®å­—<code>template</code></strong></p><blockquote><p>è¿™å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œæ¥ä¸‹æ¥çš„å†…å®¹å°†æ˜¯ä¸€ä¸ª<strong>æ¨¡æ¿å‚æ•°åˆ—è¡¨</strong>ã€‚æˆ‘ä»¬<strong>å°†æ‰€æœ‰å‚æ•°æ”¾åœ¨å°–æ‹¬å·ä¸­(<code>&lt;&gt;</code>)ã€‚</strong></p><p><strong>è¦åˆ›å»ºæ¨¡æ¿ç±»å‹å‚æ•°ï¼Œè¯·ä½¿ç”¨å…³é”®å­—<code>typename</code>æˆ–<code>class</code></strong>ã€‚</p><blockquote><p>è¿™ä¸¤ä¸ªå…³é”®å­—åœ¨ä¸Šä¸‹æ–‡ä¸­æ²¡æœ‰åŒºåˆ«ï¼Œæ‰€ä»¥ä½¿ç”¨å“ªä¸ªå…³é”®å­—å–å†³äºæ‚¨è‡ªå·±ã€‚æ³¨æ„ï¼Œå¦‚æœä½¿ç”¨classå…³é”®å­—ï¼Œä¼ å…¥çš„ç±»å‹å®é™…ä¸Šä¸å¿…æ˜¯ä¸€ä¸ªç±»(å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªåŸºæœ¬å˜é‡ã€æŒ‡é’ˆæˆ–å…¶ä»–åŒ¹é…çš„ä¸œè¥¿)ã€‚</p></blockquote></blockquote></li><li><p>ç„¶åå‘½åæ‚¨çš„ç±»å‹(<strong>é€šå¸¸ä¸ºâ€œTâ€</strong>)ã€‚</p></li></ul><p><strong>å¦‚æœæ¨¡æ¿å‡½æ•°ä½¿ç”¨å¤šä¸ªæ¨¡æ¿ç±»å‹å‚æ•°</strong>ï¼Œå®ƒä»¬å¯ä»¥ç”¨<strong>é€—å·</strong>åˆ†éš”:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T1, <span class="keyword">typename</span> T2&gt;</span><br><span class="line"><span class="comment">// template function here</span></span><br></pre></td></tr></table></figure><blockquote><p><strong>å¯¹äºä½¿ç”¨ä¸æ­¢ä¸€ç§ç±»å‹</strong>çš„ï¼Œ<strong>é€šå¸¸ä¼šçœ‹åˆ°å®ƒä»¬è¢«å‘½åä¸ºâ€œT1â€å’Œâ€œT2â€ï¼Œæˆ–è€…å…¶ä»–å•ä¸ªå¤§å†™å­—æ¯çš„åç§°ï¼Œä¾‹å¦‚â€œSâ€ã€‚</strong></p></blockquote><p>æœ€åä¸€ç‚¹æ³¨æ„:</p><p>å› ä¸ºä¼ å…¥Tç±»å‹çš„å‡½æ•°å‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ª<strong>ç±»ç±»å‹</strong>ï¼Œ<strong>é€šè¿‡å€¼ä¼ é€’ç±»é€šå¸¸ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œæ‰€ä»¥æœ€å¥½è®©æ¨¡æ¿å‡½æ•°çš„å‚æ•°å’Œè¿”å›ç±»å‹å¼•ç”¨:</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">const T&amp; max(const T&amp; x, const T&amp; y) â­</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> (x &gt; y) ? x : y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä½¿ç”¨å‡½æ•°æ¨¡æ¿"><a href="#ä½¿ç”¨å‡½æ•°æ¨¡æ¿" class="headerlink" title="ä½¿ç”¨å‡½æ•°æ¨¡æ¿"></a>ä½¿ç”¨å‡½æ•°æ¨¡æ¿</h1><p>ä½¿ç”¨å‡½æ•°æ¨¡æ¿éå¸¸ç®€å•â€”â€”æ‚¨å¯ä»¥åƒä½¿ç”¨å…¶ä»–å‡½æ•°ä¸€æ ·ä½¿ç”¨å®ƒã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¨‹åºä½¿ç”¨æˆ‘ä»¬çš„æ¨¡æ¿å‡½æ•°:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">const</span> T&amp; <span class="title">max</span><span class="params">(<span class="keyword">const</span> T&amp; x, <span class="keyword">const</span> T&amp; y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x &gt; y) ? x : y;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="built_in">max</span>(<span class="number">3</span>, <span class="number">7</span>); <span class="comment">// returns 7</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">double</span> d = <span class="built_in">max</span>(<span class="number">6.34</span>, <span class="number">18.523</span>); <span class="comment">// returns 18.523</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; d &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">char</span> ch = <span class="built_in">max</span>(<span class="string">'a'</span>, <span class="string">'6'</span>); <span class="comment">// returns 'a'</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; ch &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*ç»“æœ*/</span></span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="number">18.523</span></span><br><span class="line">a</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œæ‰€æœ‰è¿™ä¸‰ä¸ªå¯¹max()çš„è°ƒç”¨éƒ½æœ‰ä¸åŒç±»å‹çš„å‚æ•°! å› ä¸ºæˆ‘ä»¬è°ƒç”¨äº†å…·æœ‰3ç§ä¸åŒç±»å‹çš„å‡½æ•°ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨å°†ä½¿ç”¨æ¨¡æ¿å®šä¹‰æ¥åˆ›å»ºè¯¥å‡½æ•°çš„3ä¸ªä¸åŒç‰ˆæœ¬ï¼š</p><ul><li>ä¸€ä¸ªå¸¦æœ‰intå‚æ•°(åä¸ºï¼š<code>max&lt;int&gt;</code>)ï¼Œ</li><li>ä¸€ä¸ªå…·æœ‰doubleå‚æ•°(åä¸ºï¼š<code>max&lt;double&gt;</code>)ï¼Œ</li><li>ä¸€ä¸ªå¸¦æœ‰charå‚æ•°(åä¸ºï¼š<code>max&lt;char&gt;</code>)ã€‚</li></ul><p>æ³¨æ„ï¼Œ<strong>åªè¦ç¼–è¯‘å™¨èƒ½å¤Ÿä»å‚æ•°ç±»å‹æ¨æ–­å‡ºæ¨¡æ¿ç±»å‹ï¼Œå°±ä¸éœ€è¦åœ¨å‡½æ•°åä¸­æ˜¾å¼åœ°æŒ‡å®šæ¨¡æ¿ç±»å‹(ä¾‹å¦‚max<int>çš„<int>éƒ¨åˆ†)ã€‚</int></int></strong></p><h1 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h1><p>1ã€</p><p>æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œæ¨¡æ¿å‡½æ•°å¯ä»¥èŠ‚çœå¤§é‡æ—¶é—´ï¼Œå› ä¸ºæ‚¨åªéœ€è¦ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œè€Œä¸”å®ƒå¯ä»¥ä¸è®¸å¤šä¸åŒçš„ç±»å‹ä¸€èµ·å·¥ä½œã€‚</p><p>ä¸€æ—¦æ‚¨ä¹ æƒ¯äº†ç¼–å†™å‡½æ•°æ¨¡æ¿ï¼Œæ‚¨å°±ä¼šå‘ç°ç¼–å†™å®ƒä»¬å®é™…ä¸Šå¹¶ä¸æ¯”ç¼–å†™å…·æœ‰å®é™…ç±»å‹çš„å‡½æ•°èŠ±è´¹æ›´å¤šçš„æ—¶é—´ã€‚</p><p>æ¨¡æ¿å‡½æ•°å‡å°‘äº†ä»£ç ç»´æŠ¤ï¼Œå› ä¸ºé‡å¤çš„ä»£ç æ˜æ˜¾å‡å°‘ã€‚</p><p>æœ€åï¼Œæ¨¡æ¿å‡½æ•°å¯ä»¥æ›´å®‰å…¨ï¼Œå› ä¸ºå½“æ‚¨éœ€è¦å‡½æ•°å¤„ç†æ–°ç±»å‹æ—¶ï¼Œä¸éœ€è¦æ‰‹åŠ¨å¤åˆ¶å‡½æ•°å’Œæ›´æ”¹ç±»å‹ !</p><p>2ã€</p><p>æ¨¡æ¿å‡½æ•°ç¡®å®æœ‰ä¸€äº›ç¼ºç‚¹ï¼Œå¦‚æœæˆ‘ä»¬ä¸æå®ƒä»¬ï¼Œé‚£å°±å¤ªä¸å°å¿ƒäº†ï¼š</p><ul><li><p>é¦–å…ˆï¼Œä¸€äº›è¾ƒè€çš„ç¼–è¯‘å™¨æ²¡æœ‰å¾ˆå¥½çš„æ”¯æŒ æ¨¡æ¿ã€‚</p><blockquote><p>ç„¶è€Œï¼Œè¿™ä¸ªç¼ºç‚¹ä¸å†åƒä»¥å‰é‚£æ ·æ˜¯ä¸ªå¤§é—®é¢˜ã€‚</p></blockquote></li><li><p>å…¶æ¬¡ï¼Œæ¨¡æ¿å‡½æ•°é€šå¸¸ä¼šäº§ç”Ÿçœ‹èµ·æ¥å¾ˆç–¯ç‹‚çš„é”™è¯¯æ¶ˆæ¯ï¼Œæ¯”æ™®é€šå‡½æ•°æ›´éš¾ç ´è¯‘ã€‚</p></li><li><p>ç¬¬ä¸‰ï¼Œ<strong>æ¨¡æ¿å‡½æ•°ä¼šå¢åŠ ç¼–è¯‘æ—¶é—´å’Œä»£ç å¤§å°</strong>ï¼Œå› ä¸ºå•ä¸ªæ¨¡æ¿å¯èƒ½ä¼šâ€œå®ç°â€å¹¶åœ¨è®¸å¤šæ–‡ä»¶ä¸­é‡æ–°ç¼–è¯‘(æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜)ã€‚</p></li></ul><p><u>ç„¶è€Œï¼Œä¸æ¨¡æ¿ä¸ºæ‚¨çš„ç¼–ç¨‹å·¥å…·åŒ…å¸¦æ¥çš„å¼ºå¤§å’Œçµæ´»æ€§ç›¸æ¯”ï¼Œè¿™äº›ç¼ºé™·æ˜¯ç›¸å½“å°çš„!</u></p><hr><p>æ³¨æ„:</p><ul><li><p>æ ‡å‡†åº“å·²ç»æä¾›äº†æ¨¡æ¿åŒ–çš„max()å‡½æ•°(åœ¨å¤´æ–‡ä»¶<code>algorithm</code>ä¸­)ï¼Œæ‰€ä»¥ä½ ä¸éœ€è¦è‡ªå·±å†™(é™¤éä½ æƒ³å†™)ã€‚</p><blockquote><p>å¦‚æœæ‚¨ç¡®å®ç¼–å†™äº†è‡ªå·±çš„ç‰ˆæœ¬ï¼Œè¯·æ³¨æ„<strong>ï¼Œå¦‚æœæ‚¨ä½¿ç”¨è¯­å¥â€œ<code>using namespace std;</code>â€ï¼Œå¯èƒ½ä¼šå‡ºç°å‘½åå†²çªï¼Œå› ä¸ºç¼–è¯‘å™¨å°†æ— æ³•åˆ¤æ–­æ‚¨æ˜¯æƒ³è¦max()ç‰ˆæœ¬è¿˜æ˜¯std::max()ç‰ˆæœ¬ã€‚</strong></p></blockquote></li></ul></div></section></article></div><div class="post-wrapper"><article class="post white-box shadow reveal"><section class="meta"><div class="meta" id="header-meta"><h2 class="title"><a href="/archives/1639a92e.html">C&C++/ä½¿ç”¨æ“ä½œç¬¦â€œã€Šâ€æ‰“å°ç»§æ‰¿ç±»</a></h2><div class="new-meta-box"><div class="new-meta-item author"><a href="https://longlongqin.github.io" rel="nofollow"><img src="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/image/loading.gif" data-original="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/photo.jpg"><p>longlongin</p></a></div><div class="new-meta-item date"><a class="notlink"><i class="fas fa-edit" aria-hidden="true"></i><p>å‘å¸ƒäºï¼š2020å¹´5æœˆ15æ—¥</p></a></div><div class="new-meta-item wordcount"><a class="notlink"><i class="fas fa-keyboard" aria-hidden="true"></i><p>å­—æ•°ï¼š1.5kå­—</p></a></div><div class="new-meta-item readtime"><a class="notlink"><i class="fas fa-hourglass-half" aria-hidden="true"></i><p>æ—¶é•¿ï¼š6åˆ†é’Ÿ</p></a></div></div><hr></div></section><section class="article typo"><div class="article-entry" itemprop="articleBody"><p>åŸæ–‡ï¼š</p><p><a href="https://www.learncpp.com/cpp-tutorial/12-10-printing-inherited-classes-using-operator/" target="_blank" rel="noopener">https://www.learncpp.com/cpp-tutorial/12-10-printing-inherited-classes-using-operator/</a></p><hr><p>è€ƒè™‘ä»¥ä¸‹ä½¿ç”¨è™šæ‹Ÿå‡½æ•°çš„ç¨‹åº:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Base() &#123;&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Base"</span>;  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> :</span> <span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Derived() &#123;&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> <span class="keyword">const</span> <span class="keyword">override</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Derived"</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Derived d;</span><br><span class="line">	Base &amp;b = d;</span><br><span class="line">	b.<span class="built_in">print</span>(); <span class="comment">// will call Derived::print()</span></span><br><span class="line"> </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‚¨åº”è¯¥å·²ç»ç†Ÿæ‚‰äº†è¿™æ ·ä¸€ä¸ªäº‹å®: <strong>b.print()å°†è°ƒç”¨Derived::print()(å› ä¸ºbæŒ‡å‘ä¸€ä¸ªæ´¾ç”Ÿç±»å¯¹è±¡ï¼ŒBase::print()æ˜¯ä¸€ä¸ªè™šå‡½æ•°ï¼Œè€ŒDerived::print()æ˜¯ä¸€ä¸ªè¦†ç›–å‡½æ•°)ã€‚</strong></p><p>è™½ç„¶è°ƒç”¨è¿™æ ·çš„æˆå‘˜å‡½æ•°æ¥æ‰§è¡Œè¾“å‡ºæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯è¿™ç§ç±»å‹çš„å‡½æ•°ä¸èƒ½å¾ˆå¥½åœ°ä¸std::coutæ··åˆä½¿ç”¨:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Derived d;</span><br><span class="line">	Base &amp;b = d;</span><br><span class="line"> </span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"b is a "</span>;</span><br><span class="line">        b.<span class="built_in">print</span>(); <span class="comment">// æ··ä¹±ï¼Œæˆ‘ä»¬å¿…é¡»ä¸­æ–­æ‰“å°è¯­å¥æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨ç»§æ‰¿é‡å†™è¿ç®—ç¬¦&lt;&lt;ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åƒé¢„æœŸçš„é‚£æ ·ä½¿ç”¨è¿ç®—ç¬¦&lt;&lt;ï¼Œå°±åƒè¿™æ ·:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"b is a "</span> &lt;&lt; b &lt;&lt; <span class="string">'\n'</span>; <span class="comment">// much better</span></span><br></pre></td></tr></table></figure><h1 id="æ“ä½œç¬¦-lt-lt-çš„æŒ‘æˆ˜"><a href="#æ“ä½œç¬¦-lt-lt-çš„æŒ‘æˆ˜" class="headerlink" title="æ“ä½œç¬¦&lt;&lt;çš„æŒ‘æˆ˜"></a>æ“ä½œç¬¦<code>&lt;&lt;</code>çš„æŒ‘æˆ˜</h1><p>è®©æˆ‘ä»¬ä»é‡è½½è¿ç®—ç¬¦&lt;&lt;å¼€å§‹ï¼Œä»¥å…¸å‹çš„æ–¹å¼:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Base() &#123;&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Base"</span>;  &#125;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">friend</span> <span class="built_in">std</span>::ostream&amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp;out, <span class="keyword">const</span> Base &amp;b)</span><br><span class="line">        &#123;</span><br><span class="line">            out &lt;&lt; <span class="string">"Base"</span>;</span><br><span class="line">            <span class="keyword">return</span> out;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> :</span> <span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Derived() &#123;&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> <span class="keyword">const</span> <span class="keyword">override</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Derived"</span>; &#125;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">friend</span> <span class="built_in">std</span>::ostream&amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp;out, <span class="keyword">const</span> Derived &amp;d)</span><br><span class="line">        &#123;</span><br><span class="line">            out &lt;&lt; <span class="string">"Derived"</span>;</span><br><span class="line">            <span class="keyword">return</span> out;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Base b;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; b &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">    Derived d;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; d &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºè¿™é‡Œä¸éœ€è¦è™šæ‹Ÿå‡½æ•°è§£æï¼Œè¿™ä¸ªç¨‹åºåƒæˆ‘ä»¬æœŸæœ›çš„é‚£æ ·å·¥ä½œï¼Œå¹¶æ‰“å°:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Base</span><br><span class="line">Derived</span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œè€ƒè™‘ä»¥ä¸‹main()å‡½æ•°:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Derived d;</span><br><span class="line">    Base &amp;bref = d;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; bref &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*ç»“æœ*/</span></span><br><span class="line">Base</span><br></pre></td></tr></table></figure><p><strong>è¿™å¯èƒ½ä¸æ˜¯æˆ‘ä»¬æ‰€æœŸæœ›çš„ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬çš„æ“ä½œç¬¦&lt;&lt;å¤„ç†åŸºå¯¹è±¡çš„ç‰ˆæœ¬ä¸æ˜¯virtualï¼Œæ‰€ä»¥std::cout &lt;&lt; brefè°ƒç”¨æ“ä½œç¬¦&lt;&lt;å¤„ç†åŸºå¯¹è±¡è€Œä¸æ˜¯æ´¾ç”Ÿå¯¹è±¡çš„ç‰ˆæœ¬ã€‚</strong></p><p>è¿™å°±æ˜¯æŒ‘æˆ˜æ‰€åœ¨ã€‚</p><h2 id="æˆ‘ä»¬å¯ä»¥è®©è¿ç®—ç¬¦-lt-lt-virtualå—-â€”â€”ä¸å¯ä»¥"><a href="#æˆ‘ä»¬å¯ä»¥è®©è¿ç®—ç¬¦-lt-lt-virtualå—-â€”â€”ä¸å¯ä»¥" class="headerlink" title="æˆ‘ä»¬å¯ä»¥è®©è¿ç®—ç¬¦&lt;&lt; virtualå—?â€”â€”ä¸å¯ä»¥"></a>æˆ‘ä»¬å¯ä»¥è®©è¿ç®—ç¬¦<code>&lt;&lt;</code> virtualå—?â€”â€”ä¸å¯ä»¥</h2><p>å¦‚æœè¿™ä¸ªé—®é¢˜æ˜¯æ“ä½œç¬¦&lt;&lt;ä¸æ˜¯è™šçš„ï¼Œæˆ‘ä»¬ä¸èƒ½ç®€å•åœ°è®©å®ƒæˆä¸ºè™šçš„å—?</p><p>ç­”æ¡ˆæ˜¯ï¼š<strong>ä¸å¯ä»¥</strong>ã€‚è¿™æœ‰å¾ˆå¤šåŸå› ã€‚</p><ul><li><p>é¦–å…ˆï¼Œ<strong>åªæœ‰æˆå‘˜å‡½æ•°å¯ä»¥è¢«è™šæ‹ŸåŒ–</strong>â€”â€”è¿™æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºåªæœ‰ç±»å¯ä»¥ä»å…¶ä»–ç±»ç»§æ‰¿ï¼Œè€Œä¸”æ²¡æœ‰åŠæ³•<strong>é‡å†™ï¼ˆè¦†ç›–ï¼‰</strong>ç±»ä¹‹å¤–çš„å‡½æ•° (<strong>å¯ä»¥é‡è½½</strong>éæˆå‘˜å‡½æ•°ï¼Œä½†<strong>ä¸èƒ½è¦†ç›–</strong>å®ƒä»¬)ã€‚</p><blockquote><p>å› ä¸ºæˆ‘ä»¬é€šå¸¸å°†æ“ä½œç¬¦&lt;&lt;ä½œä¸º friend å®ç°ï¼Œ<strong>è€Œfriendä¸è¢«è®¤ä¸ºæ˜¯æˆå‘˜å‡½æ•°ï¼Œæ‰€ä»¥æ“ä½œç¬¦&lt;&lt;çš„friendç‰ˆæœ¬ä¸é€‚åˆè™šæ‹ŸåŒ–ã€‚</strong>(ä¸ºäº†å›é¡¾ä¸ºä»€ä¹ˆæˆ‘ä»¬ç”¨è¿™ç§æ–¹å¼å®ç°è¿ç®—ç¬¦&lt;&lt;ï¼Œè¯·é‡æ¸© <a href="https://www.learncpp.com/cpp-tutorial/94-overloading-operators-using-member-functions/" target="_blank" rel="noopener">9.4 â€“ Overloading operators using member functions</a>)ã€‚</p></blockquote></li><li><p>å…¶æ¬¡ï¼Œå³ä½¿æˆ‘ä»¬å¯ä»¥è™šæ‹ŸåŒ–è¿ç®—ç¬¦&lt;&lt;ï¼Œä¹Ÿå­˜åœ¨è¿™æ ·çš„é—®é¢˜: <code>Base::operator&lt;&lt;</code>å’Œ<code>Derived::operator&lt;&lt;</code> çš„å‡½æ•°å‚æ•°æ˜¯ä¸åŒçš„ (åŸºç‰ˆæœ¬å°†æ¥å— ä¸€ä¸ª Baseå‚æ•°ï¼Œæ´¾ç”Ÿç‰ˆæœ¬å°†æ¥å—ä¸€ä¸ª Derivedå‚æ•°)ã€‚</p><p>å› æ­¤ï¼Œ<strong>æ´¾ç”Ÿç‰ˆæœ¬ä¸ä¼šè¢«è®¤ä¸ºæ˜¯åŸºæœ¬ç‰ˆæœ¬çš„è¦†ç›–ï¼Œå› æ­¤ä¸é€‚åˆè¿›è¡Œè™šå‡½æ•°è§£æã€‚</strong></p></li></ul><h2 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h2><p>äº‹å®è¯æ˜ï¼Œç­”æ¡ˆéå¸¸ç®€å•ã€‚</p><ul><li><p>é¦–å…ˆï¼Œæˆ‘ä»¬åƒå¾€å¸¸ä¸€æ ·åœ¨åŸºç±»ä¸­å°†æ“ä½œç¬¦&lt;&lt;è®¾ç½®ä¸ºfriendã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¸è®©æ“ä½œç¬¦<code>&lt;&lt;</code>è‡ªå·±æ‰“å°ï¼Œè€Œæ˜¯å°†æ­¤èŒè´£å§”æ‰˜ ç»™ä¸€ä¸ªå¯ä»¥è™šæ‹ŸåŒ–çš„æ™®é€šæˆå‘˜å‡½æ•°!</p><blockquote><p>çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Base() &#123;&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">// è¿™æ˜¯é‡è½½è¿ç®—ç¬¦&lt;&lt;</span></span><br><span class="line">	<span class="keyword">friend</span> <span class="built_in">std</span>::ostream&amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp;out, <span class="keyword">const</span> Base &amp;b)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// å°†æ‰“å°è´£ä»»å§”æ‰˜ç»™ æˆå‘˜å‡½æ•°print()</span></span><br><span class="line">		<span class="keyword">return</span> b.<span class="built_in">print</span>(out);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">// æˆ‘ä»¬å°†ä¾èµ–äºæˆå‘˜å‡½æ•°print()æ¥è¿›è¡Œå®é™…çš„æ‰“å°</span></span><br><span class="line">	<span class="comment">// å› ä¸ºprintæ˜¯ä¸€ä¸ªæ™®é€šçš„æˆå‘˜å‡½æ•°ï¼Œæ‰€ä»¥å®ƒå¯ä»¥è¢«è™šæ‹ŸåŒ–</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="built_in">std</span>::ostream&amp; <span class="title">print</span><span class="params">(<span class="built_in">std</span>::ostream&amp; out)</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		out &lt;&lt; <span class="string">"Base"</span>;</span><br><span class="line">		<span class="keyword">return</span> out;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> :</span> <span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Derived() &#123;&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">// é¢æ˜¯å¤„ç†æ´¾ç”Ÿæƒ…å†µçš„è¦†ç›– printå‡½æ•°</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="built_in">std</span>::ostream&amp; <span class="title">print</span><span class="params">(<span class="built_in">std</span>::ostream&amp; out)</span> <span class="keyword">const</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		out &lt;&lt; <span class="string">"Derived"</span>;</span><br><span class="line">		<span class="keyword">return</span> out;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Base b;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; b &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">	Derived d;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; d &lt;&lt; <span class="string">'\n'</span>; <span class="comment">// æ³¨æ„ï¼Œå³ä½¿æ²¡æœ‰æ˜¾å¼å¤„ç†æ´¾ç”Ÿå¯¹è±¡çš„æ“ä½œç¬¦&lt;&lt;ï¼Œä¹Ÿå¯ä»¥è¿™æ ·åš</span></span><br><span class="line"> </span><br><span class="line">	Base &amp;bref = d;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; bref &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Base</span><br><span class="line">Derived</span><br><span class="line">Derived</span><br></pre></td></tr></table></figure><hr><p><strong>è®©æˆ‘ä»¬æ›´è¯¦ç»†åœ°ç ”ç©¶ä¸€ä¸‹ã€‚</strong></p><ul><li><p>é¦–å…ˆï¼Œåœ¨åŸºç±»Baseä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨æ“ä½œç¬¦&lt;&lt;ï¼Œå®ƒè°ƒç”¨è™šå‡½æ•°print()ã€‚å› ä¸ºæˆ‘ä»¬çš„åŸºå¼•ç”¨å‚æ•°æŒ‡å‘ä¸€ä¸ªåŸºå¯¹è±¡ï¼Œb.print()è§£æä¸ºBase::print()ï¼Œå®ƒæ‰§è¡Œæ‰“å°ã€‚æ²¡ä»€ä¹ˆç‰¹åˆ«çš„ã€‚</p></li><li><p>åœ¨æ´¾ç”Ÿçš„æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨é¦–å…ˆæŸ¥çœ‹æ˜¯å¦å­˜åœ¨ æ¥å—æ´¾ç”Ÿå¯¹è±¡çš„æ“ä½œç¬¦&lt;&lt;ã€‚æ²¡æœ‰ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰å®šä¹‰ã€‚æ¥ä¸‹æ¥ï¼Œç¼–è¯‘å™¨æŸ¥çœ‹æ˜¯å¦å­˜åœ¨ æ¥å—åŸºå¯¹è±¡çš„æ“ä½œç¬¦&lt;&lt;ã€‚æœ‰ã€‚æ‰€ä»¥ç¼–è¯‘å™¨éšå¼åœ°å°†æˆ‘ä»¬çš„æ´¾ç”Ÿå¯¹è±¡<strong>å‘ä¸Šè½¬æ¢</strong>ä¸ºä¸€ä¸ª <strong>Base&amp;</strong> å¹¶è°ƒç”¨è¿™ä¸ªå‡½æ•°(æˆ‘ä»¬å¯ä»¥è‡ªå·±åšè¿™ä¸ªå‘ä¸Šè½¬æ¢ï¼Œä½†æ˜¯ç¼–è¯‘å™¨åœ¨è¿™æ–¹é¢å¾ˆæœ‰å¸®åŠ©ï¼‰ã€‚ç„¶åï¼Œè¿™ä¸ªå‡½æ•°è°ƒç”¨virtual print()ï¼Œå®ƒè§£æä¸ºDerived::print().ã€‚</p><blockquote><p>æ³¨æ„ï¼Œ<strong>æˆ‘ä»¬ä¸éœ€è¦ä¸ºæ¯ä¸ªæ´¾ç”Ÿç±»å®šä¹‰è¿ç®—ç¬¦&lt;&lt;</strong> ! å¤„ç†åŸºå¯¹è±¡çš„ç‰ˆæœ¬ å¯¹äºåŸºå¯¹è±¡å’Œä»åŸºæ´¾ç”Ÿçš„ä»»ä½•ç±»éƒ½å¯ä»¥å¾ˆå¥½åœ°å·¥ä½œ!</p></blockquote></li><li><p>ç¬¬ä¸‰ç§æƒ…å†µæ˜¯å‰ä¸¤ç§æƒ…å†µçš„æ··åˆã€‚</p><p>é¦–å…ˆï¼Œç¼–è¯‘å™¨å°†å˜é‡brefä¸æ¥å— åŸºçš„æ“ä½œç¬¦&lt;&lt;åŒ¹é…ã€‚ è°ƒç”¨æˆ‘ä»¬çš„ è™šprint()å‡½æ•°ï¼Œç”±äºåŸºå¼•ç”¨å®é™…ä¸ŠæŒ‡å‘ä¸€ä¸ªæ´¾ç”Ÿå¯¹è±¡ï¼Œå› æ­¤è§£æä¸ºDerived::print()ã€‚</p></li></ul></blockquote></li></ul><p>é—®é¢˜è§£å†³ã€‚</p></div></section></article></div><div class="post-wrapper"><article class="post white-box shadow reveal"><section class="meta"><div class="meta" id="header-meta"><h2 class="title"><a href="/archives/d7910ce1.html">C&C++/åŠ¨æ€å¼ºåˆ¶ç±»å‹è½¬æ¢</a></h2><div class="new-meta-box"><div class="new-meta-item author"><a href="https://longlongqin.github.io" rel="nofollow"><img src="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/image/loading.gif" data-original="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/photo.jpg"><p>longlongin</p></a></div><div class="new-meta-item date"><a class="notlink"><i class="fas fa-edit" aria-hidden="true"></i><p>å‘å¸ƒäºï¼š2020å¹´5æœˆ15æ—¥</p></a></div><div class="new-meta-item wordcount"><a class="notlink"><i class="fas fa-keyboard" aria-hidden="true"></i><p>å­—æ•°ï¼š2.2kå­—</p></a></div><div class="new-meta-item readtime"><a class="notlink"><i class="fas fa-hourglass-half" aria-hidden="true"></i><p>æ—¶é•¿ï¼š8åˆ†é’Ÿ</p></a></div></div><hr></div></section><section class="article typo"><div class="article-entry" itemprop="articleBody"><p>åŸæ–‡ï¼š</p><p><a href="https://www.learncpp.com/cpp-tutorial/12-9-dynamic-casting/" target="_blank" rel="noopener">https://www.learncpp.com/cpp-tutorial/12-9-dynamic-casting/</a></p><hr><p>æ—©åœ¨<a href="https://www.learncpp.com/cpp-tutorial/explicit-type-conversion-casting-and-static-cast/" target="_blank" rel="noopener">6.16 â€“ Explicit type conversion (casting) and static_cast</a>ä¸­ï¼Œæˆ‘ä»¬ç ”ç©¶äº†å¼ºåˆ¶è½¬æ¢çš„æ¦‚å¿µï¼Œä»¥åŠä½¿ç”¨static_castå°†å˜é‡ä»ä¸€ç§ç±»å‹è½¬æ¢ä¸ºå¦ä¸€ç§ç±»å‹ã€‚</p><p>åœ¨è¿™èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­ç ”ç©¶å¦ä¸€ç§ç±»å‹çš„è½¬æ¢: <strong>dynamic_cast</strong>ã€‚</p><h1 id="dynamic-cast"><a href="#dynamic-cast" class="headerlink" title="dynamic_cast"></a>dynamic_cast</h1><p>åœ¨å¤„ç†å¤šæ€æ€§æ—¶ï¼Œæ‚¨ç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µ: æ‚¨æœ‰ä¸€ä¸ªæŒ‡å‘åŸºç±»çš„æŒ‡é’ˆï¼Œä½†æ˜¯æ‚¨æƒ³è¦è®¿é—®ä¸€äº›åªå­˜åœ¨äºæ´¾ç”Ÿç±»ä¸­çš„ä¿¡æ¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="keyword">int</span> m_value;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Base(<span class="keyword">int</span> value)</span><br><span class="line">		: m_value(value)</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">virtual</span> ~Base() &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> :</span> <span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">string</span> m_name;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Derived(<span class="keyword">int</span> value, <span class="built_in">std</span>::<span class="built_in">string</span> name)</span><br><span class="line">		: Base(value), m_name(name)</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="function"><span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; <span class="title">getName</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> m_name; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function">Base* <span class="title">getObject</span><span class="params">(<span class="keyword">bool</span> bReturnDerived)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (bReturnDerived)</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Derived(<span class="number">1</span>, <span class="string">"Apple"</span>);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Base(<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Base *b = getObject(<span class="literal">true</span>);</span><br><span class="line"> </span><br><span class="line">	<span class="comment">// å¦‚ä½•åœ¨åªæœ‰åŸºæŒ‡é’ˆçš„æƒ…å†µä¸‹æ‰“å°æ´¾ç”Ÿå¯¹è±¡çš„åç§°?</span></span><br><span class="line"> </span><br><span class="line">	<span class="keyword">delete</span> b;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç¨‹åºä¸­ï¼Œå‡½æ•°getObject()æ€»æ˜¯è¿”å›ä¸€ä¸ªåŸºæŒ‡é’ˆï¼Œä½†æ˜¯è¿™ä¸ªæŒ‡é’ˆå¯ä»¥æŒ‡å‘åŸºæŒ‡é’ˆï¼Œä¹Ÿå¯ä»¥æŒ‡å‘æ´¾ç”Ÿçš„å¯¹è±¡ã€‚åœ¨æŒ‡é’ˆæŒ‡å‘æ´¾ç”Ÿå¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¦‚ä½•è°ƒç”¨Derived::getName()?</p><ul><li><p>ä¸€ç§æ–¹æ³•æ˜¯å°†ä¸€ä¸ªè™šå‡½æ•°æ·»åŠ åˆ°åä¸ºgetName()çš„åŸºå‡½æ•°ä¸­(å› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªåŸºæŒ‡é’ˆ/å¼•ç”¨æ¥è°ƒç”¨å®ƒï¼Œå¹¶å°†å…¶åŠ¨æ€è§£æä¸º::getName())ã€‚</p><blockquote><p>ä½†æ˜¯å¦‚æœä½ ç”¨ä¸€ä¸ªå®é™…æŒ‡å‘åŸºå¯¹è±¡çš„åŸºæŒ‡é’ˆ/å¼•ç”¨æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå®ƒä¼šè¿”å›ä»€ä¹ˆå‘¢?æ²¡æœ‰ä»»ä½•æœ‰æ„ä¹‰çš„ä»·å€¼ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šç”¨é‚£äº›å®é™…ä¸Šåªåº”è¯¥æ˜¯æ´¾ç”Ÿç±»å…³æ³¨çš„ä¸œè¥¿æ¥æ±¡æŸ“åŸºç±»ã€‚</p></blockquote></li><li><p>æˆ‘ä»¬çŸ¥é“c++å°†<strong>éšå¼</strong>åœ°å…è®¸æ‚¨å°†æ´¾ç”Ÿçš„æŒ‡é’ˆè½¬æ¢ä¸ºåŸºæŒ‡é’ˆ(äº‹å®ä¸Šï¼ŒgetObject()å°±æ˜¯è¿™æ ·åšçš„)ã€‚è¿™ä¸ªè¿‡ç¨‹æœ‰æ—¶è¢«ç§°ä¸º<strong>å‘ä¸Šè½¬æ¢(upcasting)</strong>ã€‚</p><p>ä½†æ˜¯ï¼Œ<strong>å¦‚æœæœ‰ä¸€ç§æ–¹æ³•å¯ä»¥å°†åŸºæŒ‡é’ˆè½¬æ¢å›æ´¾ç”ŸæŒ‡é’ˆå‘¢</strong>? ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥æŒ‡é’ˆè°ƒç”¨Derived::getName()ï¼Œè€Œå®Œå…¨ä¸éœ€è¦æ‹…å¿ƒè™šå‡½æ•°çš„è§£æé—®é¢˜ã€‚</p><blockquote><p>æœ‰ï¼Œé‚£å°±æ˜¯åŠ¨æ€ç±»å‹è½¬æ¢ï¼š<strong>dynamic_cast</strong></p></blockquote></li></ul><h2 id="ä»€ä¹ˆæ˜¯dynamic-cast"><a href="#ä»€ä¹ˆæ˜¯dynamic-cast" class="headerlink" title="ä»€ä¹ˆæ˜¯dynamic_cast"></a>ä»€ä¹ˆæ˜¯dynamic_cast</h2><p><strong>c++æä¾›äº†ä¸€ä¸ªåä¸º<code>dynamic_cast</code>çš„è½¬æ¢æ“ä½œç¬¦</strong>ï¼Œå¯ç”¨äº å°†å³æŒ‡é’ˆè½¬æ¢å› æ´¾ç”ŸæŒ‡é’ˆã€‚</p><p>å°½ç®¡åŠ¨æ€å¼ºåˆ¶è½¬æ¢æœ‰ä¸€äº›ä¸åŒçš„åŠŸèƒ½ï¼Œä½†åˆ°ç›®å‰ä¸ºæ­¢ï¼Œ<strong>åŠ¨æ€å¼ºåˆ¶è½¬æ¢æœ€å¸¸è§çš„ç”¨é€”æ˜¯å°†åŸºç±»æŒ‡é’ˆè½¬æ¢ä¸ºæ´¾ç”Ÿç±»æŒ‡é’ˆã€‚</strong>â€”â€”è¿™ä¸ªè¿‡ç¨‹ç§°ä¸º<strong>å‘ä¸‹è½¬æ¢(downcasting)</strong>ã€‚</p><p>ä½¿ç”¨dynamic_castçš„å·¥ä½œåŸç†ä¸ä½¿ç”¨static_castä¸€æ ·ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬çš„ä¾‹å­main()ï¼Œä½¿ç”¨dynamic_castå°†æˆ‘ä»¬çš„åŸºæŒ‡é’ˆè½¬æ¢å›æ´¾ç”ŸæŒ‡é’ˆ:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Base *b = getObject(<span class="literal">true</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//ä½¿ç”¨åŠ¨æ€å¼ºåˆ¶è½¬æ¢å°†åŸºæŒ‡é’ˆè½¬æ¢ä¸ºæ´¾ç”ŸæŒ‡é’ˆ</span></span><br><span class="line">    Derived *d = <span class="keyword">dynamic_cast</span>&lt;Derived*&gt;(b);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt;<span class="string">"The name of the Derived is: "</span> &lt;&lt; d-&gt;getName() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">delete</span> b;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The name of the Derived is: Apple</span><br></pre></td></tr></table></figure><h1 id="åŠ¨æ€å¼ºåˆ¶ç±»å‹è½¬æ¢ä¼šå¤±è´¥"><a href="#åŠ¨æ€å¼ºåˆ¶ç±»å‹è½¬æ¢ä¼šå¤±è´¥" class="headerlink" title="åŠ¨æ€å¼ºåˆ¶ç±»å‹è½¬æ¢ä¼šå¤±è´¥"></a>åŠ¨æ€å¼ºåˆ¶ç±»å‹è½¬æ¢ä¼šå¤±è´¥</h1><p>ä¸Šé¢çš„ä¾‹å­æ˜¯å¯è¡Œçš„ï¼Œå› ä¸ºbå®é™…ä¸ŠæŒ‡å‘ä¸€ä¸ªæ´¾ç”Ÿçš„å¯¹è±¡ï¼Œæ‰€ä»¥å°†bè½¬æ¢æˆä¸€ä¸ªæ´¾ç”Ÿçš„æŒ‡é’ˆæ˜¯æˆåŠŸçš„ã€‚</p><p>ç„¶è€Œï¼Œæˆ‘ä»¬åšäº†ä¸€ä¸ªç›¸å½“å±é™©çš„å‡è®¾: bæŒ‡å‘ä¸€ä¸ªæ´¾ç”Ÿå¯¹è±¡ã€‚<u>å¦‚æœbä¸æ˜¯æŒ‡å‘ä¸€ä¸ªæ´¾ç”Ÿå¯¹è±¡å‘¢</u>?</p><blockquote><p>é€šè¿‡å°†å‚æ•°getObject()ä»trueæ›´æ”¹ä¸ºfalseï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°æµ‹è¯•è¿™ä¸€ç‚¹ã€‚</p></blockquote><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒgetObject()å°†è¿”å›ä¸€ä¸ªæŒ‡å‘åŸºå¯¹è±¡çš„åŸºæŒ‡é’ˆã€‚å½“æˆ‘ä»¬è¯•å›¾å°†dynamic_castè½¬æ¢ä¸ºæ´¾ç”Ÿç±»å‹æ—¶ï¼Œ<u>å®ƒå°†å¤±è´¥ï¼Œå› ä¸ºè½¬æ¢æ— æ³•è¿›è¡Œã€‚</u></p><p><strong>å¦‚æœdynamic_castå¤±è´¥ï¼Œè½¬æ¢çš„ç»“æœå°†æ˜¯ä¸€ä¸ª<u>ç©ºæŒ‡é’ˆ</u>ã€‚</strong></p><p>å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰æ£€æŸ¥ç©ºæŒ‡é’ˆç»“æœï¼Œæ‰€ä»¥æˆ‘ä»¬è®¿é—®äº†d-&gt;getName()ï¼Œå®ƒå°†å°è¯•å–æ¶ˆå¯¹ç©ºæŒ‡é’ˆçš„å¼•ç”¨ï¼Œä»è€Œå¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸º(å¯èƒ½å¯¼è‡´å´©æºƒ)ã€‚</p><p><strong>ä¸ºäº†ä½¿è¿™ä¸ªç¨‹åºå®‰å…¨ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿dynamic_castçš„ç»“æœç¡®å®æˆåŠŸ:</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Base *b = getObject(<span class="literal">true</span>);</span><br><span class="line"> </span><br><span class="line">        Derived *d = <span class="keyword">dynamic_cast</span>&lt;Derived*&gt;(b); <span class="comment">// ä½¿ç”¨åŠ¨æ€å¼ºåˆ¶è½¬æ¢å°†åŸºæŒ‡é’ˆè½¬æ¢ä¸ºæ´¾ç”ŸæŒ‡é’ˆ</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (d) <span class="comment">// ç¡®ä¿dæ˜¯éç©ºæŒ‡é’ˆ</span></span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"The name of the Derived is: "</span> &lt;&lt; d-&gt;getName() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">delete</span> b;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼Œç”±äºdynamic_caståœ¨ <u>è¿è¡Œæ—¶</u> æ‰§è¡Œä¸€äº› ä¸€è‡´æ€§æ£€æŸ¥(ä»¥ç¡®ä¿å¯ä»¥è¿›è¡Œè½¬æ¢)ï¼Œä½¿ç”¨dynamic_castç¡®å®ä¼šå¯¼è‡´æ€§èƒ½æŸå¤±ã€‚</strong></p><h2 id="å…¶ä»–ä½¿ç”¨dynamic-castå¤±è´¥çš„æƒ…å†µ"><a href="#å…¶ä»–ä½¿ç”¨dynamic-castå¤±è´¥çš„æƒ…å†µ" class="headerlink" title="å…¶ä»–ä½¿ç”¨dynamic_castå¤±è´¥çš„æƒ…å†µ"></a>å…¶ä»–ä½¿ç”¨<code>dynamic_cast</code>å¤±è´¥çš„æƒ…å†µ</h2><ul><li><p>å…·æœ‰ å—ä¿æŠ¤ æˆ– ç§æœ‰ ç»§æ‰¿çš„ã€‚</p></li><li><p>å¯¹äºæ²¡æœ‰å£°æ˜æˆ–ç»§æ‰¿ä»»ä½•è™šå‡½æ•°(å› æ­¤æ²¡æœ‰è™šè¡¨)çš„ç±»ã€‚</p></li><li><p>åœ¨æ¶‰åŠ è™šæ‹ŸåŸºç±» çš„æŸäº›æƒ…å†µä¸‹(æœ‰å…³è¿™äº›æƒ…å†µçš„ç¤ºä¾‹ä»¥åŠå¦‚ä½•è§£å†³å®ƒä»¬ï¼Œè¯·å‚è§ä¸‹é¢é“¾æ¥)ã€‚</p><blockquote><p><a href="https://docs.microsoft.com/en-us/cpp/cpp/dynamic-cast-operator?redirectedfrom=MSDN&amp;view=vs-2019" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/cpp/cpp/dynamic-cast-operator?redirectedfrom=MSDN&amp;view=vs-2019</a></p></blockquote></li></ul><h1 id="ç”¨static-castè¿›è¡Œå‘ä¸‹è½¬æ¢"><a href="#ç”¨static-castè¿›è¡Œå‘ä¸‹è½¬æ¢" class="headerlink" title="ç”¨static_castè¿›è¡Œå‘ä¸‹è½¬æ¢"></a>ç”¨<code>static_cast</code>è¿›è¡Œå‘ä¸‹è½¬æ¢</h1><p>äº‹å®è¯æ˜ï¼Œå‘ä¸‹è½¬æ¢ä¹Ÿå¯ä»¥ç”¨static_castå®Œæˆã€‚ä¸»è¦çš„åŒºåˆ«æ˜¯static_castä¸æ‰§è¡Œè¿è¡Œæ—¶ç±»å‹æ£€æŸ¥ï¼Œæ¥ç¡®ä¿æ‚¨æ‰€åšçš„æ“ä½œæ˜¯æœ‰æ„ä¹‰çš„ã€‚</p><p><strong>è¿™ä½¿å¾—ä½¿ç”¨static_castæ›´å¿«ï¼Œä½†æ›´å±é™©</strong>ã€‚å¦‚æœå°† Base* å¼ºåˆ¶è½¬æ¢ä¸ºDerived* ï¼Œå³ä½¿åŸºæŒ‡é’ˆæ²¡æœ‰æŒ‡å‘æ´¾ç”Ÿå¯¹è±¡ï¼Œå®ƒä¹Ÿä¼šâ€œæˆåŠŸâ€ã€‚å½“æ‚¨è¯•å›¾è®¿é—®äº§ç”Ÿçš„æ´¾ç”ŸæŒ‡é’ˆ(å®é™…ä¸Šæ˜¯æŒ‡å‘åŸºå¯¹è±¡)æ—¶ï¼Œè¿™å°†å¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºã€‚</p><p><u>å¦‚æœæ‚¨ç»å¯¹ç¡®å®šå‘ä¸‹å¼ºåˆ¶è½¬æ¢çš„æŒ‡é’ˆå°†æˆåŠŸï¼Œé‚£ä¹ˆä½¿ç”¨static_castæ˜¯å¯ä»¥æ¥å—çš„</u>ã€‚<strong>ç¡®ä¿æ‚¨çŸ¥é“æ‰€æŒ‡å‘çš„å¯¹è±¡ç±»å‹çš„ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨è™šå‡½æ•°</strong>ã€‚è¿™é‡Œæœ‰ä¸€ç§æ–¹æ³•(ä¸æ˜¯å¾ˆå¥½ï¼Œå› ä¸ºå®ƒä½¿ç”¨äº†ä¸€ä¸ªå…¨å±€å˜é‡):</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// ç±»æ ‡è¯†ç¬¦</span></span><br><span class="line"><span class="keyword">enum</span> ClassID</span><br><span class="line">&#123;</span><br><span class="line">	BASE,</span><br><span class="line">	DERIVED</span><br><span class="line">	<span class="comment">// Others can be added here later</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="keyword">int</span> m_value;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Base(<span class="keyword">int</span> value)</span><br><span class="line">		: m_value(value)</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">virtual</span> ~Base() &#123;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> ClassID <span class="title">getClassID</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> BASE; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> :</span> <span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">string</span> m_name;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Derived(<span class="keyword">int</span> value, <span class="built_in">std</span>::<span class="built_in">string</span> name)</span><br><span class="line">		: Base(value), m_name(name)</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="function"><span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; <span class="title">getName</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> m_name; &#125;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> ClassID <span class="title">getClassID</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> DERIVED; &#125;</span><br><span class="line"> </span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function">Base* <span class="title">getObject</span><span class="params">(<span class="keyword">bool</span> bReturnDerived)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (bReturnDerived)</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Derived(<span class="number">1</span>, <span class="string">"Apple"</span>);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Base(<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Base *b = getObject(<span class="literal">true</span>);</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">if</span> (b-&gt;getClassID() == DERIVED)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// æˆ‘ä»¬å·²ç»è¯æ˜äº†bæŒ‡å‘ä¸€ä¸ªæ´¾ç”Ÿçš„å¯¹è±¡ï¼Œæ‰€ä»¥è¿™åº”è¯¥æ€»æ˜¯æˆåŠŸçš„</span></span><br><span class="line">		Derived *d = <span class="keyword">static_cast</span>&lt;Derived*&gt;(b);</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"The name of the Derived is: "</span> &lt;&lt; d-&gt;getName() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">delete</span> b;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æœ€å¥½è¿˜æ˜¯ä½¿ç”¨dynamic-cast"><a href="#æœ€å¥½è¿˜æ˜¯ä½¿ç”¨dynamic-cast" class="headerlink" title="æœ€å¥½è¿˜æ˜¯ä½¿ç”¨dynamic_cast"></a>æœ€å¥½è¿˜æ˜¯ä½¿ç”¨<code>dynamic_cast</code></h2><p>ä½†æ˜¯ï¼Œå¦‚æœæ‚¨è¦ç»å†å®ç°è¿™ä¸€ç‚¹çš„æ‰€æœ‰å›°éš¾( å¹¶ä¸”è¦ä¸ºè°ƒç”¨è™šå‡½æ•°å’Œå¤„ç†ç»“æœä»˜å‡ºä»£ä»· )ï¼Œ<strong>é‚£ä¹ˆæœ€å¥½åªä½¿ç”¨dynamic_castã€‚</strong></p><h1 id="dynamic-castå’Œå¼•ç”¨"><a href="#dynamic-castå’Œå¼•ç”¨" class="headerlink" title="dynamic_castå’Œå¼•ç”¨"></a>dynamic_castå’Œå¼•ç”¨</h1><p>å°½ç®¡ä¸Šé¢æ‰€æœ‰çš„ä¾‹å­éƒ½æ˜¾ç¤ºäº†æŒ‡é’ˆçš„åŠ¨æ€è½¬æ¢(è¿™æ›´å¸¸è§)ï¼Œ<strong>dynamic_castä¹Ÿå¯ä»¥ä¸å¼•ç”¨ä¸€èµ·ä½¿ç”¨</strong>ã€‚è¿™ç±»ä¼¼äºdynamic_castå¤„ç†æŒ‡é’ˆçš„æ–¹å¼ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="keyword">int</span> m_value;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Base(<span class="keyword">int</span> value)</span><br><span class="line">		: m_value(value)</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">virtual</span> ~Base() &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> :</span> <span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">string</span> m_name;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Derived(<span class="keyword">int</span> value, <span class="built_in">std</span>::<span class="built_in">string</span> name)</span><br><span class="line">		: Base(value), m_name(name)</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="function"><span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; <span class="title">getName</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> m_name; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Derived <span class="title">apple</span><span class="params">(<span class="number">1</span>, <span class="string">"Apple"</span>)</span></span>; </span><br><span class="line">    Base &amp;b = apple; <span class="comment">//ä½¿ç”¨å¼•ç”¨è€Œä¸æ˜¯æŒ‡é’ˆè¿›è¡ŒåŠ¨æ€è½¬æ¢</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æˆ‘ä»¬å¯ä»¥é€šè¿‡dè®¿é—®Derived::getName</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"The name of the Derived is: "</span> &lt;&lt; d.getName() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å› ä¸ºc++æ²¡æœ‰â€œç©ºå¼•ç”¨â€ï¼Œdynamic_caståœ¨å¤±è´¥æ—¶ä¸èƒ½è¿”å›ç©ºå¼•ç”¨</strong>ã€‚<strong>ç›¸åï¼Œå¦‚æœå¼•ç”¨çš„dynamic_castå¤±è´¥ï¼Œåˆ™æŠ›å‡ºstd::bad_castç±»å‹çš„å¼‚å¸¸</strong>ã€‚æˆ‘ä»¬å°†åœ¨æœ¬æ•™ç¨‹çš„åé¢è®¨è®ºå¼‚å¸¸ã€‚</p><h1 id="dynamic-cast-ä¸-static-cast-çš„æ¯”è¾ƒ"><a href="#dynamic-cast-ä¸-static-cast-çš„æ¯”è¾ƒ" class="headerlink" title="dynamic_cast ä¸ static_cast çš„æ¯”è¾ƒ"></a><code>dynamic_cast</code> ä¸ <code>static_cast</code> çš„æ¯”è¾ƒ</h1><p>æ–°ç¨‹åºå‘˜æœ‰æ—¶ä¼šå¯¹ä½•æ—¶ä½¿ç”¨static_castå’Œdynamic_castæ„Ÿåˆ°å›°æƒ‘ã€‚ç­”æ¡ˆå¾ˆç®€å•:</p><ul><li>ä½¿ç”¨static_castï¼Œ<strong>é™¤éæ˜¯å‘ä¸‹å¼ºåˆ¶è½¬æ¢ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œdynamic_casté€šå¸¸æ˜¯æ›´å¥½çš„é€‰æ‹©</strong>ã€‚</li><li>ä½†æ˜¯ï¼Œæ‚¨è¿˜åº”è¯¥è€ƒè™‘å®Œå…¨é¿å…å¼ºåˆ¶è½¬æ¢ï¼Œåªä½¿ç”¨è™šå‡½æ•°ã€‚</li></ul><h1 id="å‘ä¸‹è½¬æ¢vsè™šå‡½æ•°"><a href="#å‘ä¸‹è½¬æ¢vsè™šå‡½æ•°" class="headerlink" title="å‘ä¸‹è½¬æ¢vsè™šå‡½æ•°"></a>å‘ä¸‹è½¬æ¢vsè™šå‡½æ•°</h1><p>æœ‰äº›å¼€å‘äººå‘˜è®¤ä¸ºdynamic_castæ˜¯é‚ªæ¶çš„ï¼Œå¹¶ä¸”æ˜¯ä¸€ä¸ªç³Ÿç³•çš„ç±»è®¾è®¡çš„è±¡å¾ã€‚ç›¸åï¼Œè¿™äº›ç¨‹åºå‘˜è®¤ä¸ºåº”è¯¥ä½¿ç”¨è™šæ‹Ÿå‡½æ•°ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œ<strong>ä½¿ç”¨è™šå‡½æ•°æ¯”å‘ä¸‹å¼ºåˆ¶è½¬æ¢æ›´å¯å–</strong>ã€‚</p><p>ç„¶è€Œï¼Œ<strong>æœ‰æ—¶å‘ä¸‹è½¬æ¢æ˜¯æ›´å¥½çš„é€‰æ‹©:</strong></p><ul><li>å½“æ‚¨ä¸èƒ½ä¿®æ”¹åŸºç±»æ¥æ·»åŠ è™šå‡½æ•°æ—¶(ä¾‹å¦‚ï¼Œå› ä¸ºåŸºç±»æ˜¯æ ‡å‡†åº“çš„ä¸€éƒ¨åˆ†)</li><li>å½“æ‚¨éœ€è¦è®¿é—®ç‰¹å®šäºæ´¾ç”Ÿç±»çš„å†…å®¹æ—¶(ä¾‹å¦‚ï¼Œä»…å­˜åœ¨äºæ´¾ç”Ÿç±»ä¸­çš„è®¿é—®å‡½æ•°)</li></ul><p>å½“å‘åŸºç±»æ·»åŠ è™šå‡½æ•°æ²¡æœ‰æ„ä¹‰æ—¶(ä¾‹å¦‚ï¼ŒåŸºç±»è¿”å›çš„å€¼ä¸åˆé€‚)ã€‚å¦‚æœæ‚¨ä¸éœ€è¦å®ä¾‹åŒ–åŸºç±»ï¼Œé‚£ä¹ˆä½¿ç”¨<strong>çº¯è™šå‡½æ•°</strong>å¯èƒ½æ˜¯ä¸€ç§é€‰æ‹©ã€‚</p><h1 id="å…³äºdynamic-castå’ŒRTTIçš„è­¦å‘Š"><a href="#å…³äºdynamic-castå’ŒRTTIçš„è­¦å‘Š" class="headerlink" title="å…³äºdynamic_castå’ŒRTTIçš„è­¦å‘Š"></a>å…³äºdynamic_castå’ŒRTTIçš„è­¦å‘Š</h1><p>è¿è¡Œæ—¶ç±»å‹ä¿¡æ¯(RTTI)æ˜¯c++çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå®ƒåœ¨<strong>è¿è¡Œæ—¶</strong>å…¬å¼€æœ‰å…³å¯¹è±¡æ•°æ®ç±»å‹çš„ä¿¡æ¯ã€‚<strong>dynamic_caståˆ©ç”¨äº†è¿™ä¸ªåŠŸèƒ½ã€‚</strong></p><p><strong>ç”±äºRTTIæœ‰ç›¸å½“å¤§çš„ç©ºé—´æ€§èƒ½æˆæœ¬ï¼Œä¸€äº›ç¼–è¯‘å™¨å…è®¸æ‚¨å…³é—­RTTIä½œä¸ºä¼˜åŒ–ã€‚å¦‚æœè¿™æ ·åšï¼Œdynamic_castå°†æ— æ³•æ­£å¸¸å·¥ä½œã€‚</strong></p></div></section></article></div><div class="post-wrapper"><article class="post white-box shadow reveal"><section class="meta"><div class="meta" id="header-meta"><h2 class="title"><a href="/archives/c1cd5bf1.html">C&C++/å¯¹è±¡åˆ‡ç‰‡</a></h2><div class="new-meta-box"><div class="new-meta-item author"><a href="https://longlongqin.github.io" rel="nofollow"><img src="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/image/loading.gif" data-original="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/photo.jpg"><p>longlongin</p></a></div><div class="new-meta-item date"><a class="notlink"><i class="fas fa-edit" aria-hidden="true"></i><p>å‘å¸ƒäºï¼š2020å¹´5æœˆ15æ—¥</p></a></div><div class="new-meta-item wordcount"><a class="notlink"><i class="fas fa-keyboard" aria-hidden="true"></i><p>å­—æ•°ï¼š2kå­—</p></a></div><div class="new-meta-item readtime"><a class="notlink"><i class="fas fa-hourglass-half" aria-hidden="true"></i><p>æ—¶é•¿ï¼š8åˆ†é’Ÿ</p></a></div></div><hr></div></section><section class="article typo"><div class="article-entry" itemprop="articleBody"><p>åŸæ–‡ï¼š</p><p><a href="https://www.learncpp.com/cpp-tutorial/12-8-object-slicing/" target="_blank" rel="noopener">https://www.learncpp.com/cpp-tutorial/12-8-object-slicing/</a></p><hr><p>è®©æˆ‘ä»¬å›åˆ°ä¹‹å‰çœ‹çš„ä¸€ä¸ªä¾‹å­:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="keyword">int</span> m_value&#123;&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Base(<span class="keyword">int</span> value)</span><br><span class="line">        : m_value&#123; value &#125;</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">getName</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> <span class="string">"Base"</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getValue</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> m_value; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span>:</span> <span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Derived(<span class="keyword">int</span> value)</span><br><span class="line">        : Base&#123; value &#125;</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">getName</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> <span class="string">"Derived"</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Derived derived&#123; <span class="number">5</span> &#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"derived is a "</span> &lt;&lt; derived.getName() &lt;&lt; <span class="string">" and has value "</span> &lt;&lt; derived.getValue() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">    Base &amp;ref&#123; derived &#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ref is a "</span> &lt;&lt; ref.getName() &lt;&lt; <span class="string">" and has value "</span> &lt;&lt; ref.getValue() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">    Base *ptr&#123; &amp;derived &#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ptr is a "</span> &lt;&lt; ptr-&gt;getName() &lt;&lt; <span class="string">" and has value "</span> &lt;&lt; ptr-&gt;getValue() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œrefå¼•ç”¨å’ŒptræŒ‡å‘derivedï¼Œ<strong>å®ƒæœ‰ä¸€ä¸ªåŸºéƒ¨åˆ†å’Œä¸€ä¸ªæ´¾ç”Ÿéƒ¨åˆ†</strong>ã€‚<strong>å› ä¸ºrefå’Œptræ˜¯Baseç±»å‹çš„ï¼Œrefå’Œptråªèƒ½çœ‹åˆ°derivedçš„Baseéƒ¨åˆ†â€”â€”derivedçš„derivedéƒ¨åˆ†ä»ç„¶å­˜åœ¨ï¼Œä½†æ˜¯ä¸èƒ½é€šè¿‡refæˆ–ptrçœ‹åˆ°</strong>ã€‚</p><p><strong>ç„¶è€Œï¼Œé€šè¿‡ä½¿ç”¨è™šå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®æœ€æ´¾ç”Ÿçš„å‡½æ•°ç‰ˆæœ¬</strong>ã€‚å› æ­¤ï¼Œä¸Šé¢çš„ç¨‹åºæ‰“å°:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">derived is a Derived and has value 5</span><br><span class="line">ref is a Derived and has value 5</span><br><span class="line">ptr is a Derived and has value 5</span><br></pre></td></tr></table></figure><h1 id="å¯¹è±¡åˆ‡ç‰‡"><a href="#å¯¹è±¡åˆ‡ç‰‡" class="headerlink" title="å¯¹è±¡åˆ‡ç‰‡"></a>å¯¹è±¡åˆ‡ç‰‡</h1><p>ä½†æ˜¯ï¼Œå¦‚æœä¸è®¾ç½®åŸºå¼•ç”¨æˆ–æŒ‡å‘æ´¾ç”Ÿå¯¹è±¡çš„æŒ‡é’ˆï¼Œ<strong>è€Œæ˜¯ç®€å•åœ°å°†æ´¾ç”Ÿå¯¹è±¡åˆ†é…ç»™åŸºå¯¹è±¡</strong>ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µå‘¢?</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Derived derived&#123; <span class="number">5</span> &#125;;</span><br><span class="line">    Base base&#123; derived &#125;; <span class="comment">// what happens here?</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"base is a "</span> &lt;&lt; base.getName() &lt;&lt; <span class="string">" and has value "</span> &lt;&lt; base.getValue() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®°ä½ï¼Œå¯¼å‡½æ•°æœ‰åŸºéƒ¨å’Œå¯¼å‡½æ•°éƒ¨ã€‚<strong>å½“æˆ‘ä»¬å°†æ´¾ç”Ÿå¯¹è±¡åˆ†é…ç»™åŸºå¯¹è±¡æ—¶ï¼Œåªå¤åˆ¶æ´¾ç”Ÿå¯¹è±¡çš„åŸºéƒ¨åˆ†ã€‚æ´¾ç”Ÿéƒ¨åˆ†åˆ™ä¸æ˜¯</strong>ã€‚</p><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œ<u>baseæ¥æ”¶æ´¾ç”Ÿçš„åŸºæœ¬éƒ¨åˆ†çš„å‰¯æœ¬ï¼Œä½†ä¸æ¥æ”¶æ´¾ç”Ÿéƒ¨åˆ†çš„å‰¯æœ¬</u>ã€‚<strong>è¿™ä¸ªè¡ç”Ÿçš„éƒ¨åˆ†å·²ç»è¢«æœ‰æ•ˆåœ°â€œåˆ‡æ‰â€äº†ã€‚</strong>å› æ­¤ï¼Œ<strong><u>å°†æ´¾ç”Ÿç±»å¯¹è±¡ <em>èµ‹å€¼</em> ç»™åŸºç±»å¯¹è±¡</u> ç§°ä¸ºå¯¹è±¡åˆ‡ç‰‡(æˆ–ç®€ç§°ä¸ºåˆ‡ç‰‡)ã€‚</strong></p><blockquote><p>å› ä¸ºå˜é‡baseæ²¡æœ‰æ´¾ç”Ÿéƒ¨åˆ†ï¼Œæ‰€ä»¥base.getName()è§£æä¸ºbase::getName()ã€‚</p><p>ä¸Šé¢çš„ä¾‹å­æ‰“å°:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">base is a Base and has value 5</span><br></pre></td></tr></table></figure></blockquote><hr><ul><li><p>è®¤çœŸä½¿ç”¨ï¼Œåˆ‡ç‰‡å¯ä»¥æ˜¯è‰¯æ€§çš„ã€‚</p></li><li><p>ç„¶è€Œï¼Œå¦‚æœä½¿ç”¨ä¸å½“ï¼Œåˆ‡ç‰‡å¯èƒ½ä¼šä»¥è®¸å¤šä¸åŒçš„æ–¹å¼å¯¼è‡´æ„æƒ³ä¸åˆ°çš„ç»“æœã€‚</p></li></ul><p>è®©æˆ‘ä»¬æ¥ç ”ç©¶ä¸€ä¸‹å…¶ä¸­çš„ä¸€äº›æƒ…å†µï¼š</p><h2 id="åˆ‡ç‰‡å’Œå‡½æ•°"><a href="#åˆ‡ç‰‡å’Œå‡½æ•°" class="headerlink" title="åˆ‡ç‰‡å’Œå‡½æ•°"></a>åˆ‡ç‰‡å’Œå‡½æ•°</h2><p>ç°åœ¨ï¼Œä½ å¯èƒ½è§‰å¾—ä¸Šé¢çš„ä¾‹å­æœ‰ç‚¹å‚»ã€‚æ¯•ç«Ÿï¼Œä¸ºä»€ä¹ˆè¦æŠŠæ´¾ç”Ÿèµ‹ç»™baseå‘¢?ä½ å¯èƒ½ä¸ä¼šã€‚ç„¶è€Œï¼Œåˆ‡ç‰‡æ›´å¯èƒ½åœ¨å‡½æ•°ä¸­æ„å¤–å‘ç”Ÿã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printName</span><span class="params">(<span class="keyword">const</span> Base base)</span> <span class="comment">// æ³¨æ„:baseæ˜¯é€šè¿‡å€¼ä¼ é€’çš„ï¼Œè€Œä¸æ˜¯å¼•ç”¨</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"I am a "</span> &lt;&lt; base.getName() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„å‡½æ•°ï¼Œå¸¦æœ‰ä¸€ä¸ªé€šè¿‡å€¼ä¼ é€’çš„conståŸºå¯¹è±¡å‚æ•°ã€‚å¦‚æœæˆ‘ä»¬è¿™æ ·è°ƒç”¨è¿™ä¸ªå‡½æ•°:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Derived d&#123; <span class="number">5</span> &#125;;</span><br><span class="line">    printName(d); <span class="comment">// ç³Ÿç³•ï¼Œæ²¡æœ‰æ„è¯†åˆ°è¿™æ˜¯ åœ¨è°ƒç”¨ç«¯æŒ‰å€¼ä¼ é€’çš„</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨ç¼–å†™è¿™ä¸ªç¨‹åºæ—¶ï¼Œæ‚¨å¯èƒ½æ²¡æœ‰æ³¨æ„åˆ°baseæ˜¯ä¸€ä¸ªå€¼å‚æ•°ï¼Œè€Œä¸æ˜¯å¼•ç”¨<strong>ã€‚å› æ­¤ï¼Œå½“è°ƒç”¨printName(d)æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½æœŸæœ›base.getName()è°ƒç”¨è™šæ‹ŸåŒ–å‡½æ•°getName()å¹¶æ‰“å°â€œI am a Derivedâ€ï¼Œä½†å®é™…æƒ…å†µå¹¶éå¦‚æ­¤ã€‚ç›¸åï¼Œæ´¾ç”Ÿå¯¹è±¡dè¢«åˆ‡ç‰‡ï¼Œåªæœ‰åŸºéƒ¨åˆ†è¢«å¤åˆ¶åˆ°åŸºå‚æ•°ä¸­ã€‚å½“base.getName()æ‰§è¡Œæ—¶ï¼Œå³ä½¿å·²ç»è™šæ‹ŸåŒ–äº†getName()å‡½æ•°ï¼Œä¹Ÿæ²¡æœ‰ç±»çš„æ´¾ç”Ÿéƒ¨åˆ†éœ€è¦è§£æ</strong>ã€‚å› æ­¤ï¼Œè¿™ä¸ªç¨‹åºæ‰“å°:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I am a Base</span><br></pre></td></tr></table></figure></blockquote><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¾ˆæ˜æ˜¾å‘ç”Ÿäº†ä»€ä¹ˆï¼Œä½†æ˜¯å¦‚æœæ‚¨çš„å‡½æ•°å®é™…ä¸Šæ²¡æœ‰æ‰“å°ä»»ä½•åƒè¿™æ ·çš„æ ‡è¯†ä¿¡æ¯ï¼Œè·Ÿè¸ªé”™è¯¯å¯èƒ½ä¼šå¾ˆå›°éš¾ã€‚</p><p>å½“ç„¶ï¼Œ<strong><u>é€šè¿‡å°†å‡½æ•°å‚æ•°è®¾ç½®ä¸ºå¼•ç”¨è€Œä¸æ˜¯æŒ‰å€¼ä¼ é€’</u>ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°é¿å…è¿™é‡Œçš„åˆ‡ç‰‡</strong>(è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæŒ‰å¼•ç”¨ä¼ é€’ç±»è€Œä¸æ˜¯æŒ‰å€¼ä¼ é€’ç±»æ˜¯ä¸€ä¸ªå¥½ä¸»æ„çš„å¦ä¸€ä¸ªåŸå› )ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printName</span><span class="params">(<span class="keyword">const</span> Base &amp;base)</span> <span class="comment">// æ³¨æ„:baseç°åœ¨é€šè¿‡å¼•ç”¨ä¼ é€’</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"I am a "</span> &lt;&lt; base.getName() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Derived d&#123; <span class="number">5</span> &#125;;</span><br><span class="line">    printName(d);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*ç»“æœ*/</span></span><br><span class="line">I am a Derived</span><br></pre></td></tr></table></figure><h2 id="åˆ‡ç‰‡-vector"><a href="#åˆ‡ç‰‡-vector" class="headerlink" title="åˆ‡ç‰‡ vector"></a>åˆ‡ç‰‡ <code>vector</code></h2><p>ç„¶è€Œï¼Œæ–°ç¨‹åºå‘˜åœ¨ä½¿ç”¨åˆ‡ç‰‡æ—¶é‡åˆ°çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯è¯•å›¾ä½¿ç”¨<strong><code>std::vector</code></strong>å®ç°å¤šæ€æ€§ã€‚è€ƒè™‘ä»¥ä¸‹ç¨‹åº:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;Base&gt; v&#123;&#125;;</span><br><span class="line">	v.push_back(Base&#123; <span class="number">5</span> &#125;); <span class="comment">// add a Base object to our vector</span></span><br><span class="line">	v.push_back(Derived&#123; <span class="number">6</span> &#125;); <span class="comment">// add a Derived object to our vector</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">// Print out all of the elements in our vector</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; element : v)</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"I am a "</span> &lt;&lt; element.getName() &lt;&lt; <span class="string">" with value "</span> &lt;&lt; element.getValue() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">I am a Base with value 5</span><br><span class="line">I am a Base with value 6</span><br></pre></td></tr></table></figure><p>ä¸å‰é¢çš„ç¤ºä¾‹ç±»ä¼¼ï¼Œå› ä¸ºstd::vectorè¢«å£°æ˜ä¸ºBaseç±»å‹çš„å‘é‡ï¼Œå½“æ´¾ç”Ÿ(6)æ·»åŠ åˆ°è¯¥å‘é‡æ—¶ï¼Œå®ƒè¢«åˆ‡ç‰‡ã€‚</p><blockquote><p>ä¿®å¤è¿™ä¸ªé—®é¢˜æœ‰ç‚¹å›°éš¾ã€‚è®¸å¤šæ–°ç¨‹åºå‘˜å°è¯•åˆ›å»ºä¸€ä¸ªstd::vectorå¯¹è±¡çš„å¼•ç”¨ï¼Œåƒè¿™æ ·:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;Base&amp;&gt; v&#123;&#125;;</span><br></pre></td></tr></table></figure><p>ä¸å¹¸çš„æ˜¯ï¼Œè¿™æ— æ³•ç¼–è¯‘ã€‚<strong>std::vectorçš„å…ƒç´ å¿…é¡»æ˜¯å¯èµ‹å€¼çš„ï¼Œè€Œå¼•ç”¨ä¸èƒ½è¢«é‡æ–°èµ‹å€¼(åªèƒ½åˆå§‹åŒ–)ã€‚</strong></p></blockquote><h3 id="è§£å†³åŠæ³•ï¼šæŒ‡é’ˆå‘é‡"><a href="#è§£å†³åŠæ³•ï¼šæŒ‡é’ˆå‘é‡" class="headerlink" title="è§£å†³åŠæ³•ï¼šæŒ‡é’ˆå‘é‡"></a>è§£å†³åŠæ³•ï¼šæŒ‡é’ˆå‘é‡</h3><p>è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯<strong>åˆ›å»ºä¸€ä¸ªæŒ‡é’ˆå‘é‡:</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;Base*&gt; v&#123;&#125;;</span><br><span class="line">	</span><br><span class="line">	Base b&#123; <span class="number">5</span> &#125;; <span class="comment">// bå’Œdä¸èƒ½æ˜¯åŒ¿åå¯¹è±¡</span></span><br><span class="line">	Derived d&#123; <span class="number">6</span> &#125;;</span><br><span class="line"> </span><br><span class="line">	v.push_back(&amp;b); <span class="comment">// add a Base object to our vector</span></span><br><span class="line">	v.push_back(&amp;d); <span class="comment">// add a Derived object to our vector</span></span><br><span class="line"> </span><br><span class="line">	<span class="comment">// Print out all of the elements in our vector</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>* element : v)</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"I am a "</span> &lt;&lt; element-&gt;getName() &lt;&lt; <span class="string">" with value "</span> &lt;&lt; element-&gt;getValue() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">I am a Base with value 5</span><br><span class="line">I am a Derived with value 6</span><br></pre></td></tr></table></figure><p>å¯¹æ­¤æœ‰å‡ ç‚¹è¯„è®ºã€‚</p><ul><li>é¦–å…ˆï¼Œnullptrç°åœ¨æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„é€‰é¡¹ï¼Œè¿™å¯èƒ½æ˜¯å¯å–çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸å¯å–çš„ã€‚</li><li>å…¶æ¬¡ï¼Œç°åœ¨å¿…é¡»å¤„ç†æŒ‡é’ˆè¯­ä¹‰ï¼Œè¿™å¯èƒ½ä¼šå¾ˆéº»çƒ¦ã€‚ä½†å¥½å¤„æ˜¯ï¼Œè¿™ä¹Ÿå…è®¸åŠ¨æ€å†…å­˜åˆ†é…çš„å¯èƒ½æ€§ï¼Œå¦‚æœæ‚¨çš„å¯¹è±¡å¯èƒ½è¶…å‡ºèŒƒå›´ï¼Œé‚£ä¹ˆåŠ¨æ€å†…å­˜åˆ†é…å°†éå¸¸æœ‰ç”¨ã€‚</li></ul><h2 id="The-Frankenobject"><a href="#The-Frankenobject" class="headerlink" title="The Frankenobject"></a>The Frankenobject</h2><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº†ç”±äºæ´¾ç”Ÿç±»è¢«åˆ‡å‰²è€Œå¯¼è‡´é”™è¯¯ç»“æœçš„æƒ…å†µã€‚ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹å¦ä¸€ç§å±é™©çš„æƒ…å†µï¼Œå³æ´¾ç”Ÿå¯¹è±¡ä»ç„¶å­˜åœ¨ !</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Derived d1&#123; <span class="number">5</span> &#125;;</span><br><span class="line">    Derived d2&#123; <span class="number">6</span> &#125;;</span><br><span class="line">    Base &amp;b&#123; d2 &#125;;</span><br><span class="line"> </span><br><span class="line">    b = d1; <span class="comment">// this line is æœ‰é—®é¢˜</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡½æ•°çš„å‰ä¸‰è¡Œéå¸¸ç®€å•ã€‚åˆ›å»ºä¸¤ä¸ªæ´¾ç”Ÿå¯¹è±¡ï¼Œå¹¶è®¾ç½®ç¬¬äºŒä¸ªå¯¹è±¡çš„åŸºå¼•ç”¨ã€‚</p><p>ç¬¬å››è¡Œæ˜¯è¯¯å…¥æ­§é€”çš„åœ°æ–¹ï¼šå› ä¸ºbæŒ‡å‘d2ï¼Œæˆ‘ä»¬åˆæŠŠd1èµ‹å€¼ç»™bï¼Œä½ å¯èƒ½ä¼šè®¤ä¸ºç»“æœæ˜¯d1ä¼šè¢«å¤åˆ¶åˆ°d2ä¸­ã€‚</p><ul><li>å¦‚æœbæ˜¯ä¸€ä¸ªæ´¾ç”Ÿçš„çš„è¯ï¼Œé‚£å®ƒæ˜¯å¯¹çš„ã€‚</li><li>ä½†æ˜¯bæ˜¯ä¸€ä¸ªåŸºç±»ï¼Œ<strong>c++ä¸ºç±»æä¾›çš„æ“ä½œç¬¦=åœ¨é»˜è®¤æƒ…å†µä¸‹ä¸æ˜¯è™šæ‹Ÿçš„ã€‚</strong>å› æ­¤ï¼Œåªæœ‰d1çš„<strong>åŸºéƒ¨åˆ†</strong>è¢«å¤åˆ¶åˆ°d2ä¸­ã€‚</li></ul><p>ç»“æœï¼Œä½ ä¼šå‘ç°d2ç°åœ¨æœ‰äº†ï¼š</p><ul><li>åŸºåº•éƒ¨åˆ†æ˜¯d1</li><li>è¡ç”Ÿéƒ¨åˆ†æ˜¯d2ã€‚</li></ul><p>åœ¨è¿™ä¸ªç‰¹æ®Šçš„ä¾‹å­ä¸­ï¼Œè¿™ä¸æ˜¯é—®é¢˜(å› ä¸ºæ´¾ç”Ÿç±»æ²¡æœ‰è‡ªå·±çš„æ•°æ®)ï¼Œä½†æ˜¯åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨åªæ˜¯åˆ›å»ºäº†ä¸€ä¸ªFrankenobject</p><blockquote><p><strong>Frankenobject</strong>ï¼šç”±å¤šä¸ªå¯¹è±¡çš„éƒ¨åˆ†ç»„æˆ</p></blockquote><p>æ›´ç³Ÿç³•çš„æ˜¯ï¼Œæ²¡æœ‰ç®€å•çš„æ–¹æ³•æ¥é˜²æ­¢è¿™ç§æƒ…å†µçš„å‘ç”Ÿ (é™¤äº†å°½å¯èƒ½é¿å…è¿™æ ·çš„èµ‹å€¼)ã€‚</p><h1 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h1><p>å°½ç®¡c++æ”¯æŒé€šè¿‡å¯¹è±¡åˆ‡ç‰‡å°†æ´¾ç”Ÿå¯¹è±¡åˆ†é…ç»™åŸºå¯¹è±¡ï¼Œä½†é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™å¯èƒ½åªä¼šé€ æˆéº»çƒ¦ï¼Œ<strong>æ‚¨é€šå¸¸åº”è¯¥å°½é‡é¿å…åˆ‡ç‰‡</strong>ã€‚</p><p>æ–¹æ³•ï¼š<strong>ç¡®ä¿æ‚¨çš„å‡½æ•°å‚æ•°æ˜¯å¼•ç”¨(æˆ–æŒ‡é’ˆ)ï¼Œå¹¶ä¸”åœ¨æ¶‰åŠåˆ°æ´¾ç”Ÿç±»æ—¶å°½é‡é¿å…ä»»ä½•ç±»å‹çš„æŒ‰å€¼ä¼ é€’ã€‚</strong></p></div></section></article></div><div class="post-wrapper"><article class="post white-box shadow reveal"><section class="meta"><div class="meta" id="header-meta"><h2 class="title"><a href="/archives/f7358229.html">C&C++/è™šæ‹ŸåŸºç±»</a></h2><div class="new-meta-box"><div class="new-meta-item author"><a href="https://longlongqin.github.io" rel="nofollow"><img src="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/image/loading.gif" data-original="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/photo.jpg"><p>longlongin</p></a></div><div class="new-meta-item date"><a class="notlink"><i class="fas fa-edit" aria-hidden="true"></i><p>å‘å¸ƒäºï¼š2020å¹´5æœˆ15æ—¥</p></a></div><div class="new-meta-item wordcount"><a class="notlink"><i class="fas fa-keyboard" aria-hidden="true"></i><p>å­—æ•°ï¼š1.2kå­—</p></a></div><div class="new-meta-item readtime"><a class="notlink"><i class="fas fa-hourglass-half" aria-hidden="true"></i><p>æ—¶é•¿ï¼š4åˆ†é’Ÿ</p></a></div></div><hr></div></section><section class="article typo"><div class="article-entry" itemprop="articleBody"><p>åŸæ–‡ï¼š</p><p><a href="https://www.learncpp.com/cpp-tutorial/128-virtual-base-classes/" target="_blank" rel="noopener">https://www.learncpp.com/cpp-tutorial/128-virtual-base-classes/</a></p><hr><p>ä¸Šä¸€ç« ï¼Œåœ¨<a href="https://www.learncpp.com/cpp-tutorial/117-multiple-inheritance/" target="_blank" rel="noopener">11.7 â€“ Multiple inheritance</a>ä¸­ï¼Œæˆ‘ä»¬åœæ­¢äº†å¯¹â€œé’»çŸ³é—®é¢˜â€çš„è®¨è®ºã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­è®¨è®ºã€‚</p><h1 id="é’»çŸ³çš„é—®é¢˜"><a href="#é’»çŸ³çš„é—®é¢˜" class="headerlink" title="é’»çŸ³çš„é—®é¢˜"></a>é’»çŸ³çš„é—®é¢˜</h1><p>ä¸‹é¢æ˜¯æˆ‘ä»¬ä»ä¸ŠèŠ‚è¯¾(å’Œä¸€äº›æ„é€ å‡½æ•°)ä¸­å¾—åˆ°çš„ä¾‹å­ï¼Œæ¼”ç¤ºäº†è±å½¢é—®é¢˜:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PoweredDevice</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    PoweredDevice(<span class="keyword">int</span> power)</span><br><span class="line">    &#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"PoweredDevice: "</span> &lt;&lt; power &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Scanner</span>:</span> <span class="keyword">public</span> PoweredDevice</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Scanner(<span class="keyword">int</span> scanner, <span class="keyword">int</span> power)</span><br><span class="line">        : PoweredDevice(power)</span><br><span class="line">    &#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"Scanner: "</span> &lt;&lt; scanner &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Printer</span>:</span> <span class="keyword">public</span> PoweredDevice</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Printer(<span class="keyword">int</span> printer, <span class="keyword">int</span> power)</span><br><span class="line">        : PoweredDevice(power)</span><br><span class="line">    &#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"Printer: "</span> &lt;&lt; printer &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Copier</span>:</span> <span class="keyword">public</span> Scanner, <span class="keyword">public</span> Printer</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Copier(<span class="keyword">int</span> scanner, <span class="keyword">int</span> printer, <span class="keyword">int</span> power)</span><br><span class="line">        : Scanner(scanner, power), Printer(printer, power)</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å°½ç®¡ä½ å¯èƒ½å¸Œæœ›å¾—åˆ°è¿™æ ·çš„ç»§æ‰¿å›¾:</p><p><img src="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/image/loading.gif" data-original="http://www.learncpp.com/images/CppTutorial/Section11/PoweredDevice.gif" alt="img"></p><p>å¦‚æœæ‚¨è¦åˆ›å»ºä¸€ä¸ªcopyç±»å¯¹è±¡ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‚¨å°†å¾—åˆ°PoweredDeviceç±»çš„ä¸¤ä¸ªå‰¯æœ¬â€”â€”ä¸€ä¸ªæ¥è‡ªPrinterï¼Œå¦ä¸€ä¸ªæ¥è‡ªScannerã€‚å®ƒçš„ç»“æ„å¦‚ä¸‹:</p><p><img src="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/image/loading.gif" data-original="http://www.learncpp.com/images/CppTutorial/Section11/PoweredDevice2.gif" alt="img"></p><p>æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç®€çŸ­çš„ä¾‹å­ï¼Œå°†åœ¨è¡ŒåŠ¨ä¸­æ˜¾ç¤ºè¿™ä¸€ç‚¹:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Copier <span class="title">copier</span><span class="params">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span></span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å°±äº§ç”Ÿäº†ä»¥ä¸‹ç»“æœ:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PoweredDevice: 3</span><br><span class="line">Scanner: 1</span><br><span class="line">PoweredDevice: 3</span><br><span class="line">Printer: 2</span><br></pre></td></tr></table></figure><p>å¦‚ä½ æ‰€è§ï¼ŒPoweredDeviceæ„å»ºäº†ä¸¤æ¬¡ã€‚</p><p>è™½ç„¶è¿™é€šå¸¸æ˜¯éœ€è¦çš„ï¼Œä½†æœ‰æ—¶æ‚¨å¯èƒ½åªå¸Œæœ›æ‰«æä»ªå’Œæ‰“å°æœºå…±äº«PoweredDeviceçš„ä¸€ä¸ªå‰¯æœ¬ã€‚</p><h1 id="è™šæ‹ŸåŸºç±»"><a href="#è™šæ‹ŸåŸºç±»" class="headerlink" title="è™šæ‹ŸåŸºç±»"></a>è™šæ‹ŸåŸºç±»</h1><p>è¦<strong>å…±äº«</strong>åŸºç±»ï¼Œåªéœ€åœ¨æ´¾ç”Ÿç±»çš„ç»§æ‰¿åˆ—è¡¨ä¸­æ’å…¥â€œ<code>virtual</code>â€å…³é”®å­—å³å¯ã€‚è¿™åˆ›å»ºäº†æ‰€è°“çš„<strong>è™šåŸºç±»ï¼Œè¿™æ„å‘³ç€åªæœ‰ä¸€ä¸ªåŸºå¯¹è±¡ã€‚</strong></p><p><strong>åŸºå¯¹è±¡åœ¨ç»§æ‰¿æ ‘ä¸­çš„æ‰€æœ‰å¯¹è±¡ä¹‹é—´å…±äº«ï¼Œå¹¶ä¸”åªæ„é€ ä¸€æ¬¡ã€‚</strong></p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­(ä¸ºäº†ç®€å•ï¼Œæ²¡æœ‰æ„é€ å‡½æ•°)ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨virtualå…³é”®å­—åˆ›å»ºä¸€ä¸ªå…±äº«åŸºç±»:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PoweredDevice</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Scanner</span>:</span> <span class="keyword">virtual</span> <span class="keyword">public</span> PoweredDevice</span><br><span class="line">&#123;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Printer</span>:</span> <span class="keyword">virtual</span> <span class="keyword">public</span> PoweredDevice</span><br><span class="line">&#123;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Copier</span>:</span> <span class="keyword">public</span> Scanner, <span class="keyword">public</span> Printer</span><br><span class="line">&#123;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œå½“æ‚¨åˆ›å»ºå¤å°æœºç±»å¯¹è±¡æ—¶ï¼Œæ‚¨å°†ä»…ä¸ºæ¯ä¸ªå¤å°æœºè·å¾—ä¸€ä¸ªPoweredDeviceå‰¯æœ¬ï¼Œè¯¥å‰¯æœ¬å°†ç”±æ‰«æä»ªå’Œæ‰“å°æœºå…±äº«ã€‚</p><blockquote><p>ç„¶è€Œï¼Œè¿™åˆå¯¼è‡´äº†ä¸€ä¸ªé—®é¢˜:å¦‚æœæ‰«æä»ªå’Œæ‰“å°æœºå…±äº«ä¸€ä¸ªPoweredDeviceåŸºç±»ï¼Œè°è´Ÿè´£åˆ›å»ºå®ƒ?</p><p><strong>ç­”æ¡ˆæ˜¯ Copier</strong>ã€‚Copier æ„é€ å‡½æ•° è´Ÿè´£åˆ›å»ºPoweredDeviceã€‚</p><p>å› æ­¤ï¼Œè¿™æ˜¯ç¬¬ä¸€æ¬¡ å…è®¸Copierç›´æ¥è°ƒç”¨ éç›´çš„æ¥çˆ¶ç±» çš„æ„é€ å‡½æ•°ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PoweredDevice</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    PoweredDevice(<span class="keyword">int</span> power)</span><br><span class="line">    &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"PoweredDevice: "</span> &lt;&lt; power &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Scanner</span>:</span> <span class="keyword">virtual</span> <span class="keyword">public</span> PoweredDevice <span class="comment">// æ³¨æ„:PoweredDeviceç°åœ¨æ˜¯ä¸€ä¸ªè™šæ‹ŸåŸºç±»</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Scanner(<span class="keyword">int</span> scanner, <span class="keyword">int</span> power)</span><br><span class="line">        : PoweredDevice(power) <span class="comment">// åˆ›å»ºæ‰«æå¯¹è±¡éœ€è¦è¿™ä¸€è¡Œï¼Œä½†åœ¨æœ¬ä¾‹ä¸­å¿½ç•¥äº†è¿™ä¸€è¡Œ</span></span><br><span class="line">    &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Scanner: "</span> &lt;&lt; scanner &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Printer</span>:</span> <span class="keyword">virtual</span> <span class="keyword">public</span> PoweredDevice <span class="comment">// æ³¨æ„:PoweredDeviceç°åœ¨æ˜¯ä¸€ä¸ªè™šæ‹ŸåŸºç±»</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Printer(<span class="keyword">int</span> printer, <span class="keyword">int</span> power)</span><br><span class="line">        : PoweredDevice(power) <span class="comment">// åˆ›å»ºæ‰«æå¯¹è±¡éœ€è¦è¿™ä¸€è¡Œï¼Œä½†åœ¨æœ¬ä¾‹ä¸­å¿½ç•¥äº†è¿™ä¸€è¡Œ</span></span><br><span class="line">    &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Printer: "</span> &lt;&lt; printer &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Copier</span>:</span> <span class="keyword">public</span> Scanner, <span class="keyword">public</span> Printer</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Copier(<span class="keyword">int</span> scanner, <span class="keyword">int</span> printer, <span class="keyword">int</span> power)</span><br><span class="line">        : PoweredDevice(power), <span class="comment">// PoweredDeviceæ˜¯åœ¨è¿™é‡Œæ„å»ºçš„</span></span><br><span class="line">        Scanner(scanner, power), Printer(printer, power)</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Copier <span class="title">copier</span><span class="params">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span></span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PoweredDevice: 3</span><br><span class="line">Scanner: 1</span><br><span class="line">Printer: 2</span><br></pre></td></tr></table></figure><p>å¦‚æ‚¨æ‰€è§ï¼ŒPoweredDeviceåªæ„é€ ä¸€æ¬¡ã€‚</p></blockquote><p>æœ‰ä¸€äº›ç»†èŠ‚ï¼Œå¦‚æœæˆ‘ä»¬ä¸æï¼Œé‚£å°±æ˜¯æˆ‘ä»¬çš„ç–å¿½ï¼š</p><ul><li><p>é¦–å…ˆï¼Œè™šåŸºç±»æ€»æ˜¯åœ¨éè™šåŸºç±»<strong>ä¹‹å‰</strong>åˆ›å»ºï¼Œè¿™ç¡®ä¿äº†æ‰€æœ‰çš„åŸº éƒ½åœ¨å®ƒä»¬çš„æ´¾ç”Ÿç±»ä¹‹å‰åˆ›å»ºã€‚</p></li><li><p>å…¶æ¬¡ï¼Œæ³¨æ„Scanner å’Œ Printerçš„æ„é€ å‡½æ•°ä»ç„¶æœ‰å¯¹PoweredDeviceæ„é€ å‡½æ•°çš„è°ƒç”¨ã€‚</p><blockquote><p>å½“åˆ›å»ºä¸€ä¸ªcopyå®ä¾‹æ—¶ï¼Œè¿™äº›æ„é€ å‡½æ•°è°ƒç”¨è¢«ç®€å•åœ°å¿½ç•¥ï¼Œå› ä¸ºcopierè´Ÿè´£åˆ›å»ºPoweredDeviceã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªScanneræˆ–Printerçš„å®ä¾‹ï¼Œå°†ä½¿ç”¨é‚£äº›æ„é€ å‡½æ•°è°ƒç”¨ï¼Œå¹¶åº”ç”¨å¸¸è§„ç»§æ‰¿è§„åˆ™ã€‚</p></blockquote></li><li><p>ç¬¬ä¸‰ï¼Œå¦‚æœä¸€ä¸ªç±»ç»§æ‰¿äº†ä¸€ä¸ªæˆ–å¤šä¸ªå…·æœ‰è™šçˆ¶ç±»çš„ç±»ï¼Œé‚£ä¹ˆ<strong>æœ€æ´¾ç”Ÿ</strong>çš„ç±»è´Ÿè´£æ„é€ è™šåŸºç±»ã€‚</p><blockquote><p>åœ¨æœ¬ä¾‹ä¸­ï¼Œcopierç»§æ‰¿äº†Printerå’ŒScannerï¼Œå®ƒä»¬éƒ½æœ‰ä¸€ä¸ªPoweredDeviceè™šæ‹ŸåŸºç±»ã€‚</p><p><strong>copieræ˜¯æœ€æ´¾ç”Ÿçš„ç±»ï¼Œè´Ÿè´£åˆ›å»ºPoweredDeviceã€‚</strong></p><blockquote><p>æ³¨æ„ï¼Œå³ä½¿åœ¨å•ä¸ªç»§æ‰¿æƒ…å†µä¸‹ä¹Ÿæ˜¯å¦‚æ­¤: å¦‚æœcopyæ˜¯ä»Printerå•ç‹¬ç»§æ‰¿çš„ï¼Œè€ŒPrinterå®é™…ä¸Šæ˜¯ä»PoweredDeviceç»§æ‰¿çš„ï¼Œé‚£ä¹ˆcopier<u>ä»ç„¶</u>è´Ÿè´£åˆ›å»ºPoweredDeviceã€‚</p></blockquote></blockquote></li><li><p>ç¬¬å››ï¼Œ<strong>æ‰€æœ‰ç»§æ‰¿è™šåŸºç±»çš„ç±»éƒ½å°†æœ‰ä¸€ä¸ªè™šè¡¨</strong> (å³ä½¿å®ƒä»¬é€šå¸¸æ²¡æœ‰è™šè¡¨) ï¼Œ<u>å› æ­¤å®ƒä»¬çš„å¤§å°ä¼šå¢å¤§ ä¸€ä¸ªæŒ‡é’ˆçš„å¤§å°ã€‚</u></p></li></ul><p><strong>å› ä¸ºScanner and Printer å®é™…ä¸Šæ˜¯ä»PoweredDeviceæ´¾ç”Ÿå‡ºæ¥çš„ï¼Œæ‰€ä»¥Copierå°†åªä½œä¸ºä¸€ä¸ªPoweredDeviceå­å¯¹è±¡</strong>ã€‚</p><p>Scanner and Printer éƒ½éœ€è¦çŸ¥é“å¦‚ä½•æ‰¾åˆ°é‚£ä¸ªå•ç‹¬çš„PoweredDeviceå­å¯¹è±¡ï¼Œè¿™æ ·å®ƒä»¬å°±å¯ä»¥è®¿é—®å®ƒçš„æˆå‘˜(å› ä¸ºå®ƒä»¬æ¯•ç«Ÿæ˜¯ä»å®ƒæ´¾ç”Ÿå‡ºæ¥çš„)ã€‚</p><blockquote><p>è¿™é€šå¸¸æ˜¯é€šè¿‡ä¸€äº›è™šè¡¨ é­”æ³•æ¥å®Œæˆçš„(å®ƒå®é™…ä¸Šå°†æ¯ä¸ªå­ç±»çš„åç§»é‡å­˜å‚¨åˆ°PoweredDeviceå­å¯¹è±¡ä¸­)ã€‚</p></blockquote></div></section></article></div><div class="post-wrapper"><article class="post white-box shadow reveal"><section class="meta"><div class="meta" id="header-meta"><h2 class="title"><a href="/archives/82369fbe.html">C&C++/çº¯è™šå‡½æ•°ã€æŠ½è±¡åŸºç±»ã€æ¥å£ç±»</a></h2><div class="new-meta-box"><div class="new-meta-item author"><a href="https://longlongqin.github.io" rel="nofollow"><img src="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/image/loading.gif" data-original="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/photo.jpg"><p>longlongin</p></a></div><div class="new-meta-item date"><a class="notlink"><i class="fas fa-edit" aria-hidden="true"></i><p>å‘å¸ƒäºï¼š2020å¹´5æœˆ15æ—¥</p></a></div><div class="new-meta-item wordcount"><a class="notlink"><i class="fas fa-keyboard" aria-hidden="true"></i><p>å­—æ•°ï¼š2.5kå­—</p></a></div><div class="new-meta-item readtime"><a class="notlink"><i class="fas fa-hourglass-half" aria-hidden="true"></i><p>æ—¶é•¿ï¼š10åˆ†é’Ÿ</p></a></div></div><hr></div></section><section class="article typo"><div class="article-entry" itemprop="articleBody"><p>åŸæ–‡ï¼š</p><p><a href="https://www.learncpp.com/cpp-tutorial/126-pure-virtual-functions-abstract-base-classes-and-interface-classes/" target="_blank" rel="noopener">https://www.learncpp.com/cpp-tutorial/126-pure-virtual-functions-abstract-base-classes-and-interface-classes/</a></p><hr><h1 id="çº¯è™š-æŠ½è±¡-å‡½æ•°ä¸-æŠ½è±¡åŸºç±»"><a href="#çº¯è™š-æŠ½è±¡-å‡½æ•°ä¸-æŠ½è±¡åŸºç±»" class="headerlink" title="çº¯è™š(æŠ½è±¡)å‡½æ•°ä¸ æŠ½è±¡åŸºç±»"></a>çº¯è™š(æŠ½è±¡)å‡½æ•°ä¸ æŠ½è±¡åŸºç±»</h1><blockquote><h1 id="Pure-virtual-functionsï¼šçº¯è™šå‡½æ•°"><a href="#Pure-virtual-functionsï¼šçº¯è™šå‡½æ•°" class="headerlink" title="Pure virtual functionsï¼šçº¯è™šå‡½æ•°"></a>Pure virtual functionsï¼šçº¯è™šå‡½æ•°</h1></blockquote><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ç¼–å†™çš„æ‰€æœ‰è™šå‡½æ•°éƒ½æœ‰ä¸€ä¸ªä¸»ä½“(å®šä¹‰)ã€‚<strong>ä½†æ˜¯ï¼Œc++å…è®¸æ‚¨åˆ›å»ºä¸€ç§ç‰¹æ®Šçš„è™šå‡½æ•°ï¼Œç§°ä¸ºçº¯è™šå‡½æ•°(æˆ–æŠ½è±¡å‡½æ•°)ï¼Œå®ƒå®Œå…¨æ²¡æœ‰å®ä½“!</strong></p><p><strong>ä¸€ä¸ªçº¯è™šå‡½æ•°åªæ˜¯ä½œä¸ºä¸€ä¸ªå ä½ç¬¦ï¼Œå®ƒå°†è¢«æ´¾ç”Ÿç±»é‡æ–°å®šä¹‰ã€‚</strong></p><p><strong>è¦åˆ›å»ºä¸€ä¸ªçº¯è™šå‡½æ•°ï¼Œè€Œä¸æ˜¯ä¸ºå‡½æ•°å®šä¹‰ä¸€ä¸ªä¸»ä½“ï¼Œæˆ‘ä»¬åªéœ€å°†å‡½æ•°èµ‹å€¼ä¸º0ã€‚</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">sayHi</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="string">"Hi"</span>; &#125; <span class="comment">// a normal non-virtual function    </span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">getName</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="string">"Base"</span>; &#125; <span class="comment">// a normal virtual function</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">getValue</span><span class="params">()</span> </span>= <span class="number">0</span>; <span class="comment">// çº¯è™šå‡½æ•°</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">doSomething</span><span class="params">()</span> </span>= <span class="number">0</span>; <span class="comment">// ç¼–è¯‘é”™è¯¯:æ— æ³•å°†éè™šå‡½æ•°è®¾ç½®ä¸º0</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>å½“æˆ‘ä»¬å‘ç±»æ·»åŠ ä¸€ä¸ªçº¯è™šå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨è¯´ï¼Œâ€œå®ç°è¿™ä¸ªå‡½æ•°å–å†³äºæ´¾ç”Ÿç±»â€ã€‚</strong></p><p>ä½¿ç”¨çº¯è™šå‡½æ•°æœ‰ä¸¤ä¸ªä¸»è¦çš„ç»“æœ:</p><ul><li><p>é¦–å…ˆï¼Œä»»ä½•å¸¦æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªçº¯è™šå‡½æ•°çš„ç±»éƒ½å˜æˆäº†ä¸€ä¸ª<strong>æŠ½è±¡åŸºç±»</strong>ï¼Œè¿™æ„å‘³ç€å®ƒä¸èƒ½è¢«å®ä¾‹åŒ–!</p><blockquote><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è€ƒè™‘ä¸€ä¸‹å¦‚æœæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªBaseå®ä¾‹ä¼šå‘ç”Ÿä»€ä¹ˆ:</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mian</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Base base; <span class="comment">// æˆ‘ä»¬ä¸èƒ½å®ä¾‹åŒ–ä¸€ä¸ªæŠ½è±¡åŸºç±»â­ï¼Œä½†æ˜¯ä¸ºäº†ä¸¾ä¾‹è¯´æ˜ï¼Œå‡è®¾è¿™æ˜¯å…è®¸çš„</span></span><br><span class="line">    base.getValue(); <span class="comment">// what would this do?</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºæ²¡æœ‰getValue()çš„å®šä¹‰ï¼Œé‚£ä¹ˆbase.getValue()è§£ææˆä»€ä¹ˆå‘¢?</p></blockquote></li><li><p>å…¶æ¬¡ï¼Œä»»ä½•æ´¾ç”Ÿç±»éƒ½å¿…é¡»ä¸ºè¿™ä¸ªå‡½æ•°å®šä¹‰ä¸€ä¸ªä¸»ä½“ï¼Œå¦åˆ™è¿™ä¸ªæ´¾ç”Ÿç±»ä¹Ÿä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±»ã€‚</p></li></ul><h2 id="ä¸€ä¸ªçº¯è™šå‡½æ•°çš„ä¾‹å­"><a href="#ä¸€ä¸ªçº¯è™šå‡½æ•°çš„ä¾‹å­" class="headerlink" title="ä¸€ä¸ªçº¯è™šå‡½æ•°çš„ä¾‹å­"></a>ä¸€ä¸ªçº¯è™šå‡½æ•°çš„ä¾‹å­</h2><p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªçº¯è™šå‡½æ•°çš„ä¾‹å­ã€‚åœ¨å‰ä¸€è¯¾ä¸­ï¼Œæˆ‘ä»¬ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„åŠ¨ç‰©åŸºç±»ï¼Œå¹¶ä»ä¸­æ´¾ç”Ÿäº†ä¸€ä¸ªCatç±»ã€‚è¿™æ˜¯æˆ‘ä»¬ç•™ä¸‹çš„ä»£ç :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> m_name;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//æˆ‘ä»¬ä½¿è¿™ä¸ªæ„é€ å‡½æ•°å—ä¿æŠ¤ï¼Œå› ä¸º</span></span><br><span class="line">    <span class="comment">//æˆ‘ä»¬ä¸å¸Œæœ›äººä»¬ç›´æ¥åˆ›å»ºåŠ¨ç‰©å¯¹è±¡ï¼Œä½†æ˜¯æˆ‘ä»¬ä»ç„¶å¸Œæœ›æ´¾ç”Ÿç±»èƒ½å¤Ÿä½¿ç”¨å®ƒã€‚</span></span><br><span class="line">    Animal(<span class="built_in">std</span>::<span class="built_in">string</span> name)</span><br><span class="line">        : m_name(name)</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">getName</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> m_name; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">speak</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="string">"???"</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span>:</span> <span class="keyword">public</span> Animal</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Cat(<span class="built_in">std</span>::<span class="built_in">string</span> name)</span><br><span class="line">        : Animal(name)</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">speak</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="string">"Meow"</span>; &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é€šè¿‡ä½¿æ„é€ å‡½æ•°å—ä¿æŠ¤æ¥é˜»æ­¢äººä»¬åˆ†é…Animalç±»å‹çš„å¯¹è±¡ã€‚ç„¶è€Œï¼Œè¿™æ ·åšæœ‰ä¸¤ä¸ªé—®é¢˜:</p><ul><li>æ„é€ å‡½æ•°ä»ç„¶å¯ä»¥ä»æ´¾ç”Ÿç±»ä¸­è®¿é—®ï¼Œè¿™ä½¿å¾—å®ä¾‹åŒ–ä¸€ä¸ªAnimalå¯¹è±¡æˆä¸ºå¯èƒ½ã€‚</li><li>ä»ç„¶å¯ä»¥åˆ›å»ºä¸é‡æ–°å®šä¹‰å‡½æ•°speak()çš„æ´¾ç”Ÿç±»ã€‚</li></ul><p>å¦‚ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cow</span>:</span> <span class="keyword">public</span> Animal</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Cow(<span class="built_in">std</span>::<span class="built_in">string</span> name)</span><br><span class="line">        : Animal(name)</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// We forgot to redefine speak</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Cow <span class="title">cow</span><span class="params">(<span class="string">"Betsy"</span>)</span></span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; cow.getName() &lt;&lt; <span class="string">" says "</span> &lt;&lt; cow.speak() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*ç»“æœ*/</span></span><br><span class="line">Betsy says ???</span><br></pre></td></tr></table></figure><p>å‘ç”Ÿäº†ä»€ä¹ˆäº‹? æˆ‘ä»¬å¿˜è®°äº†é‡æ–°å®šä¹‰å‡½æ•°speak()ï¼Œå› æ­¤cow.Speak()è§£æä¸ºAnimal.speak()ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚</p><p><strong>æ›´å¥½çš„è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨çº¯è™šå‡½æ•°:</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> // è¿™ä¸ªåŠ¨ç‰©æ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±»</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> m_name;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Animal(<span class="built_in">std</span>::<span class="built_in">string</span> name)</span><br><span class="line">        : m_name(name)</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">getName</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> m_name; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">speak</span><span class="params">()</span> </span>= <span class="number">0</span>; <span class="comment">// æ³¨æ„ï¼Œspeakç°åœ¨æ˜¯ä¸€ä¸ªçº¯è™šå‡½æ•°</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ã€‚</p><ul><li><p>speak()ç°åœ¨æ˜¯ä¸€ä¸ªçº¯è™šå‡½æ•°ã€‚è¿™æ„å‘³ç€Animalç°åœ¨æ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±»ï¼Œä¸èƒ½è¢«å®ä¾‹åŒ–ã€‚</p><blockquote><p>å› æ­¤ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦ä½¿æ„é€ å‡½æ•°ä¸ºprotected(å°½ç®¡å®ƒä¸ä¼šé€ æˆä¼¤å®³)ã€‚</p></blockquote></li><li><p>å…¶æ¬¡ï¼Œå› ä¸ºæˆ‘ä»¬çš„Cowç±»æ´¾ç”Ÿè‡ªAnimalï¼Œ<u>ä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰å®šä¹‰Cow::speak()ï¼Œ æ‰€ä»¥Cowä¹Ÿæ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±»</u>ã€‚ç°åœ¨ï¼Œå½“æˆ‘ä»¬è¯•å›¾ç¼–è¯‘è¿™æ®µä»£ç :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cow</span>:</span> <span class="keyword">public</span> Animal</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Cow(<span class="built_in">std</span>::<span class="built_in">string</span> name)</span><br><span class="line">        : Animal(name)</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// We forgot to redefine speak</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Cow <span class="title">cow</span><span class="params">(<span class="string">"Betsy"</span>)</span></span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; cow.getName() &lt;&lt; <span class="string">" says "</span> &lt;&lt; cow.speak() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å™¨ä¼šç»™æˆ‘ä»¬ä¸€ä¸ªè­¦å‘Šï¼Œå› ä¸ºCowæ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±»ï¼Œæˆ‘ä»¬ä¸èƒ½åˆ›å»ºæŠ½è±¡åŸºç±»çš„å®ä¾‹:</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Test.cpp(141) : error C2259: 'Cow' : cannot instantiate abstract class due to following members:</span><br><span class="line">        C:Test.cpp(128) : see declaration of 'Cow'</span><br><span class="line">C:\Test.cpp(141) : warning C4259: 'const char *__thiscall Animal::speak(void)' : pure virtual function was not defined</span><br></pre></td></tr></table></figure><p>è¿™å‘Šè¯‰æˆ‘ä»¬ï¼Œåªæœ‰å½“Cowä¸ºspeak()æä¾›äº†ä¸€ä¸ªä¸»ä½“æ—¶ï¼Œæˆ‘ä»¬æ‰èƒ½å¤Ÿå®ä¾‹åŒ–Cowã€‚</p></li></ul><p>ä¿®æ”¹åçš„ä»£ç ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cow</span>:</span> <span class="keyword">public</span> Animal</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Cow(<span class="built_in">std</span>::<span class="built_in">string</span> name)</span><br><span class="line">        : Animal(name)</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">speak</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="string">"Moo"</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Cow <span class="title">cow</span><span class="params">(<span class="string">"Betsy"</span>)</span></span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; cow.getName() &lt;&lt; <span class="string">" says "</span> &lt;&lt; cow.speak() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*ç»“æœ*/</span></span><br><span class="line">Betsy says Moo</span><br></pre></td></tr></table></figure><p><strong>å½“æˆ‘ä»¬æƒ³è¦å°†ä¸€ä¸ªå‡½æ•°æ”¾å…¥åŸºç±»ä¸­ï¼Œä½†åªæœ‰æ´¾ç”Ÿç±»çŸ¥é“å®ƒåº”è¯¥è¿”å›ä»€ä¹ˆæ—¶ï¼Œçº¯è™šå‡½æ•°æ˜¯æœ‰ç”¨çš„ã€‚çº¯è™šå‡½æ•°ä½¿åŸºç±»æ— æ³•å®ä¾‹åŒ–ï¼Œæ´¾ç”Ÿç±»è¢«è¿«åœ¨å®ä¾‹åŒ–è¿™äº›å‡½æ•°ä¹‹å‰å®šä¹‰å®ƒä»¬ã€‚è¿™æœ‰åŠ©äºç¡®ä¿æ´¾ç”Ÿç±»ä¸ä¼šå¿˜è®°é‡æ–°å®šä¹‰åŸºç±»æ‰€æœŸæœ›çš„å‡½æ•°ã€‚</strong></p><h1 id="å¸¦æœ‰ä¸»ä½“çš„çº¯è™šå‡½æ•°"><a href="#å¸¦æœ‰ä¸»ä½“çš„çº¯è™šå‡½æ•°" class="headerlink" title="å¸¦æœ‰ä¸»ä½“çš„çº¯è™šå‡½æ•°"></a>å¸¦æœ‰ä¸»ä½“çš„çº¯è™šå‡½æ•°</h1><p>äº‹å®è¯æ˜ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å…·æœ‰è‚‰ä½“çš„çº¯è™šå‡½æ•°:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> // è¿™ä¸ª<span class="title">Animal</span>æ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±»</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> m_name;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Animal(<span class="built_in">std</span>::<span class="built_in">string</span> name)</span><br><span class="line">        : m_name(name)</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">getName</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> m_name; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">speak</span><span class="params">()</span> </span>= <span class="number">0</span>; <span class="comment">// The = 0 è¡¨ç¤ºè¿™ä¸ªå‡½æ•°æ˜¯çº¯è™šå‡½æ•°</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">Animal::speak</span><span class="params">()</span>  <span class="comment">// å³ä½¿å®ƒæœ‰èº«ä½“</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"buzz"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œspeak()ä»ç„¶è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªçº¯è™šå‡½æ•°(å› ä¸ºâ€œ= 0â€ï¼Œå³ä½¿å·²ç»ç»™äº†å®ƒä¸€ä¸ªä¸»ä½“)ï¼ŒAnimalä»ç„¶è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±»(å› æ­¤ä¸èƒ½è¢«å®ä¾‹åŒ–)ã€‚</p><p>ä»»ä½•ç»§æ‰¿è‡ªAnimalçš„ç±»éƒ½éœ€è¦ä¸ºspeak()æä¾›è‡ªå·±çš„å®šä¹‰ï¼Œå¦åˆ™ä¹Ÿä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±»ã€‚</p><blockquote><p>å½“ä¸ºçº¯è™šå‡½æ•°æä¾›æ­£æ–‡æ—¶ï¼Œ<strong>å¿…é¡»å•ç‹¬æä¾›æ­£æ–‡(ä¸æ˜¯å†…è”çš„)ã€‚</strong></p></blockquote><hr><p>å½“æ‚¨å¸Œæœ›åŸºç±»ä¸ºå‡½æ•°æä¾›é»˜è®¤å®ç°ï¼Œä½†ä»ç„¶å¼ºåˆ¶ä»»ä½•æ´¾ç”Ÿç±»æä¾›å®ƒä»¬è‡ªå·±çš„å®ç°æ—¶ï¼Œæ­¤èŒƒä¾‹éå¸¸æœ‰ç”¨ã€‚<strong>ä½†æ˜¯ï¼Œå¦‚æœæ´¾ç”Ÿç±»å¯¹åŸºç±»æä¾›çš„é»˜è®¤å®ç°æ„Ÿåˆ°æ»¡æ„ï¼Œå®ƒå¯ä»¥ç›´æ¥è°ƒç”¨åŸºç±»å®ç°ã€‚ä¾‹å¦‚ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> // <span class="title">This</span> <span class="title">Animal</span> <span class="title">is</span> <span class="title">an</span> <span class="title">abstract</span> <span class="title">base</span> <span class="title">class</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> m_name;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Animal(<span class="built_in">std</span>::<span class="built_in">string</span> name)</span><br><span class="line">        : m_name(name)</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">getName</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> m_name; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">speak</span><span class="params">()</span> </span>= <span class="number">0</span>; <span class="comment">// note that speak is a pure virtual function</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">Animal::speak</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"buzz"</span>; <span class="comment">// some default implementation</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dragonfly</span>:</span> <span class="keyword">public</span> Animal</span><br><span class="line">&#123;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Dragonfly(<span class="built_in">std</span>::<span class="built_in">string</span> name)</span><br><span class="line">        : Animal(name)</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">speak</span><span class="params">()</span> <span class="comment">//â­ ä¸ªç±»ä¸å†æ˜¯æŠ½è±¡çš„ï¼Œå› ä¸ºæˆ‘ä»¬å®šä¹‰äº†è¿™ä¸ªå‡½æ•°</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Animal::speak(); <span class="comment">// ä½¿ç”¨Animalçš„é»˜è®¤å®ç°i</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Dragonfly <span class="title">dfly</span><span class="params">(<span class="string">"Sally"</span>)</span></span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; dfly.getName() &lt;&lt; <span class="string">" says "</span> &lt;&lt; dfly.speak() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*ç»“æœ*/</span></span><br><span class="line">Sally says buzz</span><br></pre></td></tr></table></figure><p>è¿™ç§åŠŸèƒ½å¹¶ä¸å¸¸ç”¨ã€‚</p><h1 id="æ¥å£ç±»"><a href="#æ¥å£ç±»" class="headerlink" title="æ¥å£ç±»"></a>æ¥å£ç±»</h1><blockquote><p><strong>Interface classes</strong> ï¼š æ¥å£ç±»</p></blockquote><p>æ¥å£ç±»æ˜¯ä¸€ä¸ª<strong>æ²¡æœ‰æˆå‘˜å˜é‡çš„ç±»</strong>ï¼Œå…¶ä¸­<strong>æ‰€æœ‰çš„å‡½æ•°éƒ½æ˜¯çº¯è™šçš„</strong>!</p><blockquote><p>æ¢å¥è¯è¯´ï¼Œ<strong>è¯¥ç±»çº¯ç²¹æ˜¯ä¸€ä¸ªå®šä¹‰ï¼Œæ²¡æœ‰å®é™…çš„å®ç°</strong>ã€‚</p></blockquote><p>å½“æ‚¨æƒ³å®šä¹‰æ´¾ç”Ÿç±»å¿…é¡»å®ç°çš„åŠŸèƒ½ï¼Œä½†å°†æ´¾ç”Ÿç±»å¦‚ä½•å®ç°è¯¥åŠŸèƒ½çš„ç»†èŠ‚å®Œå…¨ç•™ç»™æ´¾ç”Ÿç±»æ—¶ï¼Œæ¥å£æ˜¯æœ‰ç”¨çš„ã€‚</p><p><strong>æ¥å£ç±»é€šå¸¸ä»¥Iå¼€å¤´ã€‚</strong></p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹æ¥å£ç±»:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IerrorLog</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">openLog</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *filename)</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">closeLog</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">writeError</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *errorMessage)</span> </span>= <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªè™šææ„å‡½æ•°ï¼Œå‡è®¾æˆ‘ä»¬åˆ é™¤ä¸€ä¸ªIErrorLogæŒ‡é’ˆï¼Œ</span></span><br><span class="line">    <span class="comment">// è¿™æ ·å°±å¯ä»¥è°ƒç”¨æ­£ç¡®çš„æ´¾ç”Ÿææ„å‡½æ•°</span></span><br><span class="line">    <span class="keyword">virtual</span> ~IErrorLog() &#123;&#125; </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>ä»IErrorLogç»§æ‰¿çš„ä»»ä½•ç±»å¿…é¡»ä¸ºæ‰€æœ‰ä¸‰ä¸ªå‡½æ•°æä¾›å®ç°ï¼Œä»¥ä¾¿å®ä¾‹åŒ–</strong>ã€‚</p><blockquote><p>æ‚¨å¯ä»¥æ´¾ç”Ÿä¸€ä¸ªåä¸º<strong>FileErrorLog</strong>çš„ç±»ï¼Œå…¶ä¸­ï¼š</p><ul><li>openLog()æ‰“å¼€ç£ç›˜ä¸Šçš„æ–‡ä»¶ï¼Œ</li><li>closeLog()å…³é—­æ–‡ä»¶ï¼Œ</li><li>writeError()å°†æ¶ˆæ¯å†™å…¥æ–‡ä»¶ã€‚</li></ul><p>æ‚¨å¯ä»¥æ´¾ç”Ÿå¦ä¸€ä¸ªåä¸º<strong>ScreenErrorLog</strong>çš„ç±»ï¼Œ</p><p>å…¶ä¸­openLog()å’ŒcloseLog()ä»€ä¹ˆéƒ½ä¸åšï¼ŒwriteError()åœ¨å±å¹•ä¸Šçš„å¼¹å‡ºæ¶ˆæ¯æ¡†ä¸­æ‰“å°æ¶ˆæ¯ã€‚</p><p>ç°åœ¨ï¼Œå‡è®¾æ‚¨éœ€è¦ç¼–å†™ä¸€äº›ä½¿ç”¨é”™è¯¯æ—¥å¿—çš„ä»£ç ã€‚<strong>å¦‚æœæ‚¨ç¼–å†™çš„ä»£ç ä¸­ç›´æ¥åŒ…å«äº†FileErrorLogæˆ–ScreenErrorLogï¼Œé‚£ä¹ˆæ‚¨å®é™…ä¸Šæ˜¯åœ¨ä½¿ç”¨è¿™ç§é”™è¯¯æ—¥å¿—(è‡³å°‘åœ¨ä¸é‡æ–°ç¼–å†™ç¨‹åºçš„æƒ…å†µä¸‹)</strong>ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„å‡½æ•°æœ‰æ•ˆåœ°è¿«ä½¿mySqrt()çš„è°ƒç”¨è€…ä½¿ç”¨FileErrorLogï¼Œè¿™å¯èƒ½æ˜¯ä»–ä»¬æƒ³è¦çš„ï¼Œä¹Ÿå¯èƒ½ä¸æ˜¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt; // for sqrt()</span></span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">mySqrt</span><span class="params">(<span class="keyword">double</span> value, FileErrorLog &amp;<span class="built_in">log</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (value &lt; <span class="number">0.0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">log</span>.writeError(<span class="string">"Tried to take square root of value less than 0"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sqrt</span>(value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ç°è¿™ä¸ªå‡½æ•°çš„ä¸€ä¸ªæ›´å¥½çš„æ–¹æ³•æ˜¯ä½¿ç”¨IErrorLog:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt; // for sqrt()</span></span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">mySqrt</span><span class="params">(<span class="keyword">double</span> value, IErrorLog &amp;<span class="built_in">log</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (value &lt; <span class="number">0.0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">log</span>.writeError(<span class="string">"Tried to take square root of value less than 0"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sqrt</span>(value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œ<strong>è°ƒç”¨è€…å¯ä»¥ä¼ å…¥ä»»ä½•ç¬¦åˆIErrorLogæ¥å£çš„ç±»</strong>ã€‚â­</p><ul><li>å¦‚æœä»–ä»¬å¸Œæœ›é”™è¯¯è½¬ç§»åˆ°æ–‡ä»¶ä¸­ï¼Œä»–ä»¬å¯ä»¥ä¼ å…¥FileErrorLogçš„å®ä¾‹ã€‚</li><li>å¦‚æœä»–ä»¬æƒ³è®©å®ƒæ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œä»–ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ªScreenErrorLogå®ä¾‹ã€‚</li><li>æˆ–è€…ï¼Œå¦‚æœä»–ä»¬æƒ³åšä¸€äº›æ‚¨ç”šè‡³æ²¡æœ‰æƒ³åˆ°çš„äº‹æƒ…ï¼Œæ¯”å¦‚åœ¨å‡ºç°é”™è¯¯æ—¶å‘æŸäººå‘é€ç”µå­é‚®ä»¶ï¼Œä»–ä»¬å¯ä»¥ä»IErrorLog(ä¾‹å¦‚EmailErrorLog)æ´¾ç”Ÿä¸€ä¸ªæ–°ç±»å¹¶ä½¿ç”¨å®ƒçš„ä¸€ä¸ªå®ä¾‹!</li></ul><p>é€šè¿‡ä½¿ç”¨IErrorLogï¼Œæ‚¨çš„å‡½æ•°å˜å¾—æ›´åŠ ç‹¬ç«‹å’Œçµæ´»ã€‚</p></blockquote><p><strong>ä¸è¦å¿˜è®°ä¸ºæ‚¨çš„æ¥å£ç±»åŒ…å«ä¸€ä¸ªè™šææ„å‡½æ•°ï¼Œä»¥ä¾¿åœ¨åˆ é™¤æŒ‡å‘æ¥å£çš„æŒ‡é’ˆæ—¶è°ƒç”¨é€‚å½“çš„æ´¾ç”Ÿææ„å‡½æ•°ã€‚</strong></p><h1 id="çº¯è™šå‡½æ•°ä¸è™šè¡¨"><a href="#çº¯è™šå‡½æ•°ä¸è™šè¡¨" class="headerlink" title="çº¯è™šå‡½æ•°ä¸è™šè¡¨"></a>çº¯è™šå‡½æ•°ä¸è™šè¡¨</h1><p>æŠ½è±¡ç±»ä»ç„¶æœ‰è™šè¡¨ï¼Œå› ä¸ºå¦‚æœæœ‰æŒ‡å‘æŠ½è±¡ç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œä»ç„¶å¯ä»¥ä½¿ç”¨è™šè¡¨ã€‚çº¯è™šå‡½æ•°çš„è™šè¡¨æ¡ç›®é€šå¸¸è¦ä¹ˆåŒ…å«ä¸€ä¸ªç©ºæŒ‡é’ˆï¼Œè¦ä¹ˆæŒ‡å‘ä¸€ä¸ªæ³›å‹å‡½æ•°ï¼Œ<u>å¦‚æœæ²¡æœ‰æä¾›è¦†ç›–ï¼Œè¿™ä¸ªæ³›å‹å‡½æ•°ä¼šè¾“å‡ºä¸€ä¸ªé”™è¯¯(æœ‰æ—¶è¿™ä¸ªå‡½æ•°è¢«å‘½åä¸º_purecall)ã€‚</u></p></div></section></article></div><div class="post-wrapper"><article class="post white-box shadow reveal"><section class="meta"><div class="meta" id="header-meta"><h2 class="title"><a href="/archives/71c91a8.html">C&C++/è™šè¡¨åŠéšè—çš„æŒ‡é’ˆ(__vptr)</a></h2><div class="new-meta-box"><div class="new-meta-item author"><a href="https://longlongqin.github.io" rel="nofollow"><img src="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/image/loading.gif" data-original="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/photo.jpg"><p>longlongin</p></a></div><div class="new-meta-item date"><a class="notlink"><i class="fas fa-edit" aria-hidden="true"></i><p>å‘å¸ƒäºï¼š2020å¹´5æœˆ14æ—¥</p></a></div><div class="new-meta-item wordcount"><a class="notlink"><i class="fas fa-keyboard" aria-hidden="true"></i><p>å­—æ•°ï¼š1.5kå­—</p></a></div><div class="new-meta-item readtime"><a class="notlink"><i class="fas fa-hourglass-half" aria-hidden="true"></i><p>æ—¶é•¿ï¼š5åˆ†é’Ÿ</p></a></div></div><hr></div></section><section class="article typo"><div class="article-entry" itemprop="articleBody"><p>åŸæ–‡ï¼š</p><p><a href="https://www.learncpp.com/cpp-tutorial/125-the-virtual-table/" target="_blank" rel="noopener">https://www.learncpp.com/cpp-tutorial/125-the-virtual-table/</a></p><hr><h1 id="è™šè¡¨"><a href="#è™šè¡¨" class="headerlink" title="è™šè¡¨"></a>è™šè¡¨</h1><p><strong>ä¸ºäº†å®ç°è™šå‡½æ•°ï¼Œc++ä½¿ç”¨äº†ä¸€ç§ç‰¹æ®Šçš„åæœŸç»‘å®šå½¢å¼ï¼Œç§°ä¸ºè™šè¡¨</strong>ã€‚</p><p><strong>è™šè¡¨æ˜¯ç”¨äºä»¥ åŠ¨æ€/åæœŸç»‘å®šæ–¹å¼ è§£æå‡½æ•°è°ƒç”¨ çš„å‡½æ•°çš„æŸ¥æ‰¾è¡¨</strong>ã€‚</p><blockquote><p>è™šè¡¨æœ‰æ—¶ä½¿ç”¨å…¶ä»–åç§°ï¼šè™šå‡½æ•°è¡¨ã€è°ƒåº¦è¡¨ã€â€¦.</p><p>â€œvtableâ€, â€œvirtual function tableâ€, â€œvirtual method tableâ€, or â€œdispatch tableâ€.</p></blockquote><hr><p>è™šè¡¨å®é™…ä¸Šéå¸¸ç®€å•ï¼Œè™½ç„¶ç”¨æ–‡å­—æè¿°æœ‰ç‚¹å¤æ‚ã€‚</p><ul><li><p>é¦–å…ˆï¼Œæ¯ä¸ªä½¿ç”¨è™šå‡½æ•°çš„ç±» (æˆ–æ´¾ç”Ÿè‡ªä½¿ç”¨è™šå‡½æ•°çš„ç±») éƒ½æœ‰è‡ªå·±çš„<strong>è™šè¡¨</strong>ã€‚</p><blockquote><p>è¿™ä¸ªè¡¨åªæ˜¯ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶è®¾ç½®çš„ä¸€ä¸ª<u>é™æ€æ•°ç»„</u>ã€‚</p></blockquote><p>è™šè¡¨åŒ…å«ä¸€ä¸ªæ¡ç›®ï¼Œè®°å½•äº†ï¼šæ¯ä¸ªè™šå‡½æ•°å¯ä»¥è¢«è°ƒç”¨çš„ç±»çš„å¯¹è±¡ã€‚è¿™ä¸ªè¡¨ä¸­çš„æ¯ä¸ªæ¡ç›®éƒ½æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼ŒæŒ‡å‘è¯¥ç±»å¯è®¿é—®çš„<strong>æ´¾ç”Ÿç¨‹åº¦æœ€é«˜</strong>çš„å‡½æ•°ã€‚</p></li><li><p>å…¶æ¬¡ï¼Œç¼–è¯‘å™¨è¿˜å‘åŸºç±»æ·»åŠ äº†ä¸€ä¸ª<strong>éšè—æŒ‡é’ˆï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º <code>*__vptr</code></strong>ã€‚<code>*__vptr</code>åœ¨åˆ›å»ºç±»å®ä¾‹æ—¶è®¾ç½®(è‡ªåŠ¨)ï¼Œä»¥ä¾¿å®ƒæŒ‡å‘è¯¥ç±»çš„è™šè¡¨ã€‚</p><blockquote><p><em>thisæŒ‡é’ˆï¼Œå®ƒå®é™…ä¸Šæ˜¯ç¼–è¯‘å™¨ç”¨æ¥è§£æè‡ªå¼•ç”¨çš„*</em>å‡½æ•°å‚æ•°**</p><p><code>*__vptr</code>ï¼šæ˜¯ä¸€ä¸ªçœŸå®çš„æŒ‡é’ˆï¼Œå®ƒä½¿åˆ†é…çš„æ¯ä¸ªç±»å¯¹è±¡çš„å¤§å°å¢åŠ ä¸€ä¸ªæŒ‡é’ˆã€‚<strong>è¿™ä¹Ÿæ„å‘³ç€<code>*__vptr</code>æ˜¯ç”±æ´¾ç”Ÿç±»ç»§æ‰¿çš„ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚</strong></p></blockquote></li></ul><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å¯èƒ½å¯¹è¿™äº›ä¸œè¥¿æ˜¯å¦‚ä½•ç»„åˆåœ¨ä¸€èµ·çš„æ„Ÿåˆ°å›°æƒ‘ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">function1</span><span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">function2</span><span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D1</span>:</span> <span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">function1</span><span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D2</span>:</span> <span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">function2</span><span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å› ä¸ºè¿™é‡Œæœ‰3ä¸ªç±»ï¼Œç¼–è¯‘å™¨å°†è®¾ç½®<strong>3ä¸ªè™šè¡¨</strong>: ä¸€ä¸ªç”¨äºBaseï¼Œä¸€ä¸ªç”¨äºD1ï¼Œä¸€ä¸ªç”¨äºD2ã€‚</p><h1 id="éšè—æŒ‡é’ˆ"><a href="#éšè—æŒ‡é’ˆ" class="headerlink" title="éšè—æŒ‡é’ˆ"></a>éšè—æŒ‡é’ˆ</h1><p>ç¼–è¯‘å™¨è¿˜å‘ä½¿ç”¨è™šå‡½æ•°çš„æœ€åŸºç±»æ·»åŠ ä¸€ä¸ª<strong>éšè—æŒ‡é’ˆ</strong>ã€‚è™½ç„¶ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è¿™æ ·åšï¼Œæˆ‘ä»¬ä¼šæŠŠå®ƒæ”¾åœ¨ä¸‹ä¸€ä¸ªä¾‹å­ï¼Œåªæ˜¯ä¸ºäº†æ˜¾ç¤ºå®ƒæ˜¯åœ¨å“ªé‡Œæ·»åŠ çš„:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    FunctionPointer *__vptr;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">function1</span><span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">function2</span><span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D1</span>:</span> <span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">function1</span><span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D2</span>:</span> <span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">function2</span><span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å½“åˆ›å»ºä¸€ä¸ªç±»å¯¹è±¡æ—¶ï¼Œ<code>*__vptr</code>è¢«è®¾ç½®ä¸ºæŒ‡å‘è¯¥ç±»çš„è™šè¡¨ã€‚ä¾‹å¦‚ï¼š</p><ul><li>å½“åˆ›å»ºäº†ä¸€ä¸ªBaseç±»å‹çš„å¯¹è±¡æ—¶ï¼Œ<code>*__vptr</code>è¢«è®¾ç½®ä¸ºæŒ‡å‘Baseçš„è™šè¡¨ã€‚</li><li>å½“æ„é€ D1æˆ–D2ç±»å‹çš„å¯¹è±¡æ—¶ï¼Œ<code>*__vptr</code>è¢«è®¾ç½®ä¸ºåˆ†åˆ«æŒ‡å‘D1æˆ–D2çš„è™šè¡¨ã€‚</li></ul><h1 id="è™šè¡¨å¦‚ä½•ç”Ÿæˆçš„ï¼Ÿ"><a href="#è™šè¡¨å¦‚ä½•ç”Ÿæˆçš„ï¼Ÿ" class="headerlink" title="è™šè¡¨å¦‚ä½•ç”Ÿæˆçš„ï¼Ÿ"></a>è™šè¡¨å¦‚ä½•ç”Ÿæˆçš„ï¼Ÿ</h1><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬è®¨è®ºä¸€ä¸‹è¿™äº›è™šæ‹Ÿè¡¨æ˜¯å¦‚ä½•å¡«å†™çš„ã€‚å› ä¸ºè¿™é‡Œåªæœ‰ä¸¤ä¸ªè™šå‡½æ•°ï¼Œæ¯ä¸ªè™šè¡¨å°†æœ‰ä¸¤ä¸ªæ¡ç›®(ä¸€ä¸ªç”¨äºfunction1()ï¼Œå¦ä¸€ä¸ªç”¨äºfunction2())ã€‚<strong>è¯·è®°ä½ï¼Œå½“è¿™äº›è™šè¡¨è¢«å¡«æ»¡æ—¶ï¼Œæ¯ä¸ªæ¡ç›®éƒ½å¡«æ»¡äº†è¯¥ç±»ç±»å‹çš„å¯¹è±¡å¯ä»¥è°ƒç”¨çš„æ´¾ç”Ÿç¨‹åº¦æœ€é«˜çš„å‡½æ•°</strong>ã€‚</p><ul><li><p><strong>åŸºç±»</strong>å¯¹è±¡çš„è™šè¡¨å¾ˆç®€å•ã€‚Baseç±»å‹çš„å¯¹è±¡åªèƒ½è®¿é—®Baseçš„æˆå‘˜ã€‚Baseä¸èƒ½è®¿é—®D1æˆ–D2å‡½æ•°ã€‚å› æ­¤ï¼Œfunction1çš„å…¥å£æŒ‡å‘Base::function1()ï¼Œè€Œfunction2çš„å…¥å£æŒ‡å‘Base::function2()ã€‚</p></li><li><p>D1çš„è™šè¡¨ç¨å¾®å¤æ‚ä¸€äº›ã€‚ç±»å‹D1çš„å¯¹è±¡å¯ä»¥è®¿é—®D1å’ŒBaseçš„æˆå‘˜ã€‚ä½†æ˜¯ï¼ŒD1å·²ç»è¦†ç›–äº†function1()ï¼Œä½¿å¾—D1::function1()æ¯”Base::function1()æ›´æ´¾ç”Ÿã€‚å› æ­¤ï¼Œfunction1çš„æ¡ç›®æŒ‡å‘D1::function1()ã€‚D1æ²¡æœ‰è¦†ç›–function2()ï¼Œå› æ­¤function2çš„æ¡ç›®å°†æŒ‡å‘Base::function2()ã€‚</p></li><li><p>D2çš„è™šè¡¨ç±»ä¼¼äºD1ï¼Œé™¤äº†function1çš„æ¡ç›®æŒ‡å‘Base::function1()ï¼Œè€Œfunction2çš„æ¡ç›®æŒ‡å‘D2::function2()ã€‚</p></li></ul><p>å°±åƒä¸‹é¢è¿™ä¸ªå›¾æ˜¾ç¤ºçš„ä¸€æ ·ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/image/loading.gif" data-original="http://www.learncpp.com/images/CppTutorial/Section12/VTable.gif" alt="img"></p><p>å°½ç®¡è¿™ä¸ªå›¾çœ‹èµ·æ¥æœ‰ç‚¹ç–¯ç‹‚ï¼Œä½†å®ƒç¡®å®éå¸¸ç®€å•: <strong>æ¯ä¸ªç±»ä¸­çš„* vptræŒ‡å‘è¯¥ç±»çš„è™šè¡¨ã€‚</strong> <strong>è™šè¡¨ä¸­çš„æ¡ç›®æŒ‡å‘è¯¥ç±»çš„å‡½æ•°å¯¹è±¡çš„æ´¾ç”Ÿç¨‹åº¦æœ€é«˜çš„ç‰ˆæœ¬ã€‚</strong></p><hr><h1 id="é€šè¿‡ä¾‹å­ç†è§£è™šè¡¨ä¸éšè—æŒ‡é’ˆ"><a href="#é€šè¿‡ä¾‹å­ç†è§£è™šè¡¨ä¸éšè—æŒ‡é’ˆ" class="headerlink" title="é€šè¿‡ä¾‹å­ç†è§£è™šè¡¨ä¸éšè—æŒ‡é’ˆ"></a>é€šè¿‡ä¾‹å­ç†è§£è™šè¡¨ä¸éšè—æŒ‡é’ˆ</h1><ol><li><p>è€ƒè™‘ä¸€ä¸‹å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªD1ç±»å‹çš„å¯¹è±¡æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    D1 d1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºd1æ˜¯D1å¯¹è±¡ï¼Œd1å°†å®ƒçš„<code>*__vptr</code> æŒ‡å‘ä¸ºd1è™šè¡¨ã€‚</p></li><li><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬è®¾ç½®ä¸€ä¸ªæŒ‡å‘D1çš„åŸºæŒ‡é’ˆ:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    D1 d1;</span><br><span class="line">    Base *dPtr = &amp;d1;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œå› ä¸ºdPtræ˜¯ä¸€ä¸ªåŸºæŒ‡é’ˆï¼Œæ‰€ä»¥å®ƒåªæŒ‡å‘d1çš„åŸºéƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œè¿˜è¦æ³¨æ„ï¼Œ<code>*__vptr</code>ä½äºç±»çš„åŸºéƒ¨åˆ†ï¼Œå› æ­¤dPtrå¯ä»¥è®¿é—®è¿™ä¸ªæŒ‡é’ˆã€‚</p><p>æœ€åï¼Œè¯·æ³¨æ„<code>dPtr-&gt;__vptr</code>æŒ‡å‘D1è™šè¡¨! <strong>å› æ­¤ï¼Œå³ä½¿dPtrçš„ç±»å‹æ˜¯Baseï¼Œå®ƒä»ç„¶å¯ä»¥è®¿é—®D1çš„è™šæ‹Ÿè¡¨(é€šè¿‡ __vptr)ã€‚</strong></p></li><li><p>é‚£ä¹ˆï¼Œå½“æˆ‘ä»¬å°è¯•è°ƒç”¨<code>dPtr-&gt;function1()</code>æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢?</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    D1 d1;</span><br><span class="line">    Base *dPtr = &amp;d1;</span><br><span class="line">    dPtr-&gt;function1();</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>é¦–å…ˆï¼Œç¨‹åºè®¤è¯†åˆ°<code>function1()</code>æ˜¯ä¸€ä¸ªè™šå‡½æ•°ã€‚</p></li><li><p>å…¶æ¬¡ï¼Œç¨‹åºä½¿ç”¨dPtr-&gt; vptræ¥è®¿é—®D1çš„è™šæ‹Ÿè¡¨ã€‚</p></li><li><p>ç¬¬ä¸‰ï¼ŒæŸ¥æ‰¾function1()è°ƒç”¨D1çš„è™šè¡¨çš„ç‰ˆæœ¬ã€‚</p><blockquote><p>è¿™å·²ç»è®¾ç½®ä¸ºD1::function1()ã€‚å› æ­¤ï¼ŒdPtr-&gt;function1()è§£æä¸ºD1::function1()!</p></blockquote></li></ul></li></ol><p><strong>é€šè¿‡ä½¿ç”¨è¿™äº›è¡¨ï¼Œç¼–è¯‘å™¨å’Œç¨‹åºèƒ½å¤Ÿç¡®ä¿å‡½æ•°è°ƒç”¨è§£æåˆ°é€‚å½“çš„è™šå‡½æ•°ï¼Œå³ä½¿æ‚¨åªä½¿ç”¨ä¸€ä¸ªæŒ‡é’ˆæˆ–å¯¹åŸºç±»çš„å¼•ç”¨!</strong></p><h1 id="è°ƒç”¨è™šå‡½æ•°æ¯”è°ƒç”¨éè™šå‡½æ•°æ…¢"><a href="#è°ƒç”¨è™šå‡½æ•°æ¯”è°ƒç”¨éè™šå‡½æ•°æ…¢" class="headerlink" title="è°ƒç”¨è™šå‡½æ•°æ¯”è°ƒç”¨éè™šå‡½æ•°æ…¢"></a>è°ƒç”¨è™šå‡½æ•°æ¯”è°ƒç”¨éè™šå‡½æ•°æ…¢</h1><p>1ã€</p><p>è°ƒç”¨è™šå‡½æ•°æ¯”è°ƒç”¨éè™šå‡½æ•°æ…¢ï¼ŒåŸå› å¦‚ä¸‹:</p><ul><li>é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨<code>*__vptr</code>æ¥è®¿é—®é€‚å½“çš„è™šè¡¨ã€‚</li><li>å…¶æ¬¡ï¼Œæˆ‘ä»¬å¿…é¡»ä¸ºè™šè¡¨å»ºç«‹ç´¢å¼•ï¼Œä»¥æ‰¾åˆ°è¦è°ƒç”¨çš„æ­£ç¡®å‡½æ•°ã€‚åªæœ‰è¿™æ ·æˆ‘ä»¬æ‰èƒ½è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚</li><li>å¼€å§‹è°ƒç”¨å‡½æ•°</li></ul><p>å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»æ‰§è¡Œ3ä¸ªæ“ä½œæ¥æ‰¾åˆ°è¦è°ƒç”¨çš„å‡½æ•°ï¼Œè€Œä¸æ˜¯å¯¹æ™®é€šçš„é—´æ¥å‡½æ•°è°ƒç”¨æ‰§è¡Œ2ä¸ªæ“ä½œï¼Œæˆ–è€…å¯¹ç›´æ¥å‡½æ•°è°ƒç”¨æ‰§è¡Œ1ä¸ªæ“ä½œã€‚ç„¶è€Œï¼Œå¯¹äºç°ä»£è®¡ç®—æœºæ¥è¯´ï¼Œè¿™äº›é¢å¤–çš„æ—¶é—´é€šå¸¸æ˜¯å¾®ä¸è¶³é“çš„ã€‚</p><p>2ã€</p><p>åŒæ ·éœ€è¦æé†’çš„æ˜¯ï¼Œä»»ä½•ä½¿ç”¨è™šå‡½æ•°çš„ç±»éƒ½æœ‰ä¸€ä¸ª<code>__vptr</code>ï¼Œå› æ­¤å®ƒä½¿åˆ†é…çš„æ¯ä¸ªç±»å¯¹è±¡çš„å¤§å°å¢åŠ ä¸€ä¸ªæŒ‡é’ˆã€‚è™šæ‹Ÿå‡½æ•°éå¸¸å¼ºå¤§ï¼Œä½†æ˜¯å®ƒä»¬ä¹Ÿæœ‰æ€§èƒ½ä»£ä»·ã€‚</p></div></section></article></div><div class="post-wrapper"><article class="post white-box shadow reveal"><section class="meta"><div class="meta" id="header-meta"><h2 class="title"><a href="/archives/bc3a234a.html">C&C++/æ—©èµ·ç»‘å®šä¸åæœŸç»‘å®š</a></h2><div class="new-meta-box"><div class="new-meta-item author"><a href="https://longlongqin.github.io" rel="nofollow"><img src="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/image/loading.gif" data-original="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/photo.jpg"><p>longlongin</p></a></div><div class="new-meta-item date"><a class="notlink"><i class="fas fa-edit" aria-hidden="true"></i><p>å‘å¸ƒäºï¼š2020å¹´5æœˆ14æ—¥</p></a></div><div class="new-meta-item wordcount"><a class="notlink"><i class="fas fa-keyboard" aria-hidden="true"></i><p>å­—æ•°ï¼š1.4kå­—</p></a></div><div class="new-meta-item readtime"><a class="notlink"><i class="fas fa-hourglass-half" aria-hidden="true"></i><p>æ—¶é•¿ï¼š5åˆ†é’Ÿ</p></a></div></div><hr></div></section><section class="article typo"><div class="article-entry" itemprop="articleBody"><p>åŸæ–‡ï¼š</p><p><a href="https://www.learncpp.com/cpp-tutorial/124-early-binding-and-late-binding/" target="_blank" rel="noopener">https://www.learncpp.com/cpp-tutorial/124-early-binding-and-late-binding/</a></p><hr><h1 id="C-ç¨‹åºæ‰§è¡Œæ—¶CPUçš„å·¥ä½œ"><a href="#C-ç¨‹åºæ‰§è¡Œæ—¶CPUçš„å·¥ä½œ" class="headerlink" title="C++ç¨‹åºæ‰§è¡Œæ—¶CPUçš„å·¥ä½œ"></a>C++ç¨‹åºæ‰§è¡Œæ—¶CPUçš„å·¥ä½œ</h1><p>åœ¨è¿™èŠ‚è¯¾å’Œä¸‹èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†è¿›ä¸€æ­¥äº†è§£è™šæ‹Ÿå‡½æ•°æ˜¯å¦‚ä½•å®ç°çš„ã€‚è™½ç„¶è¿™äº›ä¿¡æ¯å¯¹äºæœ‰æ•ˆåœ°ä½¿ç”¨è™šæ‹Ÿå‡½æ•°å¹¶ä¸æ˜¯ä¸¥æ ¼å¿…éœ€çš„ï¼Œä½†æ˜¯å®ƒå¾ˆæœ‰è¶£ã€‚ä¸è¿‡ï¼Œä½ å¯ä»¥æŠŠè¿™ä¸¤éƒ¨åˆ†éƒ½å½“ä½œå¯é€‰é˜…è¯»ã€‚</p><p>å½“ä¸€ä¸ªc++ç¨‹åºè¢«æ‰§è¡Œæ—¶ï¼Œå®ƒæŒ‰é¡ºåºæ‰§è¡Œï¼Œä»main()çš„é¡¶éƒ¨å¼€å§‹ã€‚å½“é‡åˆ°å‡½æ•°è°ƒç”¨æ—¶ï¼Œæ‰§è¡Œç‚¹ä¼šè·³è½¬åˆ°è¢«è°ƒç”¨å‡½æ•°çš„å¼€å¤´ã€‚CPUæ˜¯å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹çš„?</p><ul><li>ç¼–è¯‘ç¨‹åºæ—¶ï¼Œ<strong>ç¼–è¯‘å™¨å°†c++ç¨‹åºä¸­çš„æ¯æ¡è¯­å¥è½¬æ¢æˆä¸€è¡Œæˆ–å¤šè¡Œæœºå™¨è¯­è¨€ã€‚</strong>æœºå™¨è¯­è¨€çš„æ¯ä¸€è¡Œéƒ½æœ‰å®ƒè‡ªå·±çš„å”¯ä¸€é¡ºåºåœ°å€ã€‚è¿™å¯¹äºå‡½æ•°æ¥è¯´æ²¡æœ‰ä»€ä¹ˆä¸åŒâ€”â€”å½“é‡åˆ°ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œå®ƒè¢«è½¬æ¢æˆæœºå™¨è¯­è¨€å¹¶ç»™å‡ºä¸‹ä¸€ä¸ªå¯ç”¨çš„åœ°å€ã€‚å› æ­¤ï¼Œæ¯ä¸ªå‡½æ•°éƒ½ä»¥å”¯ä¸€çš„åœ°å€ç»“æŸã€‚</li></ul><h1 id="ç»‘å®š"><a href="#ç»‘å®š" class="headerlink" title="ç»‘å®š"></a>ç»‘å®š</h1><p><strong><u>ç»‘å®š</u>æ˜¯æŒ‡ç”¨äºå°†æ ‡è¯†ç¬¦ (å¦‚å˜é‡å’Œå‡½æ•°å) è½¬æ¢ä¸ºåœ°å€çš„è¿‡ç¨‹</strong>ã€‚è™½ç„¶ç»‘å®šåŒæ—¶ç”¨äºå˜é‡å’Œå‡½æ•°ï¼Œ<u>ä½†åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹è®¨è®ºå‡½æ•°ç»‘å®šã€‚</u></p><h2 id="æ—©æœŸç»‘å®š"><a href="#æ—©æœŸç»‘å®š" class="headerlink" title="æ—©æœŸç»‘å®š"></a>æ—©æœŸç»‘å®š</h2><blockquote><p><strong>æ—©æœŸç»‘å®šï¼ˆä¹Ÿç§°ä¸ºé™æ€ç»‘å®šï¼‰</strong>ï¼šè¡¨ç¤ºç¼–è¯‘å™¨(æˆ–é“¾æ¥å™¨) èƒ½å¤Ÿç›´æ¥å°† æ ‡è¯†ç¬¦åç§°(å¦‚å‡½æ•°æˆ–å˜é‡å) ä¸ æœºå™¨åœ°å€ ç›¸å…³è”ã€‚</p><p><strong>å› æ­¤ï¼Œå½“ç¼–è¯‘å™¨(æˆ–é“¾æ¥å™¨)é‡åˆ°ä¸€ä¸ªå‡½æ•°è°ƒç”¨æ—¶ï¼Œå®ƒä¼šç”¨ä¸€æ¡æœºå™¨è¯­è¨€æŒ‡ä»¤æ›¿æ¢è¯¥å‡½æ•°è°ƒç”¨ï¼Œè¯¥æŒ‡ä»¤å‘Šè¯‰CPUè·³è½¬åˆ°å‡½æ•°çš„åœ°å€ã€‚</strong></p></blockquote><p>ç¼–è¯‘å™¨é‡åˆ°çš„å¤§å¤šæ•°å‡½æ•°è°ƒç”¨éƒ½æ˜¯ç›´æ¥çš„å‡½æ•°è°ƒç”¨ã€‚<strong>ç›´æ¥å‡½æ•°è°ƒç”¨</strong>æ˜¯ç›´æ¥è°ƒç”¨å‡½æ•°çš„è¯­å¥ã€‚ä¾‹å¦‚:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printValue</span><span class="params">(<span class="keyword">int</span> value)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; value;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    printValue(<span class="number">5</span>); <span class="comment">// è¿™æ˜¯ä¸€ä¸ªç›´æ¥çš„å‡½æ•°è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><u>ç›´æ¥çš„å‡½æ•°è°ƒç”¨å¯ä»¥ä½¿ç”¨ç§°ä¸º<strong>æ—©æœŸç»‘å®š</strong>çš„è¿›ç¨‹æ¥è§£å†³</u>ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªä½¿ç”¨æ—©æœŸç»‘å®šçš„ç®€å•è®¡ç®—å™¨ç¨‹åº:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">subtract</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x - y;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">multiply</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * y;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Enter a number: "</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">int</span> y;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Enter another number: "</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; y;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">int</span> op;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Enter an operation (0=add, 1=subtract, 2=multiply): "</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; op;</span><br><span class="line">    &#125; <span class="keyword">while</span> (op &lt; <span class="number">0</span> || op &gt; <span class="number">2</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">switch</span> (op)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ç›´æ¥ä½¿ç”¨æ—©æœŸç»‘å®šè°ƒç”¨ç›®æ ‡å‡½æ•°</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>: result = add(x, y); <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>: result = subtract(x, y); <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>: result = multiply(x, y); <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"The answer is: "</span> &lt;&lt; result &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºadd()ã€subtract()å’Œmultiply()éƒ½æ˜¯ç›´æ¥çš„å‡½æ•°è°ƒç”¨ï¼Œç¼–è¯‘å™¨å°†ä½¿ç”¨æ—©æœŸç»‘å®šæ¥è§£æadd()ã€subtract()å’Œmultiply()å‡½æ•°è°ƒç”¨ã€‚</p><p>ç¼–è¯‘å™¨å°†ç”¨ä¸€æ¡æœºå™¨è¯­è¨€æŒ‡ä»¤æ›¿æ¢add()å‡½æ•°è°ƒç”¨ï¼Œè¿™æ¡æŒ‡ä»¤å‘Šè¯‰CPUè·³è½¬åˆ°add()å‡½æ•°çš„åœ°å€ã€‚å¯¹äºsubtract() å’Œ multiply()åŒæ ·é€‚ç”¨ã€‚</p><h2 id="åæœŸç»‘å®š"><a href="#åæœŸç»‘å®š" class="headerlink" title="åæœŸç»‘å®š"></a>åæœŸç»‘å®š</h2><p>åœ¨æŸäº›ç¨‹åºä¸­ï¼Œç›´åˆ°<strong>è¿è¡Œæ—¶</strong>(ç¨‹åºè¿è¡Œæ—¶)æ‰çŸ¥é“å°†è°ƒç”¨å“ªä¸ªå‡½æ•°ã€‚è¿™ç§°ä¸º<strong>åæœŸç»‘å®š(æˆ–åŠ¨æ€ç»‘å®š)ã€‚</strong></p><p><strong>åœ¨c++ä¸­ï¼Œè·å¾—åæœŸç»‘å®šçš„ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨å‡½æ•°æŒ‡é’ˆ</strong>ã€‚</p><blockquote><p>ç®€å•å›é¡¾ä¸€ä¸‹å‡½æ•°æŒ‡é’ˆï¼Œ<strong>å‡½æ•°æŒ‡é’ˆ æ˜¯ä¸€ç§æŒ‡å‘å‡½æ•°è€Œä¸æ˜¯å˜é‡çš„æŒ‡é’ˆã€‚</strong></p><p>å‡½æ•°æŒ‡é’ˆæŒ‡å‘çš„å‡½æ•° å¯ä»¥ä½¿ç”¨æŒ‡é’ˆä¸Šçš„ å‡½æ•°è°ƒç”¨æ“ä½œç¬¦(<strong><code>()</code></strong>)æ¥è°ƒç”¨ã€‚</p></blockquote><p>ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç è°ƒç”¨add()å‡½æ•°:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œä½¿å®ƒæŒ‡å‘ addå‡½æ•°</span></span><br><span class="line">    <span class="keyword">int</span> (*pFcn)(<span class="keyword">int</span>, <span class="keyword">int</span>) = add;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; pFcn(<span class="number">5</span>, <span class="number">3</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// add 5 + 3</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨å‡½æ•°ä¹Ÿç§°ä¸ºé—´æ¥å‡½æ•°è°ƒç”¨ã€‚ä¸‹é¢çš„è®¡ç®—å™¨ç¨‹åºåœ¨åŠŸèƒ½ä¸Šä¸ä¸Šé¢çš„è®¡ç®—å™¨ä¾‹å­ç›¸åŒï¼Œ<u>é™¤äº†å®ƒä½¿ç”¨äº†ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆè€Œä¸æ˜¯ç›´æ¥çš„å‡½æ•°è°ƒç”¨</u>:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">subtract</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x - y;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">multiply</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * y;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Enter a number: "</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">int</span> y;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Enter another number: "</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; y;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">int</span> op;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Enter an operation (0=add, 1=subtract, 2=multiply): "</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; op;</span><br><span class="line">    &#125; <span class="keyword">while</span> (op &lt; <span class="number">0</span> || op &gt; <span class="number">2</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªåä¸ºpFcnçš„å‡½æ•°æŒ‡é’ˆ(æ˜¯çš„ï¼Œè¯­æ³•å¾ˆéš¾çœ‹)</span></span><br><span class="line">    <span class="keyword">int</span> (*pFcn)(<span class="keyword">int</span>, <span class="keyword">int</span>) = <span class="literal">nullptr</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// è®¾ç½®pFcnæŒ‡å‘ç”¨æˆ·é€‰æ‹©çš„å‡½æ•°</span></span><br><span class="line">    <span class="keyword">switch</span> (op)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>: pFcn = add; <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>: pFcn = subtract; <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>: pFcn = multiply; <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// ä»¥xå’Œyä½œä¸ºå‚æ•°ï¼Œè°ƒç”¨pFcnæŒ‡å‘çš„å‡½æ•°</span></span><br><span class="line">	<span class="comment">// è¿™ä½¿ç”¨äº†åæœŸç»‘å®š</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"The answer is: "</span> &lt;&lt; pFcn(x, y) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ç›´æ¥è°ƒç”¨add()ã€subtract()æˆ–multiply()å‡½æ•°ï¼Œè€Œæ˜¯å°†pFcnè®¾ç½®ä¸ºæŒ‡å‘æˆ‘ä»¬å¸Œæœ›è°ƒç”¨çš„å‡½æ•°ã€‚ç„¶åé€šè¿‡æŒ‡é’ˆè°ƒç”¨å‡½æ•°ã€‚</p><p>ç¼–è¯‘å™¨æ— æ³•ä½¿ç”¨æ—©æœŸç»‘å®šæ¥è§£æè°ƒç”¨pFcn(x, y)çš„å‡½æ•°ï¼Œå› ä¸ºå®ƒæ— æ³•åˆ¤æ–­åœ¨ç¼–è¯‘æ—¶pFcnå°†æŒ‡å‘å“ªä¸ªå‡½æ•°!</p><hr><h1 id="å¯¹æ¯”æ—©æœŸç»‘å®šã€åæœŸç»‘å®š"><a href="#å¯¹æ¯”æ—©æœŸç»‘å®šã€åæœŸç»‘å®š" class="headerlink" title="å¯¹æ¯”æ—©æœŸç»‘å®šã€åæœŸç»‘å®š"></a>å¯¹æ¯”æ—©æœŸç»‘å®šã€åæœŸç»‘å®š</h1><ul><li><p>åæœŸç»‘å®šçš„æ•ˆç‡ç¨ä½ä¸€äº›ï¼Œå› ä¸ºå®ƒæ¶‰åŠé¢å¤–çš„é—´æ¥çº§åˆ«ã€‚ä½¿ç”¨åæœŸç»‘å®šï¼Œç¨‹åºå¿…é¡»è¯»å–æŒ‡é’ˆä¸­ä¿å­˜çš„åœ°å€ï¼Œç„¶åè·³è½¬åˆ°è¯¥åœ°å€ã€‚è¿™æ¶‰åŠä¸€ä¸ªé¢å¤–çš„æ­¥éª¤ï¼Œä½¿å®ƒç¨å¾®æ…¢ä¸€äº›ã€‚ä½†æ˜¯ï¼ŒåæœŸç»‘å®šçš„ä¼˜ç‚¹æ˜¯å®ƒæ¯”æ—©æœŸç»‘å®šæ›´çµæ´»ï¼Œå› ä¸ºç›´åˆ°è¿è¡Œæ—¶æ‰éœ€è¦å†³å®šè°ƒç”¨å“ªä¸ªå‡½æ•°ã€‚</p></li><li><p>é€šè¿‡æ—©æœŸç»‘å®šï¼ŒCPUå¯ä»¥ç›´æ¥è·³è½¬åˆ°å‡½æ•°çš„åœ°å€ã€‚</p></li></ul></div></section></article></div></section><br><div class="prev-next"><a class="prev" rel="prev" href="/page/4/"><section class="post prev white-box shadow"><i class="fas fa-chevron-left" aria-hidden="true"></i>&nbsp;ä¸Šä¸€é¡µ&nbsp;</section></a><p class="current">5 / 15</p><a class="next" rel="next" href="/page/6/"><section class="post next white-box shadow">&nbsp;ä¸‹ä¸€é¡µ&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i></section></a></div></div><aside class="l_side"><section class="widget blogger shadow desktop"><div class="content"><div class="avatar"><img class="avatar" src="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/image/loading.gif" data-original="https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/photo.jpg"></div><div class="text"><p><span id="jinrishici-sentence">é¾™é¾™â€˜S BLOG</span></p><script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script></div><div class="social-wrapper"><a href="/atom.xml" class="social fas fa-rss flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a> <a href="mailto:1198216723@qq.com" class="social fas fa-envelope flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a> <a href="https://github.com/longlongqin" class="social fab fa-github flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a> <a href="https://music.163.com/#/user/home?id=285545421" class="social fas fa-headphones-alt flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a></div></div></section><section class="widget grid shadow desktop mobile"><header><i class="fas fa-map-signs fa-fw" aria-hidden="true"></i><span class="name">ç«™å†…å¯¼èˆª</span></header><div class="content"><div class="grid navigation"><a class="flat-box" title="/" href="/" id="home"><i class="fas fa-clock fa-fw" aria-hidden="true"></i> è¿‘æœŸæ–‡ç«  </a><a class="flat-box" title="/archives/" href="/archives/" rel="nofollow" id="archives"><i class="fas fa-archive fa-fw" aria-hidden="true"></i> æ–‡ç« å½’æ¡£ </a><a class="flat-box" title="/friends/" href="/friends/" rel="nofollow" id="friends"><i class="fas fa-link fa-fw" aria-hidden="true"></i> å‹äººå¸ </a><a class="flat-box" title="/about/" href="/about/" rel="nofollow" id="about"><i class="fas fa-info-circle fa-fw" aria-hidden="true"></i> å…³äºå°ç«™</a></div></div></section><section class="widget category shadow desktop"><header><a href="/blog/categories/"><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i><span class="name">æ–‡ç« åˆ†ç±»</span></a></header><div class="content"><ul class="entry navigation"><li><a class="flat-box" title="/categories/OJ/" href="/categories/OJ/" id="categoriesOJ"><div class="name">OJ</div><div class="badge">(1)</div></a></li><li><a class="flat-box" title="/categories/hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" href="/categories/hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" id="categorieshexoE58D9AE5AEA2E690ADE5BBBA"><div class="name">hexoåšå®¢æ­å»º</div><div class="badge">(1)</div></a></li><li><a class="flat-box" title="/categories/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" href="/categories/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" id="categoriesE58D9AE5AEA2E690ADE5BBBA"><div class="name">åšå®¢æ­å»º</div><div class="badge">(4)</div></a></li><li><a class="flat-box" title="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" id="categoriesE5ADA6E4B9A0E7AC94E8AEB0"><div class="name">å­¦ä¹ ç¬”è®°</div><div class="badge">(48)</div></a></li><li><a class="flat-box child" title="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/C-C/" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/C-C/" id="categoriesE5ADA6E4B9A0E7AC94E8AEB0C-C"><div class="name">C/C++</div><div class="badge">(25)</div></a></li><li><a class="flat-box child" title="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Git/" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Git/" id="categoriesE5ADA6E4B9A0E7AC94E8AEB0Git"><div class="name">Git</div><div class="badge">(1)</div></a></li><li><a class="flat-box" title="/categories/%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7/" href="/categories/%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7/" id="categoriesE5AE9EE794A8E68A80E5B7A7"><div class="name">å®ç”¨æŠ€å·§</div><div class="badge">(1)</div></a></li><li><a class="flat-box" title="/categories/%E9%85%8D%E7%BD%AE/" href="/categories/%E9%85%8D%E7%BD%AE/" id="categoriesE9858DE7BDAE"><div class="name">é…ç½®</div><div class="badge">(1)</div></a></li></ul></div></section><section class="widget tagcloud shadow desktop"><header><a href="/blog/tags/"><i class="fas fa-tags fa-fw" aria-hidden="true"></i><span class="name">çƒ­é—¨æ ‡ç­¾</span></a></header><div class="content"><a href="/tags/C/" style="font-size:16px;color:#8b8b8b">C++</a> <a href="/tags/C-C/" style="font-size:24px;color:#555">C/C++</a> <a href="/tags/Git/" style="font-size:14px;color:#999">Git</a> <a href="/tags/Hexo%E4%B8%BB%E9%A2%98/" style="font-size:14px;color:#999">Hexoä¸»é¢˜</a> <a href="/tags/Let-s-Build-A-Simple-Interpreter/" style="font-size:22px;color:#636363">Let's Build A Simple Interpreter</a> <a href="/tags/Let%E2%80%99s-Build-A-Simple-Interpreter/" style="font-size:18px;color:#7e7e7e">Letâ€™s Build A Simple Interpreter</a> <a href="/tags/OJ/" style="font-size:14px;color:#999">OJ</a> <a href="/tags/Yilia%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AE/" style="font-size:14px;color:#999">Yiliaä¸»é¢˜é…ç½®</a> <a href="/tags/forme/" style="font-size:14px;color:#999">forme</a> <a href="/tags/front-matter%E9%85%8D%E7%BD%AE/" style="font-size:14px;color:#999">front-matteré…ç½®</a> <a href="/tags/github/" style="font-size:14px;color:#999">github</a> <a href="/tags/hexo%E6%98%BE%E7%A4%BApdf/" style="font-size:14px;color:#999">hexoæ˜¾ç¤ºpdf</a> <a href="/tags/matery%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AE/" style="font-size:14px;color:#999">materyä¸»é¢˜é…ç½®</a> <a href="/tags/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E9%80%9F%E6%88%90%E8%AF%BE%E3%80%8B/" style="font-size:18px;color:#7e7e7e">ã€Šè®¡ç®—æœºç§‘å­¦é€Ÿæˆè¯¾ã€‹</a> <a href="/tags/%E5%87%B8%E5%8C%85/" style="font-size:20px;color:#707070">å‡¸åŒ…</a> <a href="/tags/%E5%B8%83%E5%B0%94%E9%80%BB%E8%BE%91%E5%92%8C%E9%80%BB%E8%BE%91%E9%97%A8/" style="font-size:14px;color:#999">å¸ƒå°”é€»è¾‘å’Œé€»è¾‘é—¨</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95/" style="font-size:14px;color:#999">è®¡ç®—å‡ ä½•</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E9%80%9F%E6%88%90%E8%AF%BE/" style="font-size:14px;color:#999">è®¡ç®—æœºç§‘å­¦é€Ÿæˆè¯¾</a> <a href="/tags/%E9%85%8D%E7%BD%AE/" style="font-size:14px;color:#999">é…ç½®</a></div></section></aside><footer class="clearfix white"><br><br><div class="aplayer-container"><meting-js theme="#1BCDFC" autoplay volume="0.6" loop order="list" fixed="false" list-max-height="340px" server="netease" type="song" id="186453" list-folded="true"></meting-js></div><br><div class="social-wrapper"><a href="/atom.xml" class="social fas fa-rss flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a> <a href="mailto:1198216723@qq.com" class="social fas fa-envelope flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a> <a href="https://github.com/longlongqin" class="social fab fa-github flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a> <a href="https://music.163.com/#/user/home?id=285545421" class="social fas fa-headphones-alt flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a></div><red>&copy; 2020-2020 longlongqin ğŸ˜Š| powered by HEXO | theme volantis</red><br><yellow><span id="timeDate">è½½å…¥å¤©æ•°...</span><span id="times">è½½å…¥æ—¶åˆ†ç§’...</span><script>var now=new Date;function createtime(){var n=new Date("03/01/2020 18:00:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="å°ç«™å·²è¿è¡Œ "+dnum+" å¤© ",document.getElementById("times").innerHTML=hnum+" å°æ—¶ "+mnum+" åˆ† "+snum+" ç§’ "}setInterval("createtime()",250)</script></yellow><br><green><i class="fas fa-chart-area"></i> <span class="post-count">å­—æ•°ç»Ÿè®¡ï¼š307.9k</span></green>|<script type="text/javascript" src="https://v1.cnzz.com/z_stat.php?id=1278663994&web_id=1278663994"></script><br><cyan>åšå®¢å†…å®¹éµå¾ª</cyan><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank"><cyan>ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™… (CC BY-NC-SA 4.0) åè®®</cyan></a></footer><script>setLoadingBarProgress(80)</script><script>setLoadingBarProgress(60)</script></div><a class="s-top fas fa-arrow-up fa-fw" href="javascript:void(0)"></a></div><script src="https://cdn.jsdelivr.net/npm/jquery@3.4/dist/jquery.min.js"></script><script>var SEARCH_SERVICE="hexo",ROOT="/";ROOT.endsWith("/")||(ROOT+="/")</script><script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script><script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script><script type="text/javascript">$(function(){Waves.attach(".flat-btn",["waves-button"]),Waves.attach(".float-btn",["waves-button","waves-float"]),Waves.attach(".float-btn-light",["waves-button","waves-float","waves-light"]),Waves.attach(".flat-box",["waves-block"]),Waves.attach(".float-box",["waves-block","waves-float"]),Waves.attach(".waves-image"),Waves.init()})</script><script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script><script type="text/javascript">$(function(){var n=["https://cdn.jsdelivr.net/gh/longlongqin/CDN-for-HEXO_BLOG/background/4.jpg"];!function(n){for(var o=n.length;o--;){var r=Math.floor(Math.random()*o),t=n[r];n[r]=n[o],n[o]=t}}(n),$(".cover").backstretch(n,{duration:"20000",fade:"1500"})})</script><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js" async></script><script src="https://cdn.jsdelivr.net/npm/meting@2.0/dist/Meting.min.js" async></script><script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.1.4/js/app.js"></script><script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.1/js/search.js"></script><script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/comment_typing.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script><script>!function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copyed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-clipboard-check');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPYED';
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-exclamation-triangle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
      });
    }
    initCopyCode();
  }(window, document);</script><script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script>let LAZY_LOAD_IMAGE = "[object Object]";
  $(".article-entry").find("fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* å›¾ç‰‡é‡‡ç”¨æ‡’åŠ è½½å¤„ç†æ—¶,
       * ä¸€èˆ¬å›¾ç‰‡æ ‡ç­¾å†…ä¼šæœ‰ä¸ªå±æ€§åæ¥å­˜æ”¾å›¾ç‰‡çš„çœŸå®åœ°å€ï¼Œæ¯”å¦‚ data-original,
       * é‚£ä¹ˆæ­¤å¤„å°†åŸæœ¬çš„å±æ€§åsrcæ›¿æ¢ä¸ºå¯¹åº”å±æ€§ådata-original,
       * ä¿®æ”¹å¦‚ä¸‹
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });</script><script>setLoadingBarProgress(100)</script><script>!function(e){var c=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function i(){for(var r=0;r<c.length;r++)t=c[r],0<=(n=t.getBoundingClientRect()).bottom&&0<=n.left&&n.top<=(e.innerHeight||document.documentElement.clientHeight)&&function(){var t,n,e,i,o=c[r];t=o,n=function(){c=c.filter(function(t){return o!==t})},e=new Image,i=t.getAttribute("data-original"),e.onload=function(){t.src=i,n&&n()},e.src=i}();var t,n}i(),e.addEventListener("scroll",function(){var t,n;t=i,n=e,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(n)},500)})}(this);</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script></body></html>